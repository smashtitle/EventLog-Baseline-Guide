"title","level","service","category","description","id"
"Suspicious PowerShell Invocations - Specific","high","powershell","","Detects suspicious PowerShell invocation command parameters","3db961f4-6217-4957-b717-e5955c82d6e5"
"Suspicious PowerShell Download","medium","powershell","","Detects suspicious PowerShell download command","12f93a4e-cd0e-18d7-6969-b345ecc8d40a"
"Suspicious PowerShell Invocations - Generic","high","powershell","","Detects suspicious PowerShell invocation command parameters","391b98f2-3f42-0d06-a295-18a2aa29d39a"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","powershell","","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","349e3bb4-b72b-193d-810e-7d9c145b863e"
"Suspicious Non PowerShell WSMAN COM Provider","medium","powershell-classic","","Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell","medium","powershell-classic","","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","ee9681d0-6ba5-5eaf-9c8b-fe39afe542b9"
"Potential RemoteFXvGPUDisablement.EXE Abuse","high","powershell-classic","","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of  the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","29a3935d-0428-4f39-d39e-ec43c598b272"
"PwSh Pipeline Exec","informational","powershell","ps_module","Powershell Module Loggong. Displays powershell execution","d3fb8f7b-88b0-4ff4-bf9b-ca286ce19031"
"Suspicious PowerShell Invocations - Specific","high","powershell","","Detects suspicious PowerShell invocation command parameters","3db961f4-6217-4957-b717-e5955c82d6e5"
"Netcat The Powershell Version - PowerShell Module","medium","","ps_module","Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network","65efb931-2d64-dea1-b559-544498a9b6f8"
"Suspicious PowerShell Download","medium","powershell","","Detects suspicious PowerShell download command","12f93a4e-cd0e-18d7-6969-b345ecc8d40a"
"Suspicious PowerShell Invocations - Generic","high","powershell","","Detects suspicious PowerShell invocation command parameters","391b98f2-3f42-0d06-a295-18a2aa29d39a"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","powershell","","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","349e3bb4-b72b-193d-810e-7d9c145b863e"
"Local Firewall Rules Enumeration Via NetFirewallRule Cmdlet","low","","ps_module","Detects execution of ""Get-NetFirewallRule"" or ""Show-NetFirewallRule"" to enumerate the local firewall rules on a host.","81b7f962-1b39-9a15-eca7-f718f8e45e85"
"Potential Active Directory Enumeration Using AD Module - PsModule","medium","","ps_module","Detects usage of the ""Import-Module"" cmdlet to load the ""Microsoft.ActiveDirectory.Management.dl"" DLL. Which is often used by attackers to perform AD enumeration.","043fe2ff-2844-9176-3d40-aa3bf3e794a6"
"Invoke-Obfuscation CLIP+ Launcher - PowerShell Module","high","","ps_module","Detects Obfuscated use of Clip.exe to execute PowerShell","7a595cb6-87c9-7d42-5bf9-f404e939d500"
"Invoke-Obfuscation Via Stdin - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via Stdin in Scripts","58925ff0-2936-8ebd-4c28-8fdbb8ac19a8"
"Invoke-Obfuscation VAR+ Launcher - PowerShell Module","high","","ps_module","Detects Obfuscated use of Environment Variables to execute PowerShell","61ec8448-ba5d-0b4f-8089-eb047d43a2ec"
"Alternate PowerShell Hosts - PowerShell Module","medium","","ps_module","Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe","b7826f95-a54d-d6e4-d4e0-38998c4eb8d7"
"Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell Module","high","","ps_module","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","c2325f35-edc7-9b45-d0bc-548ab4074e0a"
"Invoke-Obfuscation STDIN+ Launcher - PowerShell Module","high","","ps_module","Detects Obfuscated use of stdin to execute PowerShell","c539a450-9d59-8ac3-1709-f3b5f2e5a989"
"Suspicious Get Information for SMB Share - PowerShell Module","low","","ps_module","Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and
to identify potential systems of interest for Lateral Movement.
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.
","a1d89efd-6d69-416b-3004-ec9c460a863d"
"Invoke-Obfuscation Via Use Rundll32 - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via use Rundll32 in Scripts","acb9f9fe-df3e-be2a-239f-51b194099630"
"Clear PowerShell History - PowerShell Module","medium","","ps_module","Detects keywords that could indicate clearing PowerShell history","5dea4020-38c8-b6d5-ebdb-2a7cfa20044e"
"Suspicious PowerShell Invocations - Specific - PowerShell Module","high","","ps_module","Detects suspicious PowerShell invocation command parameters","da4a803e-e609-d187-675c-d7e7f0083763"
"AD Groups Or Users Enumeration Using PowerShell - PoshModule","low","","ps_module","Adversaries may attempt to find domain-level groups and permission settings.
The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.
","f3c1031c-796c-6c50-7af9-c490e09550f6"
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via VAR++ LAUNCHER","b2064db0-e465-72c2-edcc-57cfd9676207"
"Invoke-Obfuscation Via Use Clip - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via use Clip.exe in Scripts","d1ec8808-93c9-9dcb-b4b8-b20791287ee2"
"Bad Opsec Powershell Code Artifacts","critical","","ps_module","focuses on trivial artifacts observed in variants of prevalent offensive ps1 payloads, including
Cobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other attack payloads
that often undergo minimal changes by attackers due to bad opsec.
","118c017d-54bd-d0a7-e24e-74482fd67b54"
"Invoke-Obfuscation Via Use MSHTA - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via use MSHTA in Scripts","6ead282b-ed6b-7f68-1ed2-b8f5fb092b4e"
"Zip A Folder With PowerShell For Staging In Temp  - PowerShell Module","medium","","ps_module","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","a707acca-c4f5-6929-a1fc-0908ab087be0"
"Suspicious Get-ADDBAccount Usage","high","","ps_module","Detects suspicious invocation of the Get-ADDBAccount script that reads from a ntds.dit file and may be used to get access to credentials without using any credential dumpers","85b06a92-2ad6-ef34-57c3-fac694f74095"
"Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell Module","medium","","ps_module","Detects Obfuscated Powershell via COMPRESS OBFUSCATION","93fea8ea-89ab-d08a-3904-a6949999010c"
"Suspicious Get Local Groups Information","low","","ps_module","Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.
","300dbe85-b7a0-be0b-aa57-321c1ee97848"
"Suspicious Computer Machine Password by PowerShell","medium","","ps_module","The Reset-ComputerMachinePassword cmdlet changes the computer account password that the computers use to authenticate to the domain controllers in the domain.
You can use it to reset the password of the local computer.
","31981511-e5c7-fa6d-65dd-422e26ba8f0d"
"Malicious PowerShell Commandlets - PoshModule","high","","ps_module","Detects Commandlet names from well-known PowerShell exploitation frameworks","36554b35-d185-3e51-6b7f-9b61726b8d3a"
"HackTool - Evil-WinRm Execution - PowerShell Module","high","","ps_module","Detects the execution of Evil-WinRM via PowerShell Module logs by leveraging the hardcoded strings inside the utility.
","a0ecd6f3-309d-3ad0-2231-421f98a89f32"
"Suspicious PowerShell Invocations - Generic - PowerShell Module","high","","ps_module","Detects suspicious PowerShell invocation command parameters","e27c3517-69ca-c8c3-fc57-c4baba10867f"
"Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell Module","high","","ps_module","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block cited in the reference section below","b21405ff-2071-082b-067f-fa116d28a858"
"Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell Module","medium","","ps_module","Detects Obfuscated Powershell via RUNDLL LAUNCHER","567da8d6-9387-9852-16ed-a336bfaad91e"
"PowerShell Get Clipboard","medium","","ps_module","A General detection for the Get-Clipboard commands in PowerShell logs. This could be an adversary capturing clipboard contents.","8ed7f4b3-91aa-4c85-95e8-a361f9004b2e"
"Use Get-NetTCPConnection - PowerShell Module","low","","ps_module","Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.","8485a923-ab47-503c-8823-f930f71f83a1"
"Malicious PowerShell Scripts - PoshModule","high","","ps_module","Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance","a26b0227-f81e-097b-19ba-ffbb04417ccc"
"Remote PowerShell Session (PS Module)","high","","ps_module","Detects remote PowerShell sessions","d8bf9898-a71e-347a-25d6-1fde2e2925e6"
"Suspicious PowerShell Download - PoshModule","medium","","ps_module","Detects suspicious PowerShell download command","3a7c8368-70ba-0539-d7a9-662a59306969"
"SyncAppvPublishingServer Bypass Powershell Restriction - PS Module","medium","","ps_module","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","9863342f-1e0e-72c5-8faa-674337cd6d2b"
"PowerShell Decompress Commands","informational","","ps_module","A General detection for specific decompress commands in PowerShell logs. This could be an adversary decompressing files.","e4ba78e1-d659-9152-8504-cae6d6c7372e"
"Suspicious Non PowerShell WSMAN COM Provider","medium","powershell-classic","","Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell","medium","powershell-classic","","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","ee9681d0-6ba5-5eaf-9c8b-fe39afe542b9"
"Potential RemoteFXvGPUDisablement.EXE Abuse","high","powershell-classic","","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of  the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","29a3935d-0428-4f39-d39e-ec43c598b272"
"PwSh Scriptblock","informational","powershell","ps_script","Powershell Scriptblock Logging. Windows 10+ will flag suspicious PwSh as level 3 (warning) so 
I am filtering out these events as they are being created with the ""Potentially Malicious PwSh"" rule.
","0f3b1343-65a5-4879-b512-9d61b0e4e3ba"
"Potentially Malicious PwSh","medium","powershell","ps_script","On Powershell v5+, Windows will automatically log suspicious powershell execution and mark the Level as Warning.","73be1519-4648-4ed7-b305-605504afc242"
"Execution via CL_Mutexverifiers.ps1 (2 Lines)","high","","ps_script","Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module","97408cc2-d2e8-83dd-1f84-93da08e9f191"
"Execution via CL_Invocation.ps1 (2 Lines)","high","","ps_script","Detects Execution via SyncInvoke in CL_Invocation.ps1 module","13cf4134-564b-abdb-c83e-dac3ba9bac3c"
"Suspicious PowerShell Invocations - Specific","high","powershell","","Detects suspicious PowerShell invocation command parameters","3db961f4-6217-4957-b717-e5955c82d6e5"
"Execution via CL_Invocation.ps1 - Powershell","high","","ps_script","Detects Execution via SyncInvoke in CL_Invocation.ps1 module","6587075c-6239-f6e1-4717-4b7972b1c086"
"PrintNightmare Powershell Exploitation","high","","ps_script","Detects Commandlet name for PrintNightmare exploitation.","5eb9df17-06bd-e2fe-8871-13bd6bd36406"
"Suspicious PowerShell Download","medium","powershell","","Detects suspicious PowerShell download command","12f93a4e-cd0e-18d7-6969-b345ecc8d40a"
"Suspicious PowerShell Invocations - Generic","high","powershell","","Detects suspicious PowerShell invocation command parameters","391b98f2-3f42-0d06-a295-18a2aa29d39a"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","powershell","","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","349e3bb4-b72b-193d-810e-7d9c145b863e"
"Execution via CL_Mutexverifiers.ps1","high","","ps_script","Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module","f427b1c7-bbad-7bd6-bb0f-65b6170a3cb5"
"Accessing Encrypted Credentials from Google Chrome Login Database","medium","","ps_script","Adversaries may acquire credentials from web browsers by reading files specific to the target browser.
Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.
Web browsers typically store the credentials in an encrypted format within a credential store.
","63c2d41b-b587-6c55-c256-9c0bb392f0a9"
"Dnscat Execution","critical","","ps_script","Dnscat exfiltration tool execution","47d13687-edae-dafa-bdab-416474c95f53"
"Suspicious Get-WmiObject","low","","ps_script","The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers","830423bc-69e4-b19b-5474-414e4ab0c365"
"AzureHound PowerShell Commands","high","","ps_script","Detects the execution of AzureHound in PowerShell, a tool to gather data from Azure for BloodHound","74dda95a-b492-e2ee-4a33-b22a41a1cb57"
"Powershell File and Directory Discovery","low","","ps_script","Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.
Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors,
including whether or not the adversary fully infects the target and/or attempts specific actions.
","113fcff8-c64d-8743-88b7-9ff2539cde7d"
"SMB over QUIC Via PowerShell Script","medium","","ps_script","Detects the mounting of Windows SMB shares over QUIC, which can be an unexpected event in some enterprise environments","b3c17af7-4207-0100-fe3c-3730a1c40c82"
"Use Of Remove-Item to Delete File - ScriptBlock","low","","ps_script","PowerShell Remove-Item  with -Path to delete a file or a folder with ""-Recurse""","6e77c76e-375f-3378-fb5b-0d55e078f8ad"
"Potential Data Exfiltration Over SMTP Via Send-MailMessage Cmdlet","medium","","ps_script","Detects the execution of a PowerShell script with a call to the ""Send-MailMessage"" cmdlet along with the ""-Attachments"" flag. This could be a potential sign of data exfiltration via Email.
Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.
","87face0d-1383-7cc4-2da9-2a5da8b81325"
"WinAPI Library Calls Via PowerShell Scripts","medium","","ps_script","Detects calls to WinAPI libraries from PowerShell scripts. Attackers can often leverage these APIs to avoid detection based on typical PowerShell function calls. Use this rule as a basis to hunt for interesting scripts.","66cccc69-033d-56e2-a1e1-f190cc0a9ca0"
"Windows Mail App Mailbox Access Via PowerShell Script","medium","","ps_script","Detects PowerShell scripts that try to access the default Windows MailApp MailBox. This indicates manipulation of or access to the stored emails of a user. E.g. this could be used by an attacker to exfiltrate or delete the content of the emails.","aac8a133-780e-35ed-5d52-60a568765afb"
"Compress-Archive Cmdlet Execution","low","","ps_script","Detects PowerShell scripts that make use of the ""Compress-Archive"" cmdlet in order to compress folders and files.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","c0483a49-1049-db52-97c5-ed73a6063b93"
"Potential Registry Reconnaissance Via PowerShell Script","medium","","ps_script","Detects PowerShell scripts with potential registry reconnaissance capabilities. Adversaries may interact with the Windows registry to gather information about the system credentials, configuration, and installed software.","822b05a7-afa1-99c7-fc49-578330c9bf81"
"WinAPI Function Calls Via PowerShell Scripts","medium","","ps_script","Detects calls to WinAPI functions from PowerShell scripts. Attackers can often leverage these APIs to avoid detection based on typical PowerShell function calls. Use this rule as a basis to hunt for interesting scripts.","fc457d0e-1ed4-ecab-aa1f-bd5c4b53c2d9"
"New Windows Firewall Rule Added Via New-NetFirewallRule Cmdlet - ScriptBlock","low","","ps_script","Detects when a powershell script contains calls to the ""New-NetFirewallRule"" cmdlet in order to add a new firewall rule with an ""Allow"" action.
","40fd8a4e-3820-0edf-530e-53785ee863e9"
"Lace Tempest PowerShell Launcher","high","","ps_script","Detects a PowerShell script used by Lace Tempest APT to launch their malware loader by exploiting CVE-2023-47246 as reported by SysAid Team
","47fec53e-ab09-f2b7-fc9a-c7364aefc12f"
"Lace Tempest PowerShell Evidence Eraser","high","","ps_script","Detects a PowerShell script used by Lace Tempest APT to erase evidence from victim servers by exploiting CVE-2023-47246 as reported by SysAid Team
","017266c4-7b12-7c2b-d2b3-0b8ffe973af8"
"Potential APT FIN7 POWERHOLD Execution","high","","ps_script","Detects execution of the POWERHOLD script seen used by FIN7 as reported by WithSecureLabs","384a6ce5-d681-2e87-6a43-6e1a0eb0f316"
"Potential POWERTRASH Script Execution","high","","ps_script","Detects potential execution of the PowerShell script POWERTRASH","b8581aed-5481-addc-116b-c0b8384cecfc"
"Root Certificate Installed - PowerShell","medium","","ps_script","Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.","245734a0-22f3-d684-07a7-ed1cea011d8e"
"Security Software Discovery Via Powershell Script","medium","","ps_script","Detects calls to ""get-process"" where the output is piped to a ""where-object"" filter to search for security solution processes.
Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus
","2e7d9c7a-fab3-d015-8552-39acf165059c"
"Suspicious Start-Process PassThru","medium","","ps_script","Powershell use PassThru option to start in background","c6dce605-3bb0-c881-1c5c-f3e4e9d62577"
"Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell","high","","ps_script","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014","30be45df-1ada-4075-3586-5a3d6eda8cd3"
"Potentially Suspicious Call To Win32_NTEventlogFile Class - PSScript","medium","","ps_script","Detects usage of the WMI class ""Win32_NTEventlogFile"" in a potentially suspicious way (delete, backup, change permissions, etc.) from a PowerShell script","72ba1398-c3d6-c1a6-9133-bc72ccaca90d"
"DSInternals Suspicious PowerShell Cmdlets - ScriptBlock","high","","ps_script","Detects execution and usage of the DSInternals PowerShell module. Which can be used to perform what might be considered as suspicious activity such as dumping DPAPI backup keys or manipulating NTDS.DIT files.
The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory. These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.
","55d8816f-49cc-7135-b3b1-63d41ce23a01"
"Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell ScriptBlock","high","","ps_script","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","9a9b4924-bf93-774d-4bee-a2d13260663c"
"Live Memory Dump Using Powershell","high","","ps_script","Detects usage of a PowerShell command to dump the live memory of a Windows machine","f279fcb8-4560-0d0c-3bee-043b32f9b3fb"
"PowerShell PSAttack","high","","ps_script","Detects the use of PSAttack PowerShell hack tool","8dd08d08-a638-c74c-8e7a-07d55d3b3318"
"Potential Keylogger Activity","medium","","ps_script","Detects PowerShell scripts that contains reference to keystroke capturing functions","6154995f-9153-aaa3-dc51-d3062506c78a"
"PowerView PowerShell Cmdlets - ScriptBlock","high","","ps_script","Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.","cc813de1-cf1f-dd91-bcfb-3821610d9dfc"
"PowerShell WMI Win32_Product Install MSI","medium","","ps_script","Detects the execution of an MSI file using PowerShell and the WMI Win32_Product class","a91de133-e7bc-3e22-d4ec-af1bfe620409"
"Malicious Nishang PowerShell Commandlets","high","","ps_script","Detects Commandlet names and arguments from the Nishang exploitation framework","79769f3b-efb3-9463-e114-7446d4361146"
"PowerShell Set-Acl On Windows Folder - PsScript","high","","ps_script","Detects PowerShell scripts to set the ACL to a file in the Windows folder","82a11bd6-070f-3229-f413-73fe2ddd7018"
"Deletion of Volume Shadow Copies via WMI with PowerShell - PS Script","high","","ps_script","Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil","329df23d-a366-2e13-47f7-3c67cfb56f75"
"Disable of ETW Trace - Powershell","high","","ps_script","Detects usage of powershell cmdlets to disable or remove ETW trace sessions","f1205c3a-b112-f060-2b3e-b43fd3460482"
"Powershell Timestomp","medium","","ps_script","Adversaries may modify file time attributes to hide new or changes to existing files.
Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder.
","b32352bf-5bcb-d3c9-a9eb-4bbf8ed85654"
"Potential In-Memory Execution Using Reflection.Assembly","medium","","ps_script","Detects usage of ""Reflection.Assembly"" load functions to dynamically load assemblies in memory","4ee64eb7-79b5-d7d2-9ba7-89616409e7d0"
"Suspicious Hyper-V Cmdlets","medium","","ps_script","Adversaries may carry out malicious operations using a virtual instance to avoid detection","94272bf4-116b-5204-4be6-69b2d5648fa4"
"Potential Persistence Via Security Descriptors - ScriptBlock","high","","ps_script","Detects usage of certain functions and keywords that are used to manipulate security descriptors in order to potentially set a backdoor. As seen used in the DAMP project.","b46c37cc-554c-aab3-0744-26f3a5ace219"
"NTFS Alternate Data Stream","high","","ps_script","Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.","e701b235-4663-b82b-8611-b51a0706589b"
"PowerShell Script With File Hostname Resolving Capabilities","medium","","ps_script","Detects PowerShell scripts that have capabilities to read files, loop through them and resolve DNS host entries.","53f26dda-d088-32eb-a704-03c3b6986b49"
"Suspicious Service DACL Modification Via Set-Service Cmdlet - PS","high","","ps_script","Detects usage of the ""Set-Service"" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as ""sc.exe"", ""Get-Service""...etc. (Works only in powershell 7)","43de23b6-5e9c-142a-9e42-64992bede784"
"Potential Data Exfiltration Via Audio File","medium","","ps_script","Detects potential exfiltration attempt via audio file using PowerShell","4956629d-759b-2297-1edf-5751449384cb"
"Silence.EDA Detection","critical","","ps_script","Detects Silence EmpireDNSAgent as described in the Group-IP report","71d6a25b-6fe6-37e2-40bc-c4de171fbbc9"
"Change PowerShell Policies to an Insecure Level - PowerShell","medium","","ps_script","Detects changing the PowerShell script execution policy to a potentially insecure level using the ""Set-ExecutionPolicy"" cmdlet.","e5a59479-4ded-f6c3-ab4d-8d464128fbb2"
"Request A Single Ticket via PowerShell","high","","ps_script","utilize native PowerShell Identity modules to query the domain to extract the Service Principal Names for a single computer.
This behavior is typically used during a kerberos or silver ticket attack.
A successful execution will output the SPNs for the endpoint in question.
","088701bf-4758-9a2a-76c0-2e148a7e122c"
"Detected Windows Software Discovery - PowerShell","medium","","ps_script","Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.","abc8469f-9601-7199-13b7-9620478f5335"
"Potential WinAPI Calls Via PowerShell Scripts","high","","ps_script","Detects use of WinAPI functions in PowerShell scripts","edeeb148-ce01-b5b8-a531-3b364b7fd191"
"Suspicious SSL Connection","low","","ps_script","Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.","57e275e0-10cf-be8d-39b2-027fbfeb2913"
"Delete Volume Shadow Copies via WMI with PowerShell - PS Script","high","","ps_script","Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil","baee41a3-2063-6125-778e-0d9710474c06"
"Create Volume Shadow Copy with Powershell","high","","ps_script","Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information","33f62d96-55cf-87d2-e9f0-0a5fff75a278"
"Manipulation of User Computer or Group Security Principals Across AD","medium","","ps_script","Adversaries may create a domain account to maintain access to victim systems.
Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain..
","2843f0fc-1a75-2140-6c4c-f5c296073941"
"Service Registry Permissions Weakness Check","medium","","ps_script","Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.
Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.
Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services
","ce3cad3a-afec-9acc-c763-9b4cb0fd5ece"
"Suspicious Unblock-File","medium","","ps_script","Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.","b56d246e-e1d8-6f33-6e90-65864d130915"
"Powershell Local Email Collection","medium","","ps_script","Adversaries may target user email on local systems to collect sensitive information.
Files containing email data can be acquired from a users local system, such as Outlook storage or cache files.
","00ba998e-b435-22a6-2dbf-e85e1918b8a7"
"Clearing Windows Console History","high","","ps_script","Identifies when a user attempts to clear console history. An adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion.","1a8e1936-4b07-2bb2-ef3a-2cdf7d294a56"
"Powershell Directory Enumeration","medium","","ps_script","Detects technique used by MAZE ransomware to enumerate directories using Powershell","13a97026-d21c-5c67-761d-537efe8f3fe7"
"Suspicious New-PSDrive to Admin Share","medium","","ps_script","Adversaries may use to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.","9d0ff6ee-9967-a757-d8dc-cf3f3b3546b1"
"PowerShell Script Change Permission Via Set-Acl - PsScript","low","","ps_script","Detects PowerShell scripts set ACL to of a file or a folder","3586407d-f3a3-bb2d-8467-0956e15af381"
"User Discovery And Export Via Get-ADUser Cmdlet - PowerShell","medium","","ps_script","Detects usage of the Get-ADUser cmdlet to collect user information and output it to a file","369a4eed-03b4-7aea-6309-c6d7173b0567"
"Potential AMSI Bypass Script Using NULL Bits","medium","","ps_script","Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities","4502b93e-2c0d-56b8-7ce1-35523e4fb0ba"
"Powershell Execute Batch Script","medium","","ps_script","Adversaries may abuse the Windows command shell for execution.
The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems.
The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands.
Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops.
Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple system
","57b18282-5df7-0636-ee86-75ccdbe55519"
"PowerShell ADRecon Execution","high","","ps_script","Detects execution of ADRecon.ps1 for AD reconnaissance which has been reported to be actively used by FIN7","cde108d4-944b-2594-02b8-61f2852260a1"
"HackTool - WinPwn Execution - ScriptBlock","high","","ps_script","Detects scriptblock text keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.
","40e38653-158e-78ce-f816-60a159924dc9"
"PSAsyncShell - Asynchronous TCP Reverse Shell","high","","ps_script","Detects the use of PSAsyncShell an Asynchronous TCP Reverse Shell written in powershell","714c75ab-6bed-7c9d-462b-f7f9252e47e5"
"Suspicious PowerShell Invocations - Generic","high","","ps_script","Detects suspicious PowerShell invocation command parameters","308e8029-d702-799b-6aea-82f749348b24"
"PowerShell Web Access Installation - PsScript","high","","ps_script","Detects the installation and configuration of PowerShell Web Access, which could be used for remote access and potential abuse","802477a9-01ea-d5f8-2ff9-44285787d0f7"
"Powershell MsXml COM Object","medium","","ps_script","Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell)
Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code
","a57f49ff-b916-4527-881f-bef76dc42248"
"Enable Windows Remote Management","medium","","ps_script","Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.","b5223513-5e9d-2c11-1cf7-d980bfed58f5"
"Suspicious Get-ADReplAccount","medium","","ps_script","The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory.
These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.
","e59d0c87-f426-154d-9744-50e5cb987c9f"
"PowerShell Create Local User","medium","","ps_script","Detects creation of a local user via PowerShell","b49ece4c-cd58-540c-62a8-d4189dc45f3e"
"PowerShell Remote Session Creation","medium","","ps_script","Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system
","f1a1daa1-2c4e-6354-e062-1f80427eafc3"
"Modify Group Policy Settings - ScriptBlockLogging","medium","","ps_script","Detect malicious GPO modifications can be used to implement many other malicious behaviors.","0b0963db-269b-9351-ab12-4aa9d1f8a105"
"Powershell DNSExfiltration","high","","ps_script","DNSExfiltrator allows for transferring (exfiltrate) a file over a DNS request covert channel","1dc5f777-bb62-c024-3838-e53492b5e574"
"AMSI Bypass Pattern Assembly GetType","high","","ps_script","Detects code fragments found in small and obfuscated AMSI bypass PowerShell scripts","b38a93d1-2bd3-6583-6617-1f4bdccf8589"
"WMImplant Hack Tool","high","","ps_script","Detects parameters used by WMImplant","a91bd8f4-12c9-8c19-370c-2ddece54fd99"
"Powershell Keylogging","medium","","ps_script","Adversaries may log user keystrokes to intercept credentials as the user types them.","c9aa7755-6950-a83c-72f5-53d0eab019eb"
"Access to Browser Login Data","medium","","ps_script","Adversaries may acquire credentials from web browsers by reading files specific to the target browser.
Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.
Web browsers typically store the credentials in an encrypted format within a credential store.
","0c3ed50a-e9ab-a1ab-192f-17494d3bcb53"
"AD Groups Or Users Enumeration Using PowerShell - ScriptBlock","low","","ps_script","Adversaries may attempt to find domain-level groups and permission settings.
The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.
","956b0dfd-4aba-c0c7-7608-c7889eea8a67"
"Powershell Detect Virtualization Environment","medium","","ps_script","Adversaries may employ various system checks to detect and avoid virtualization and analysis environments.
This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox
","654b7573-5b04-0352-d832-f32c333f4a56"
"Invoke-Obfuscation Via Use Rundll32 - PowerShell","high","","ps_script","Detects Obfuscated Powershell via use Rundll32 in Scripts","00b36dc9-4f98-0596-4487-6aabd187344b"
"PowerShell Hotfix Enumeration","medium","","ps_script","Detects call to ""Win32_QuickFixEngineering"" in order to enumerate installed hotfixes often used in ""enum"" scripts by attackers","3bef19ed-f703-65eb-ab07-eebb20abdd4e"
"Malicious PowerShell Commandlets - ScriptBlock","high","","ps_script","Detects Commandlet names from well-known PowerShell exploitation frameworks","247b332c-8cf3-11c1-bf63-2693c99a6082"
"Remove Account From Domain Admin Group","medium","","ps_script","Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users.
Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts.
","33a52335-678e-da31-eb46-d7cfc302cb3e"
"Invoke-Obfuscation Via Stdin - Powershell","high","","ps_script","Detects Obfuscated Powershell via Stdin in Scripts","e355cee1-576c-66ad-ccaf-3f4dfa5b541e"
"AADInternals PowerShell Cmdlets Execution - PsScript","high","","ps_script","Detects ADDInternals Cmdlet execution. A tool for administering Azure AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office 365.","61d6fe12-d403-c9b3-bc3f-fb10de58a4c3"
"Abuse of Service Permissions to Hide Services Via Set-Service - PS","high","","ps_script","Detects usage of the ""Set-Service"" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as ""sc.exe"", ""Get-Service""...etc. (Works only in powershell 7)","737309de-cb25-6cd6-de11-74ac6a587299"
"Tamper Windows Defender - ScriptBlockLogging","high","","ps_script","Detects PowerShell scripts attempting to disable scheduled scanning and other parts of Windows Defender ATP or set default actions to allow.","6074ad34-a80f-fdd9-5c49-e1a2fc4572c4"
"Active Directory Group Enumeration With Get-AdGroup","low","","ps_script","Detects usage of the ""Get-AdGroup"" cmdlet to enumerate Groups within Active Directory","80aaec39-a75b-8ad7-ac46-14fd5159f93f"
"Invoke-Obfuscation CLIP+ Launcher - PowerShell","high","","ps_script","Detects Obfuscated use of Clip.exe to execute PowerShell","fd4e11cc-a1e1-264d-4545-f06b97371ed2"
"Suspicious IO.FileStream","medium","","ps_script","Open a handle on the drive volume via the \\.\ DOS device path specifier and perform direct access read of the first few bytes of the volume.","6454f2bf-2962-a90a-eec3-6c7bef6be08e"
"Suspicious Process Discovery With Get-Process","low","","ps_script","Get the processes that are running on the local computer.","0e7ff574-cd58-3250-821d-47fedcc03db6"
"Potential Persistence Via PowerShell User Profile Using Add-Content","medium","","ps_script","Detects calls to ""Add-Content"" cmdlet in order to modify the content of the user profile and potentially adding suspicious commands for persistence","aa566d46-235a-b467-88ed-434788883da2"
"PowerShell ICMP Exfiltration","medium","","ps_script","Detects Exfiltration Over Alternative Protocol - ICMP. Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.","647d9a85-b4af-a355-a79e-5ad4afa553bd"
"Potential Unconstrained Delegation Discovery Via Get-ADComputer - ScriptBlock","medium","","ps_script","Detects the use of the ""Get-ADComputer"" cmdlet in order to identify systems which are configured for unconstrained delegation.","c0fcc261-538c-247d-21ff-05b6d2cbdf07"
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell","high","","ps_script","Detects Obfuscated Powershell via VAR++ LAUNCHER","70b65468-d1e8-0a6b-78c3-a458a95e477b"
"Windows Firewall Profile Disabled","medium","","ps_script","Detects when a user disables the Windows Firewall via a Profile to help evade defense.","b935d5dd-d5e5-51df-9c4f-dc30aec0a6e6"
"Password Policy Discovery With Get-AdDefaultDomainPasswordPolicy","low","","ps_script","Detetcts PowerShell activity in which Get-Addefaultdomainpasswordpolicy is used to get the default password policy for an Active Directory domain.","3c8ea56a-ad16-8598-c24e-3fdd6b345dda"
"Usage Of Web Request Commands And Cmdlets - ScriptBlock","medium","","ps_script","Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via PowerShell scriptblock logs","eddbf1d6-60c9-96f5-4cdf-f0947b3aad8f"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell Script","medium","","ps_script","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","7778d03c-e7bd-53bb-1f84-6557e3ecf12d"
"HackTool - Rubeus Execution - ScriptBlock","high","","ps_script","Detects the execution of the hacktool Rubeus using specific command line flags","1296d31f-9f66-0be1-424b-a641f15c4475"
"Troubleshooting Pack Cmdlet Execution","medium","","ps_script","Detects execution of ""TroubleshootingPack"" cmdlets to leverage CVE-2022-30190 or action similar to ""msdt"" lolbin (as described in LOLBAS)","297f849b-2dff-ce76-be52-6f50e2f5d205"
"Active Directory Computers Enumeration With Get-AdComputer","low","","ps_script","Detects usage of the ""Get-AdComputer"" to enumerate Computers or properties within Active Directory.","00f90856-99dc-9ecd-31ca-0d93b7577bac"
"Suspicious Invoke-Item From Mount-DiskImage","medium","","ps_script","Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW.","a4fa5d2e-a803-b311-5ff7-669ada2d36eb"
"Potential Packet Capture Activity Via Start-NetEventSession - ScriptBlock","medium","","ps_script","Detects the execution of powershell scripts with calls to the ""Start-NetEventSession"" cmdlet. Which allows an attacker to start event and packet capture for a network event session.
Adversaries may attempt to capture network to gather information over the course of an operation.
Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol.
","0357e3d7-f8fe-0601-0902-364f4cdbed81"
"Powershell Sensitive File Discovery","medium","","ps_script","Detect adversaries enumerate sensitive files","246287be-b277-41bc-b620-83f82d6006d3"
"Add Windows Capability Via PowerShell Script","medium","","ps_script","Detects usage of the ""Add-WindowsCapability"" cmdlet to add Windows capabilities. Notable capabilities could be ""OpenSSH"" and others.","8094e74c-0e24-f840-50c3-bfcdc98cd6a9"
"PowerShell Credential Prompt","high","","ps_script","Detects PowerShell calling a credential prompt","77e99ce3-b834-1c0d-0fe8-ffd39f1bc29f"
"Tamper Windows Defender Remove-MpPreference - ScriptBlockLogging","high","","ps_script","Detects attempts to remove Windows Defender configuration using the 'MpPreference' cmdlet","97e928f0-6985-66cd-fd2d-3783904a3c7c"
"Powershell Install a DLL in System Directory","high","","ps_script","Uses PowerShell to install/copy a file into a system directory such as ""System32"" or ""SysWOW64""","b16a0b26-d586-4ff7-f200-20927037e55f"
"Computer Discovery And Export Via Get-ADComputer Cmdlet - PowerShell","medium","","ps_script","Detects usage of the Get-ADComputer cmdlet to collect computer information and output it to a file","a86c5f75-859a-89ac-20a4-ad3be80336c9"
"Suspicious PowerShell Mailbox SMTP Forward Rule","medium","","ps_script","Detects usage of the powerShell Set-Mailbox Cmdlet to set-up an SMTP forwarding rule.","516b2199-36c5-1a0d-13f4-87bcb22bc2bf"
"Windows Screen Capture with CopyFromScreen","medium","","ps_script","Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation.
Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations
","bf9ed747-37f2-803e-2a51-91d56622d6ba"
"Automated Collection Command PowerShell","medium","","ps_script","Once established within a system or network, an adversary may use automated techniques for collecting internal data.","d7f88495-fd82-8062-2c13-6036a8358e39"
"Powershell XML Execute Command","medium","","ps_script","Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell)
Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code
","f698fa3e-50d4-0a6b-4f65-9cc569e1a709"
"Windows Defender Exclusions Added - PowerShell","medium","","ps_script","Detects modifications to the Windows Defender configuration settings using PowerShell to add exclusions","addd9852-1b8e-322b-77eb-4a749ba8dca6"
"Malicious ShellIntel PowerShell Commandlets","high","","ps_script","Detects Commandlet names from ShellIntel exploitation scripts.","e84977df-6377-368d-ed22-e05ee31e9947"
"Testing Usage of Uncommonly Used Port","medium","","ps_script","Adversaries may communicate using a protocol and port paring that are typically not associated.
For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443.
","629a73b6-b63c-b6d1-5e2c-5d7ee3042f44"
"Suspicious Eventlog Clear","medium","","ps_script","Detects usage of known powershell cmdlets such as ""Clear-EventLog"" to clear the Windows event logs","a8e07a3d-571c-0d25-729b-fa16be9ea6c5"
"Suspicious PowerShell Invocations - Specific","high","","ps_script","Detects suspicious PowerShell invocation command parameters","8655ba53-c937-dbcf-91c5-3125219b9497"
"PowerShell Script With File Upload Capabilities","low","","ps_script","Detects PowerShell scripts leveraging the ""Invoke-WebRequest"" cmdlet to send data via either ""PUT"" or ""POST"" method.","4dc42aa9-1963-4ee8-e6ed-021575365449"
"DirectorySearcher Powershell Exploitation","medium","","ps_script","Enumerates Active Directory to determine computers that are joined to the domain","d72c1916-ab63-11e1-1916-5e8b3822f133"
"Potential Suspicious Windows Feature Enabled","medium","","ps_script","Detects usage of the built-in PowerShell cmdlet ""Enable-WindowsOptionalFeature"" used as a Deployment Image Servicing and Management tool.
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
","c9326131-769a-8ba4-03f2-7d17f9847a50"
"PowerShell ShellCode","high","","ps_script","Detects Base64 encoded Shellcode","7f3d30e6-1565-4e09-7b13-5d7c5b8b0947"
"Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell","medium","","ps_script","Detects Obfuscated Powershell via COMPRESS OBFUSCATION","527063ac-15f7-52e7-7ced-4348087aaec7"
"Code Executed Via Office Add-in XLL File","high","","ps_script","Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system.
Office add-ins can be used to add functionality to Office programs
","f5ce4704-7343-4e6a-f741-f53b6d412d1f"
"Suspicious GetTypeFromCLSID ShellExecute","medium","","ps_script","Detects suspicious Powershell code that execute COM Objects","9134b08c-39fa-8211-b3f5-5bd1839b9540"
"Potential Invoke-Mimikatz PowerShell Script","high","","ps_script","Detects Invoke-Mimikatz PowerShell script and alike. Mimikatz is a credential dumper capable of obtaining plaintext Windows account logins and passwords.","b0c6066e-a243-d2f6-c744-990ed060759c"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","","ps_script","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","6ab29276-37b6-8501-afb8-33126a6a9918"
"Powershell Create Scheduled Task","medium","","ps_script","Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code","977cdcc1-6d3a-a221-a03f-d794230e01ae"
"Certificate Exported Via PowerShell - ScriptBlock","medium","","ps_script","Detects calls to cmdlets inside of PowerShell scripts that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines.","58f5980d-d851-77b4-2f1f-945eb2d3e430"
"Execute Invoke-command on Remote Host","medium","","ps_script","Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.","a4603d3c-bb7c-8db0-3d8a-23f265190006"
"Malicious PowerShell Keywords","medium","","ps_script","Detects keywords from well-known PowerShell exploitation frameworks","4397a007-0c10-834b-0796-7b4b1b931b03"
"Disable-WindowsOptionalFeature Command PowerShell","high","","ps_script","Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
","cb989f20-ebb9-8b1b-a5d6-f98b3929346c"
"Powershell Suspicious Win32_PnPEntity","low","","ps_script","Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.","12bd77fd-a44d-6373-2156-4c29b22d9c85"
"Powershell LocalAccount Manipulation","medium","","ps_script","Adversaries may manipulate accounts to maintain access to victim systems.
Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups
","ec4cdf41-f053-d3af-6a68-973d32bacdff"
"Winlogon Helper DLL","medium","","ps_script","Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.
Registry entries in HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\ and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ are
used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to
load and execute malicious DLLs and/or executables.
","de547eac-5fa2-bf69-1a62-760251de3870"
"Replace Desktop Wallpaper by Powershell","low","","ps_script","An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users.
This may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper
","a427508a-2c94-8fdb-863f-555304b70605"
"WMIC Unquoted Services Path Lookup - PowerShell","medium","","ps_script","Detects known WMI recon method to look for unquoted service paths, often used by pentest inside of powershell scripts attackers enum scripts","437f4723-94d2-dfdf-cd3b-9cf2e0af0fba"
"Get-ADUser Enumeration Using UserAccountControl Flags","medium","","ps_script","Detects AS-REP roasting is an attack that is often-overlooked. It is not very common as you have to explicitly set accounts that do not require pre-authentication.","0fb43313-1253-f71b-1a13-e10e073c1627"
"Enumerate Credentials from Windows Credential Manager With PowerShell","medium","","ps_script","Adversaries may search for common password storage locations to obtain user credentials.
Passwords are stored in several places on a system, depending on the operating system or application holding the credentials.
","129010c2-32d8-8ae8-d3a5-cdd24744231e"
"Potential PowerShell Obfuscation Using Character Join","low","","ps_script","Detects specific techniques often seen used inside of PowerShell scripts to obfscuate Alias creation","5ab8284b-d017-c68c-31ff-6c9b51010284"
"Suspicious PowerShell WindowStyle Option","medium","","ps_script","Adversaries may use hidden windows to conceal malicious activity from the plain sight of users.
In some cases, windows that would typically be displayed when an application carries out an operation can be hidden
","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"Extracting Information with PowerShell","medium","","ps_script","Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials.
These can be files created by users to store their own credentials, shared credential stores for a group of individuals,
configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.
","f9889db2-6490-a082-33a3-1b46dff5e2f1"
"Veeam Backup Servers Credential Dumping Script Execution","high","","ps_script","Detects execution of a PowerShell script that contains calls to the ""Veeam.Backup"" class, in order to dump stored credentials.","5ac6d31e-76f4-b5ee-831e-7d076ff2dca6"
"Invoke-Obfuscation STDIN+ Launcher - Powershell","high","","ps_script","Detects Obfuscated use of stdin to execute PowerShell","a4545017-4d6d-c3bd-7fec-62214f01e6b2"
"Dump Credentials from Windows Credential Manager With PowerShell","medium","","ps_script","Adversaries may search for common password storage locations to obtain user credentials.
Passwords are stored in several places on a system, depending on the operating system or application holding the credentials.
","437d2bdc-4ee9-913b-42df-e947c8193f88"
"Registry-Free Process Scope COR_PROFILER","medium","","ps_script","Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR.
The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR).
These profiliers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR.
(Citation: Microsoft Profiling Mar 2017)
(Citation: Microsoft COR_PROFILER Feb 2013)
","98d89b85-61ea-f78b-d1fa-cd52182b6b28"
"Suspicious PowerShell Get Current User","low","","ps_script","Detects the use of PowerShell to identify the current logged user.","43541d1d-9cb1-a49f-2fb9-4121c1302705"
"Powershell Store File In Alternate Data Stream","medium","","ps_script","Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.","a547df68-c62d-4415-9a62-cbe68f006b9e"
"Suspicious PowerShell Mailbox Export to Share - PS","critical","","ps_script","Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations","53ba1f6b-70f2-242f-1377-8dc22d806e78"
"Suspicious Connection to Remote Account","low","","ps_script","Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts.
Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism
","f9203bdd-ca24-aced-1e79-b9cfd7936099"
"Change User Agents with WebRequest","medium","","ps_script","Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.
Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.
","efbceae5-07cf-4b09-fc03-df062b971e10"
"Recon Information for Export with PowerShell","medium","","ps_script","Once established within a system or network, an adversary may use automated techniques for collecting internal data","aa7ecfb4-5a28-3a35-0b06-35cdfed46928"
"Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell","medium","","ps_script","Detects Obfuscated Powershell via RUNDLL LAUNCHER","c4a3b240-b0c5-3eed-9e95-d3db01157764"
"Invoke-Obfuscation Via Use Clip - Powershell","high","","ps_script","Detects Obfuscated Powershell via use Clip.exe in Scripts","33811b3f-3506-6bff-bb4a-4250e7714358"
"PowerShell Write-EventLog Usage","medium","","ps_script","Detects usage of the ""Write-EventLog"" cmdlet with 'RawData' flag. The cmdlet can be levreage to write malicious payloads to the EventLog and then retrieve them later for later use","777d9383-7a6f-f82a-d22e-2f05f433bc9b"
"PowerShell Deleted Mounted Share","medium","","ps_script","Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation","2182e106-ae16-770c-3022-a67abacb10d0"
"Invoke-Obfuscation Via Use MSHTA - PowerShell","high","","ps_script","Detects Obfuscated Powershell via use MSHTA in Scripts","d7307e8a-60da-106b-aeb8-c4ebd5c1fb6d"
"Suspicious X509Enrollment - Ps Script","medium","","ps_script","Detect use of X509Enrollment","8acde15f-c52f-455b-127c-8de1892767e5"
"Clear PowerShell History - PowerShell","medium","","ps_script","Detects keywords that could indicate clearing PowerShell history","36e3fc18-c21d-b046-86b0-9f14ccbb975e"
"Potential COM Objects Download Cradles Usage - PS Script","medium","","ps_script","Detects usage of COM objects that can be abused to download files in PowerShell by CLSID","8c8871af-c2f2-4671-9f1d-d6c3e90b7c42"
"Potential Active Directory Enumeration Using AD Module - PsScript","medium","","ps_script","Detects usage of the ""Import-Module"" cmdlet to load the ""Microsoft.ActiveDirectory.Management.dl"" DLL. Which is often used by attackers to perform AD enumeration.","80fe1b47-6d38-9fc5-9535-6afd04b55a15"
"Suspicious FromBase64String Usage On Gzip Archive - Ps Script","medium","","ps_script","Detects attempts of decoding a base64 Gzip archive in a PowerShell script. This technique is often used as a method to load malicious content into memory afterward.","0f434135-833f-9c32-7048-ab3c6264d3d2"
"Powershell WMI Persistence","medium","","ps_script","Adversaries may establish persistence and elevate privileges by executing malicious content triggered by a Windows Management Instrumentation (WMI) event subscription.","6535a2a7-e5ce-2a80-726d-8eb3b016084d"
"Powershell Token Obfuscation - Powershell","high","","ps_script","Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation","77af6d22-9887-7943-53f1-6a849e2e892d"
"Suspicious Mount-DiskImage","low","","ps_script","Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW.","a47e2fc3-e3e3-9763-7cb2-d19df00ad719"
"Suspicious Get Local Groups Information - PowerShell","low","","ps_script","Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.
","231be74a-ed58-7e55-d906-23131f589913"
"Unsigned AppX Installation Attempt Using Add-AppxPackage - PsScript","medium","","ps_script","Detects usage of the ""Add-AppxPackage"" or it's alias ""Add-AppPackage"" to install unsigned AppX packages","649adb28-28ab-34b1-166d-cfffb0245bbd"
"Import PowerShell Modules From Suspicious Directories","medium","","ps_script","Detects powershell scripts that import modules from suspicious directories","0a3956ee-9813-55f3-ca74-4d00e9df5262"
"Disable Powershell Command History","high","","ps_script","Detects scripts or commands that disabled the Powershell command history by removing psreadline module","ebdae8b0-7b83-5602-356e-b214571cee19"
"Suspicious PowerShell Download - Powershell Script","medium","","ps_script","Detects suspicious PowerShell download command","e3888b82-f1d3-14e8-54e5-16b522dfd8a9"
"Suspicious TCP Tunnel Via PowerShell Script","medium","","ps_script","Detects powershell scripts that creates sockets/listeners which could be indicative of tunneling activity","f0174af7-3de1-3209-5f81-f96ff9d1f5c6"
"Suspicious GPO Discovery With Get-GPO","low","","ps_script","Detect use of Get-GPO to get one GPO or all the GPOs in a domain.","43254631-95ca-6c3c-11bc-16c19f09e819"
"Invoke-Obfuscation VAR+ Launcher - PowerShell","high","","ps_script","Detects Obfuscated use of Environment Variables to execute PowerShell","1bc61c35-56bd-6b9c-12fc-5513d8aa80d2"
"Powershell Add Name Resolution Policy Table Rule","high","","ps_script","Detects powershell scripts that adds a Name Resolution Policy Table (NRPT) rule for the specified namespace.
This will bypass the default DNS server and uses a specified server for answering the query.
","6dcad107-58f0-d885-7198-fe78bda1ff4b"
"Potential Suspicious PowerShell Keywords","medium","","ps_script","Detects potentially suspicious keywords that could indicate the use of a PowerShell exploitation framework","12b5b805-7b4b-d153-35e2-2230d216346c"
"Potential PowerShell Obfuscation Using Alias Cmdlets","low","","ps_script","Detects Set-Alias or New-Alias cmdlet usage. Which can be use as a mean to obfuscate PowerShell scripts","2b77aa85-451b-f506-eda5-71bef0c2bfa6"
"PowerShell Get-Process LSASS in ScriptBlock","high","","ps_script","Detects a Get-Process command on lsass process, which is in almost all cases a sign of malicious activity","77515874-226e-d597-815a-9962d2951358"
"Automated Collection Bookmarks Using Get-ChildItem PowerShell","low","","ps_script","Adversaries may enumerate browser bookmarks to learn more about compromised hosts.
Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about
internal network resources such as servers, tools/dashboards, or other related infrastructure.
","389e5737-c793-4d03-4191-fe78d2cc1dcb"
"Suspicious Get Information for SMB Share","low","","ps_script","Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as
a precursor for Collection and to identify potential systems of interest for Lateral Movement.
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.
","b3cb91b9-f3a8-1486-c398-1ea1e5183b3c"
"Suspicious Non PowerShell WSMAN COM Provider","medium","powershell-classic","","Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell","medium","powershell-classic","","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","ee9681d0-6ba5-5eaf-9c8b-fe39afe542b9"
"Potential RemoteFXvGPUDisablement.EXE Abuse","high","powershell-classic","","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of  the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","29a3935d-0428-4f39-d39e-ec43c598b272"
"Possible DC Shadow Attack","medium","security","","Detects DCShadow via create new SPN","c800ccd5-5818-b0f5-1a12-f9c8bc24a433"
"Active Directory User Backdoors","high","security","","Detects scenarios where one can control another users or computers account without having to use their credentials.","c9123898-04d5-2d3b-5e2b-7c0c92111480"
"Correct Execution of Nltest.exe","high","security","","The attacker might use LOLBAS nltest.exe for discovery of domain controllers, domain trusts, parent domain and the current user permissions.","83c2f19e-f588-1826-fc7d-cf7f4db7031a"
"Password Policy Enumerated","medium","security","","Detects when the password policy is enumerated.","9bcf333e-fc4c-5912-eeba-8a0cefe21be4"
"Reconnaissance Activity","high","security","","Detects activity as ""net user administrator /domain"" and ""net group domain admins /domain""","5ac4b7f8-9412-f919-220c-aa8a1867b1ef"
"AD Privileged Users or Groups Reconnaissance","high","security","","Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs","93c95eee-748a-e1db-18a5-f40035167086"
"Dir Svc Obj Modified","informational","security","","Directory Service Object Modified. Log written only to domain controllers (2008+)","22ee9fb7-64ca-4eed-92de-d1dbef1170b8"
"Group Policy Abuse for Privilege Addition","medium","security","","Detects the first occurrence of a modification to Group Policy Object Attributes to add privileges to user accounts or use them to add users as local admins.
","6e3066ef-54e1-9d1b-5bc6-9ae6947ae271"
"Persistence and Execution at Scale via GPO Scheduled Task","high","security","","Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale","01628b51-85e1-4088-9432-a11cba9f3ebd"
"Powerview Add-DomainObjectAcl DCSync AD Extend Right","high","security","","Backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer","e92d7fea-4127-4b6c-a889-3f0b89f7b567"
"Startup/Logon Script Added to Group Policy Object","medium","security","","Detects the modification of Group Policy Objects (GPO) to add a startup/logon script to users or computer objects.
","bc613d09-5a80-cad3-6f65-c5020f960511"
"Possible DC Shadow Attack","medium","security","","Detects DCShadow via create new SPN","c800ccd5-5818-b0f5-1a12-f9c8bc24a433"
"Possible Shadow Credentials Added","high","security","","Detects possible addition of shadow credentials to an active directory object.","8bcf1772-4335-28e1-e320-5ce48b15ae9f"
"Suspicious LDAP-Attributes Used","high","security","","Detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.","925d441a-37b4-0afa-1d98-809b5df5fd06"
"Active Directory User Backdoors","high","security","","Detects scenarios where one can control another users or computers account without having to use their credentials.","c9123898-04d5-2d3b-5e2b-7c0c92111480"
"ADCS Certificate Template Configuration Vulnerability with Risky EKU","high","security","","Detects certificate creation with template allowing risk permission subject and risky EKU","aa2d5bf7-bc73-068e-a4df-a887cc3aba2b"
"ADCS Certificate Template Configuration Vulnerability","low","security","","Detects certificate creation with template allowing risk permission subject","3a655a7c-a830-77ad-fc8b-f054fb713304"
"NetShare File Access","informational","security","","","8c6ec2b2-8dad-4996-9aba-d659afc1b919"
"Remote Registry Management Using Reg Utility","medium","security","","Remote registry management using REG utility from non-admin workstation","e9f405d3-e7ea-9adf-2f31-9ab2a7a90f5a"
"Suspicious PsExec Execution","high","security","","detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one","426009da-814c-c1c0-cf41-6631c9ff6a8e"
"Possible PetitPotam Coerce Authentication Attempt","high","security","","Detect PetitPotam coerced authentication activity.","bcc12e55-1578-5174-2a47-98a6211a1c6c"
"Windows Network Access Suspicious desktop.ini Action","medium","security","","Detects unusual processes accessing desktop.ini remotely over network share, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.","192d9d70-11ad-70e5-9d6c-d32a1ec74857"
"SMB Create Remote File Admin Share","high","security","","Look for non-system accounts SMB accessing a file with write (0x2) access mask via administrative share (i.e C$).","37f5d188-182d-7a53-dca7-4bebbb6ce43e"
"Protected Storage Service Access","high","security","","Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers","7695295d-281f-23ce-d52e-8336ebd47532"
"Transferring Files with Credential Data via Network Shares","medium","security","","Transferring files with well-known filenames (sensitive files with credential data) using network shares","73d3720b-e4f3-d7e1-2a3f-8ca0a5e1fc1b"
"DCERPC SMB Spoolss Named Pipe","medium","security","","Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.","d415c82b-814d-5cdc-c2f2-a138115b878e"
"Persistence and Execution at Scale via GPO Scheduled Task","high","security","","Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale","01628b51-85e1-4088-9432-a11cba9f3ebd"
"Impacket PsExec Execution","high","security","","Detects execution of Impacket's psexec.py.","24e370e0-b9f0-5851-0261-f984742ff2a1"
"T1047 Wmiprvse Wbemcomn DLL Hijack","high","security","","Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network for a WMI DLL Hijack scenario.","f252afa3-fe83-562c-01c0-1334f55af84c"
"Remote Task Creation via ATSVC Named Pipe","medium","security","","Detects remote task creation via at.exe or API interacting with ATSVC namedpipe","93fd0f77-62da-26fb-3e96-71cde45a9680"
"Startup/Logon Script Added to Group Policy Object","medium","security","","Detects the modification of Group Policy Objects (GPO) to add a startup/logon script to users or computer objects.
","bc613d09-5a80-cad3-6f65-c5020f960511"
"Remote Service Activity via SVCCTL Named Pipe","medium","security","","Detects remote service activity via remote access to the svcctl named pipe","9a0e08fc-d50e-2539-9da0-f2b04439c414"
"DCOM InternetExplorer.Application Iertutil DLL Hijack - Security","high","security","","Detects a threat actor creating a file named `iertutil.dll` in the `C:\Program Files\Internet Explorer\` directory over the network for a DCOM InternetExplorer DLL Hijack scenario.","85e72fe3-83af-8ed9-39d3-2883e46059f1"
"Possible Impacket SecretDump Remote Activity","high","security","","Detect AD credential dumping using impacket secretdump HKTL","677980bc-7dcc-1f9a-e161-a7f310ec9652"
"First Time Seen Remote Named Pipe","high","security","","This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes","308a3356-4624-7c95-24df-cf5a02e5eb56"
"Suspicious Access to Sensitive File Extensions","medium","security","","Detects known sensitive file extensions accessed on a network share","4af39497-9655-9586-817d-94f0df38913f"
"CVE-2021-1675 Print Spooler Exploitation IPC Access","critical","security","","Detects remote printer driver load from Detailed File Share in Security logs that are a sign of successful exploitation attempts against print spooler vulnerability CVE-2021-1675 and CVE-2021-34527","52b5923e-1ef2-aaad-5513-3c830f3c5850"
"NetShare Access","informational","security","","","15d042c1-07c6-4e16-ae7d-e0e556ccd9a8"
"Access To ADMIN$ Network Share","low","security","","Detects access to ADMIN$ network share","37b219bc-37bb-1261-f179-64307c1a1829"
"Potential CVE-2023-36884 Exploitation - Share Access","high","security","","Detects access to a file share with a naming schema seen being used during exploitation of CVE-2023-36884","5a3b13ed-8700-5d72-5592-4dbeacbeeb64"
"Windows Defender Exclusion Deleted","medium","security","","Detects when a Windows Defender exclusion has been deleted. This could indicate an attacker trying to delete their tracks by removing the added exclusions
","7bd85790-c82a-56af-7127-f257e5ef6c6f"
"Net Conn","informational","security","","The Windows Filtering Platform has allowed a connection.","d0a61a11-57c9-4afc-b940-3f19b60db08e"
"Net Conn Blocked","informational","security","","The Windows Filtering Platform has blocked a connection.","b793a8e6-28a4-4fb8-816e-17a99e4e7b40"
"Enumeration via the Global Catalog","medium","security","","Detects enumeration of the global catalog (that can be performed using BloodHound or others AD reconnaissance tools). Adjust Threshold according to domain width.","ffaf246b-f54a-05ba-d9b0-fba6626c7822"
"Uncommon Connection to Active Directory Web Services","medium","","network_connection","Detects uncommon network connections to the Active Directory Web Services (ADWS) from processes not typically associated with ADWS management.
","b2c34a06-251e-87ee-2d3e-fae878185d34"
"Outbound Network Connection Initiated By Script Interpreter","high","","network_connection","Detects a script interpreter wscript/cscript opening a network connection to a non-local network. Adversaries may use script to download malicious payloads.","1487f05c-b749-4322-d657-d20a2eea7e47"
"RDP to HTTP or HTTPS Target Ports","high","","network_connection","Detects svchost hosting RDP termsvcs communicating to target systems on TCP port 80 or 443","5049ed9f-e700-a499-9498-5e648851d2ad"
"Remote Access Tool - AnyDesk Incoming Connection","medium","","network_connection","Detects incoming connections to AnyDesk. This could indicate a potential remote attacker trying to connect to a listening instance of AnyDesk and use it as potential command and control channel.
","5a099129-36a4-b13b-5345-9f37b231fb5c"
"Network Connection Initiated By Eqnedt32.EXE","high","","network_connection","Detects network connections from the Equation Editor process ""eqnedt32.exe"".","141fe5f1-4de3-21fd-1b09-8d53f1019340"
"Network Connection Initiated By Regsvr32.EXE","medium","","network_connection","Detects a network connection initiated by ""Regsvr32.exe""","6814d247-c70b-e49e-6553-149fc21c3a81"
"Communication To Uncommon Destination Ports","medium","","network_connection","Detects programs that connect to uncommon destination ports","7983db98-5767-b29d-2652-a01fd3e751ad"
"Outbound RDP Connections Over Non-Standard Tools","high","","network_connection","Detects Non-Standard tools initiating a connection over port 3389 indicating possible lateral movement.
An initial baseline is required before using this utility to exclude third party RDP tooling that you might use.
","e02f9ef8-2edb-79a4-0626-b506436d7ebe"
"Suspicious Outbound SMTP Connections","medium","","network_connection","Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.
The data may also be sent to an alternate network location from the main command and control server.
","94af51b6-e4c1-f780-3f48-90c3d7e35ea4"
"Uncommon Outbound Kerberos Connection","medium","","network_connection","Detects uncommon outbound network activity via Kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.
","7c743e5c-7a9d-ba96-9ada-1d17687e2a6d"
"Rundll32 Internet Connection","medium","","network_connection","Detects a rundll32 that communicates with public IP addresses","4a7137e3-d863-49dd-6199-5ca7722de62e"
"Outbound Network Connection Initiated By Microsoft Dialer","high","","network_connection","Detects outbound network connection initiated by Microsoft Dialer.
The Microsoft Dialer, also known as Phone Dialer, is a built-in utility application included in various versions of the Microsoft Windows operating system. Its primary function is to provide users with a graphical interface for managing phone calls via a modem or a phone line connected to the computer.
This is an outdated process in the current conext of it's usage and is a common target for info stealers for process injection, and is used to make C2 connections, common example is ""Rhadamanthys""
","fa5330d2-19f1-4167-52a0-fb622b6425f8"
"RDP Over Reverse SSH Tunnel","high","","network_connection","Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389","81ca22c3-fdfd-6c3a-051f-dc404488536c"
"Silenttrinity Stager Msbuild Activity","high","","network_connection","Detects a possible remote connections to Silenttrinity c2","f96b2d35-57da-bef8-3624-73634617eac6"
"Python Initiated Connection","medium","","network_connection","Detects a Python process initiating a network connection. While this often relates to package installation, it can also indicate a potential malicious script communicating with a C&C server.","cb64ddfa-8325-dc30-db3f-e546a9b1eba5"
"Suspicious Wordpad Outbound Connections","medium","","network_connection","Detects a network connection initiated by ""wordpad.exe"" over uncommon destination ports.
This might indicate potential process injection activity from a beacon or similar mechanisms.
","510d0486-0545-9178-93cb-5f5a8c75930b"
"Microsoft Sync Center Suspicious Network Connections","medium","","network_connection","Detects suspicious connections from Microsoft Sync Center to non-private IPs.","e2d0c6fb-f0de-9cce-076d-f755f6ae4956"
"Office Application Initiated Network Connection Over Uncommon Ports","medium","","network_connection","Detects an office suit application (Word, Excel, PowerPoint, Outlook) communicating to target systems over uncommon ports.","8cf1b63a-f161-0e51-a9d2-cc697d06a5a4"
"Network Communication Initiated To File Sharing Domains From Process Located In Suspicious Folder","high","","network_connection","Detects executables located in potentially suspicious directories initiating network connections towards file sharing domains.","34ba9d0c-a415-a91a-013b-30158906f18c"
"Network Connection Initiated By AddinUtil.EXE","high","","network_connection","Detects a network connection initiated by the Add-In deployment cache updating utility ""AddInutil.exe"".
This could indicate a potential command and control communication as this tool doesn't usually initiate network activity.
","8d993d6b-e44b-0df0-91c0-6093975b69f8"
"Network Connection Initiated By IMEWDBLD.EXE","high","","network_connection","Detects a network connection initiated by IMEWDBLD.EXE. This might indicate potential abuse of the utility as a LOLBIN in order to download arbitrary files or additional payloads.
","0f4d93f0-a1eb-e6cb-7d79-f38cc95a9a55"
"Network Connection Initiated Via Notepad.EXE","high","","network_connection","Detects a network connection that is initiated by the ""notepad.exe"" process.
This might be a sign of process injection from a beacon process or something similar.
Notepad rarely initiates a network communication except when printing documents for example.
","e6f76f81-e758-4001-122c-58a3ceef02f9"
"Office Application Initiated Network Connection To Non-Local IP","medium","","network_connection","Detects an office application (Word, Excel, PowerPoint)  that initiate a network connection to a non-private IP addresses.
This rule aims to detect traffic similar to one seen exploited in CVE-2021-42292.
This rule will require an initial baseline and tuning that is specific to your organization.
","7c154a7f-01a0-3b2e-927d-32c452139322"
"Uncommon Network Connection Initiated By Certutil.EXE","high","","network_connection","Detects a network connection initiated by the certutil.exe utility.
Attackers can abuse the utility in order to download malware or additional payloads.
","bc5e54c2-1b8d-cb27-3079-f47318f4ccc7"
"Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location","high","","network_connection","Detects a network connection initiated by programs or processes running from suspicious or uncommon files system locations.
","1ba0b3d6-e0f7-98e9-4611-b307922a0766"
"Outbound Network Connection Initiated By Cmstp.EXE","high","","network_connection","Detects a network connection initiated by Cmstp.EXE
Its uncommon for ""cmstp.exe"" to initiate an outbound network connection. Investigate the source of such requests to determine if they are malicious.
","41d54b25-deb6-4ea3-fbac-3f5b6e200939"
"RegAsm.EXE Initiating Network Connection To Public IP","medium","","network_connection","Detects ""RegAsm.exe"" initiating a network connection to public IP adresses","a0e133b9-f055-5011-01e6-75ed480ad2da"
"Potentially Suspicious Malware Callback Communication","high","","network_connection","Detects programs that connect to known malware callback ports based on statistical analysis from two different sandbox system databases
","7ac85830-5907-5206-2d25-490b3ace5587"
"Local Network Connection Initiated By Script Interpreter","medium","","network_connection","Detects a script interpreter (Wscript/Cscript) initiating a local network connection to download or execute a script hosted on a shared folder.
","7e448677-939e-f6d0-e901-91843a3888d7"
"Outbound Network Connection To Public IP Via Winlogon","medium","","network_connection","Detects a ""winlogon.exe"" process that initiate network communications with public IP addresses","3c6c2271-decf-a5c0-b983-edaa9cf7077d"
"New RDP Connection Initiated From Domain Controller","high","","network_connection","Detects an RDP connection originating from a domain controller.","8b0f1458-5a23-5950-ebc7-f8d7a562dc06"
"Suspicious Epmap Connection","high","","network_connection","Detects suspicious ""epmap"" connection to a remote computer via remote procedure call (RPC)","58a2d80c-c77b-324c-640d-c97cf5fcbefa"
"Network Connection Initiated From Users\Public Folder","medium","","network_connection","Detects a network connection initiated from a process located in the ""C:\Users\Public"" folder.
Attacker are known to drop their malicious payloads and malware in this directory as its writable by everyone.
Use this rule to hunt for potential suspicious or uncommon activity in your environement.
","a1027f51-4eb5-a16d-91bf-9e124bb594dd"
"Msiexec.EXE Initiated Network Connection Over HTTP","low","","network_connection","Detects a network connection initiated by an ""Msiexec.exe"" process over port 80 or 443.
Adversaries might abuse ""msiexec.exe"" to install and execute remotely hosted packages.
Use this rule to hunt for potentially anomalous or suspicious communications.
","8696ae22-70c1-ca19-4888-66ed19ea27da"
"Dfsvc.EXE Initiated Network Connection Over Uncommon Port","high","","network_connection","Detects an initiated network connection over uncommon ports from ""dfsvc.exe"". A utility used to handled ClickOnce applications.","4255ccee-f954-7d80-4281-d5a5fe9ea9f7"
"HH.EXE Initiated HTTP Network Connection","medium","","network_connection","Detects a network connection initiated by the ""hh.exe"" process to HTTP destination ports, which could indicate the execution/download of remotely hosted .chm files.
","13790f2d-97b2-d1a0-6624-1061d7ccbb8c"
"Dfsvc.EXE Network Connection To Non-Local IPs","medium","","network_connection","Detects network connections from ""dfsvc.exe"" used to handled ClickOnce applications to non-local IPs","713fd43d-88e4-6801-2eac-756d06792d4f"
"Network Connection Initiated By PowerShell Process","low","","network_connection","Detects a network connection that was initiated from a PowerShell process.
Often times malicious powershell scripts download additional payloads or communicate back to command and control channels via uncommon ports or IPs.
Use this rule as a basis for hunting for anomalies.
","9e00ae65-e5aa-2c89-c7a1-7b6ee0e194f5"
"Dllhost.EXE Initiated Network Connection To Non-Local IP Address","medium","","network_connection","Detects Dllhost.EXE initiating a network connection to a non-local IP address.
Aside from Microsoft own IP range that needs to be excluded. Network communication from Dllhost will depend entirely on the hosted DLL.
An initial baseline is recommended before deployment.
","1062d249-f014-9faf-044e-2b75d6f9763f"
"Remote PowerShell Sessions Network Connections (WinRM)","high","security","","Detects basic PowerShell Remoting (WinRM) by monitoring for network inbound connections to ports 5985 OR 5986","cc1d9970-7c17-d738-f5cb-8fb12f02d0fd"
"Windows Filtering Platform Blocked Connection From EDR Agent Binary","high","security","","Detects a Windows Filtering Platform (WFP) blocked connection event involving common Endpoint Detection and Response (EDR) agents.
Adversaries may use WFP filters to prevent Endpoint Detection and Response (EDR) agents from reporting security events.
","764518e5-4160-b679-1946-cbd0e76705da"
"RDP over Reverse SSH Tunnel WFP","high","security","","Detects svchost hosting RDP termsvcs communicating with the loopback address","810804a5-98c3-7e56-e8ed-8a95d72ad829"
"Uncommon Outbound Kerberos Connection - Security","medium","security","","Detects uncommon outbound network activity via Kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.
","1ee90f6c-2d09-5bcf-b8fd-06fe14f86746"
"Windows Defender Exclusion Deleted","medium","security","","Detects when a Windows Defender exclusion has been deleted. This could indicate an attacker trying to delete their tracks by removing the added exclusions
","7bd85790-c82a-56af-7127-f257e5ef6c6f"
"Registry Modification to Hidden File Extension","medium","","registry_set","Hides the file extension through modification of the registry","88665d21-f330-6799-62f0-724746a160d7"
"Microsoft Office Protected View Disabled","high","","registry_set","Detects changes to Microsoft Office protected view registry keys with which the attacker disables this feature.","b8f4d6cb-7db9-474a-2da3-8465b2f9b699"
"Potential Registry Persistence Attempt Via DbgManagedDebugger","medium","","registry_set","Detects the addition of the ""Debugger"" value to the ""DbgManagedDebugger"" key in order to achieve persistence. Which will get invoked when an application crashes","8ce03c3b-7a99-449f-6af3-9f5f4685385b"
"ServiceDll Hijack","medium","","registry_set","Detects changes to the ""ServiceDLL"" value related to a service in the registry.
This is often used as a method of persistence.
","7d12e91a-b670-4461-8bdc-aff5b37eda63"
"UAC Bypass Using Windows Media Player - Registry","high","","registry_set","Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)","42974e40-8ef8-03fa-d9ca-4d3522a5b239"
"Registry Persistence via Explorer Run Key","high","","registry_set","Detects a possible persistence mechanism using RUN key for Windows Explorer and pointing to a suspicious folder","2c5460e8-fa5b-2a17-1e53-f6f3789de52d"
"Modify User Shell Folders Startup Value","high","","registry_set","Detect modification of the startup key to a path where a payload could be stored to be launched during startup","ba919d03-0c34-c3c3-272c-ec0656c3d10c"
"Trust Access Disable For VBApplications","high","","registry_set","Detects registry changes to Microsoft Office ""AccessVBOM"" to a value of ""1"" which disables trust access for VBA on the victim machine and lets attackers execute malicious macros without any Microsoft Office warnings.","d5d54339-c5a4-2889-7da2-66fd42b16ef0"
"Potential Persistence Via App Paths Default Property","high","","registry_set","Detects changes to the ""Default"" property for keys located in the \Software\Microsoft\Windows\CurrentVersion\App Paths\ registry. Which might be used as a method of persistence
The entries found under App Paths are used primarily for the following purposes.
First, to map an application's executable file name to that file's fully qualified path.
Second, to prepend information to the PATH environment variable on a per-application, per-process basis.
","addf4ebc-b3ab-c6ab-98ba-db37848a8ee2"
"COM Hijacking via TreatAs","medium","","registry_set","Detect modification of TreatAs key to enable ""rundll32.exe -sta"" command","0a89f91f-0278-2cf2-d4ad-c958bc125ad3"
"Disable Internal Tools or Feature in Registry","medium","","registry_set","Detects registry modifications that change features of internal Windows tools (malware like Agent Tesla uses this technique)","ebfabc1f-964a-69f3-60d7-e027eaaf1022"
"MaxMpxCt Registry Value Changed","low","","registry_set","Detects changes to the ""MaxMpxCt"" registry value.
MaxMpxCt specifies the maximum outstanding network requests for the server per client, which is used when negotiating a Server Message Block (SMB) connection with a client. Note if the value is set beyond 125 older Windows 9x clients will fail to negotiate.
Ransomware threat actors and operators (specifically BlackCat) were seen increasing this value in order to handle a higher volume of traffic.
","007fb76c-92e3-5bfa-4f46-d6179811290f"
"Persistence Via Hhctrl.ocx","high","","registry_set","Detects when an attacker modifies the registry value of the ""hhctrl"" to point to a custom binary","6e7e4fc7-4279-156d-6a7b-f6c593f51098"
"System Scripts Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","672c20dd-b3a3-85e6-ece5-2b1010734c41"
"New BgInfo.EXE Custom DB Path Registry Configuration","medium","","registry_set","Detects setting of a new registry database value related to BgInfo configuration. Attackers can for example set this value to save the results of the commands executed by BgInfo in order to exfiltrate information.","1bb96a94-8ab5-69b5-8366-2ab8e23877f2"
"Potential AMSI COM Server Hijacking","high","","registry_set","Detects changes to the AMSI come server registry key in order disable AMSI scanning functionalities. When AMSI attempts to starts its COM component, it will query its registered CLSID and return a non-existent COM server. This causes a load failure and prevents any scanning methods from being accessed, ultimately rendering AMSI useless","fbdc5117-68bf-93e5-9ab3-03ea072e0d36"
"Enabling COR Profiler Environment Variables","medium","","registry_set","Detects .NET Framework CLR and .NET Core CLR ""cor_enable_profiling"" and ""cor_profiler"" variables being set and configured.","4b44d428-f676-8642-3d97-3eb23a44d818"
"Potential Attachment Manager Settings Attachments Tamper","high","","registry_set","Detects tampering with attachment manager settings policies attachments (See reference for more information)","fbab75d9-3bd2-3705-4511-3e0cf5a10fe4"
"Disable Administrative Share Creation at Startup","medium","","registry_set","Administrative shares are hidden network shares created by Microsoft Windows NT operating systems that grant system administrators remote access to every disk volume on a network-connected system","2946c058-5b67-3779-9a29-6cd622926e09"
"Usage of Renamed Sysinternals Tools - RegistrySet","high","","registry_set","Detects non-sysinternals tools setting the ""accepteula"" key which normally is set on sysinternals tool execution","55790e96-f1bd-5804-59c2-7cd806625025"
"Registry Explorer Policy Modification","medium","","registry_set","Detects registry modifications that disable internal tools or functions in explorer (malware like Agent Tesla uses this technique)","239ba06d-b7b1-2237-ec7e-0f41d80ff78b"
"CrashControl CrashDump Disabled","medium","","registry_set","Detects disabling the CrashDump per registry (as used by HermeticWiper)","742762c2-287c-4b94-5f99-ae234cdd3d2c"
"Custom File Open Handler Executes PowerShell","high","","registry_set","Detects the abuse of custom file open handler, executing powershell","790cbe25-2aac-45a7-48c4-234b2a622f06"
"New TimeProviders Registered With Uncommon DLL Name","high","","registry_set","Detects processes setting a new DLL in DllName in under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProvider.
Adversaries may abuse time providers to execute DLLs when the system boots.
The Windows Time service (W32Time) enables time synchronization across and within domains.
","49f0ef07-1fcf-1ac7-54ee-8cfbb34caf06"
"Potential Provisioning Registry Key Abuse For Binary Proxy Execution - REG","high","","registry_set","Detects potential abuse of the provisioning registry key for indirect command execution through ""Provlaunch.exe"".","010beef6-dccd-7edc-c751-9236ab787158"
"UAC Notification Disabled","medium","","registry_set","Detects when an attacker tries to disable User Account Control (UAC) notification by tampering with the ""UACDisableNotify"" value.
UAC is a critical security feature in Windows that prevents unauthorized changes to the operating system. It prompts the user for permission or an administrator password before allowing actions that could affect the system's operation or change settings that affect other users.
When ""UACDisableNotify"" is set to 1, UAC prompts are suppressed.
","4936b46c-badc-cb8a-54d4-3d0b9502aa8a"
"Persistence Via Disk Cleanup Handler - Autorun","medium","","registry_set","Detects when an attacker modifies values of the Disk Cleanup Handler in the registry to achieve persistence via autorun.
The disk cleanup manager is part of the operating system.
It displays the dialog box [] The user has the option of enabling or disabling individual handlers by selecting or clearing their check box in the disk cleanup manager's UI.
Although Windows comes with a number of disk cleanup handlers, they aren't designed to handle files produced by other applications.
Instead, the disk cleanup manager is designed to be flexible and extensible by enabling any developer to implement and register their own disk cleanup handler.
Any developer can extend the available disk cleanup services by implementing and registering a disk cleanup handler.
","844e4a35-c606-6b5d-8390-52c55b9f09b5"
"Classes Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","a4cae50c-cac3-7292-659e-cf9ca88c8ba8"
"Python Function Execution Security Warning Disabled In Excel - Registry","high","","registry_set","Detects changes to the registry value ""PythonFunctionWarnings"" that would prevent any warnings or alerts from showing when Python functions are about to be executed.
Threat actors could run malicious code through the new Microsoft Excel feature that allows Python to run within the spreadsheet.
","90a9c79a-934b-1610-6e9c-d088885d656f"
"Add Port Monitor Persistence in Registry","medium","","registry_set","Adversaries may use port monitors to run an attacker supplied DLL during system boot for persistence or privilege escalation.
A port monitor can be set through the AddMonitor API call to set a DLL to be loaded at startup.
","a41b0618-1e99-30df-5b32-d040dd4ca439"
"Disable PUA Protection on Windows Defender","high","","registry_set","Detects disabling Windows Defender PUA protection","ac73de31-10d9-b1f0-6a99-7f5449fef005"
"New Application in AppCompat","informational","","registry_set","A General detection for a new application in AppCompat. This indicates an application executing for the first time on an endpoint.","bc9f1068-0677-5580-301a-add396842846"
"Outlook Macro Execution Without Warning Setting Enabled","high","","registry_set","Detects the modification of Outlook security setting to allow unprompted execution of macros.","ae407430-a207-5af9-e0ad-439b41b90e3a"
"Potential Persistence Via AppCompat RegisterAppRestart Layer","medium","","registry_set","Detects the setting of the REGISTERAPPRESTART compatibility layer on an application.
This compatibility layer allows an application to register for restart using the ""RegisterApplicationRestart"" API.
This can be potentially abused as a persistence mechanism.
","536c7bf1-8834-bffb-665e-b945d9a1894b"
"Internet Explorer DisableFirstRunCustomize Enabled","medium","","registry_set","Detects changes to the Internet Explorer ""DisableFirstRunCustomize"" value, which prevents Internet Explorer from running the first run wizard the first time a user starts the browser after installing Internet Explorer or Windows.
","6b3466e8-35d1-e288-b322-0873400febd7"
"Bypass UAC Using DelegateExecute","high","","registry_set","Bypasses User Account Control using a fileless method","6c5c8d47-3184-6c84-8736-f426d0e50839"
"Potential PowerShell Execution Policy Tampering","medium","","registry_set","Detects changes to the PowerShell execution policy in order to bypass signing requirements for script execution","989dffb4-2561-5f0b-079e-74bfe39a050a"
"Wow6432Node Windows NT CurrentVersion Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","e182da19-f29b-2327-f6f0-f71d15ff8dd5"
"Potential PendingFileRenameOperations Tampering","medium","","registry_set","Detect changes to the ""PendingFileRenameOperations"" registry key from uncommon or suspicious images locations to stage currently used files for rename or deletion after reboot.
","cddc552b-0261-3637-470e-9296ae9dd79f"
"UAC Disabled","medium","","registry_set","Detects when an attacker tries to disable User Account Control (UAC) by setting the registry value ""EnableLUA"" to 0.
","6665e720-ff59-40c7-6fc2-63c2990aef5f"
"Execution DLL of Choice Using WAB.EXE","high","","registry_set","This rule detects that the path to the DLL written in the registry is different from the default one. Launched WAB.exe tries to load the DLL from Registry.","027f1f5f-4aa7-ac2c-d8c2-084da4eaee3d"
"Potential Persistence Via Custom Protocol Handler","medium","","registry_set","Detects potential persistence activity via the registering of a new custom protocole handlers. While legitimate applications register protocole handlers often times during installation. And attacker can abuse this by setting a custom handler to be used as a persistence mechanism.","49b76666-4660-3762-b2ea-818e190edd5d"
"Blackbyte Ransomware Registry","high","","registry_set","BlackByte set three different registry values to escalate privileges and begin setting the stage for lateral movement and encryption","9651c944-f6ad-6a83-4ff8-76f682bce13e"
"Suspicious Application Allowed Through Exploit Guard","high","","registry_set","Detects applications being added to the ""allowed applications"" list of exploit guard in order to bypass controlled folder settings","f06899a3-2598-48df-bd36-4c846265e174"
"Change Winevt Channel Access Permission Via Registry","high","","registry_set","Detects tampering with the ""ChannelAccess"" registry key in order to change access to Windows event channel.","69cb5d0b-48e9-4795-d7bf-3b3051750973"
"RDP Sensitive Settings Changed","high","","registry_set","Detects tampering of RDP Terminal Service/Server sensitive settings.
Such as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections'...etc
","24cd048b-21d4-3957-a68d-e073a077e305"
"Default RDP Port Changed to Non Standard Port","high","","registry_set","Detects changes to the default RDP port.
Remote desktop is a common feature in operating systems. It allows a user to log into a remote system using an interactive session with a graphical user interface.
Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).
","b0acca11-04f4-7e88-5dd9-fc299b3716e8"
"Potential Persistence Via Shim Database In Uncommon Location","high","","registry_set","Detects the installation of a new shim database where the file is located in a non-default location","658b7369-eb29-2ab2-5a37-830bffa14b06"
"Suspicious Shim Database Patching Activity","high","","registry_set","Detects installation of new shim databases that try to patch sections of known processes for potential process injection or persistence.","98109d4e-3967-7837-46d2-9fdaface4ac0"
"Disable Windows Defender Functionalities Via Registry Keys","high","","registry_set","Detects when attackers or tools disable Windows Defender functionalities via the Windows registry","14e19d39-b1be-4903-56be-684b57d45e16"
"DHCP Callout DLL Installation","high","","registry_set","Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)","8db93e70-1420-c43f-ea06-00a6fc42449f"
"Potential Persistence Via AutodialDLL","high","","registry_set","Detects change the the ""AutodialDLL"" key which could be used as a persistence method to load custom DLL via the ""ws2_32"" library","0ea81575-bcbc-e0f8-6604-6236751cb5db"
"Displaying Hidden Files Feature Disabled","medium","","registry_set","Detects modifications to the ""Hidden"" and ""ShowSuperHidden"" explorer registry values in order to disable showing of hidden files and system files.
This technique is abused by several malware families to hide their files from normal users.
","0399e65b-992d-24c3-dc62-0b2904dda8f1"
"Scripted Diagnostics Turn Off Check Enabled - Registry","medium","","registry_set","Detects enabling TurnOffCheck which can be used to bypass defense of MSDT Follina vulnerability","5726e5a8-ce24-8360-cfb3-731d16ed8aca"
"Potential Persistence Via Netsh Helper DLL - Registry","medium","","registry_set","Detects changes to the Netsh registry key to add a new DLL value. This change might be an indication of a potential persistence attempt by adding a malicious Netsh helper
","6191bb45-e2d4-dc12-74c9-be6994d84572"
"Running Chrome VPN Extensions via the Registry 2 VPN Extension","high","","registry_set","Running Chrome VPN Extensions via the Registry install 2 vpn extension","7d02b772-7006-ba16-2b13-60db59dcfa00"
"RDP Sensitive Settings Changed to Zero","medium","","registry_set","Detects tampering of RDP Terminal Service/Server sensitive settings.
Such as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections', etc.
","debedc1b-8c7d-7257-67d1-a047bde616a4"
"Enable LM Hash Storage","high","","registry_set","Detects changes to the ""NoLMHash"" registry value in order to allow Windows to store LM Hashes.
By setting this registry value to ""0"" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.
","3649e76a-4f74-b4bf-7b6e-511fc789a746"
"New DNS ServerLevelPluginDll Installed","high","","registry_set","Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)","1c9de880-3d26-4614-f41f-a4d975e609ff"
"Macro Enabled In A Potentially Suspicious Document","high","","registry_set","Detects registry changes to Office trust records where the path is located in a potentially suspicious location","ea79a782-319f-b5bd-9293-cab2134f5c43"
"UAC Bypass via Event Viewer","high","","registry_set","Detects UAC bypass method using Windows event viewer","dee5910c-4bd3-fb48-fdbf-2d813d23aefb"
"New Root or CA or AuthRoot Certificate to Store","medium","","registry_set","Detects the addition of new root, CA or AuthRoot certificates to the Windows registry","8365c772-65e3-7f23-1606-2a2ecbd20235"
"Windows Event Log Access Tampering Via Registry","high","","registry_set","Detects changes to the Windows EventLog channel permission values. It focuses on changes to the Security Descriptor Definition Language (SDDL) string, as modifications to these values can restrict access to specific users or groups, potentially aiding in defense evasion by controlling who can view or modify a event log channel. Upon execution, the user shouldn't be able to access the event log channel via the event viewer or via utilities such as ""Get-EventLog"" or ""wevtutil"".
","af6d5933-a155-f3c7-bdb6-c2b98b515cc7"
"PowerShell Script Execution Policy Enabled","low","","registry_set","Detects the enabling of the PowerShell script execution policy. Once enabled, this policy allows scripts to be executed.","b0ac9712-6658-cdfd-92d7-8aa07fcdf31c"
"Wdigest Enable UseLogonCredential","high","","registry_set","Detects potential malicious modification of the property value of UseLogonCredential from HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to enable clear-text credentials","a2a9ea74-be61-a011-3676-5bdd9cdae0a4"
"ETW Logging Disabled For rpcrt4.dll","low","","registry_set","Detects changes to the ""ExtErrorInformation"" key in order to disable ETW logging for rpcrt4.dll","c1e78049-d5f0-8a11-39dd-10110524f89f"
"Windows Defender Service Disabled - Registry","high","","registry_set","Detects when an attacker or tool disables the  Windows Defender service (WinDefend) via the registry","7f5a4070-c4d2-ba36-ab1f-378da90ddf45"
"Winlogon Notify Key Logon Persistence","high","","registry_set","Adversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in.
Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.
","16505b6b-b744-b451-e1cc-2bf1ecc9e7df"
"Antivirus Filter Driver Disallowed On Dev Drive - Registry","high","","registry_set","Detects activity that indicates a user disabling the ability for Antivirus mini filter to inspect a ""Dev Drive"".
","068836cf-abab-c1b2-804b-c9f34e4445aa"
"Disable Microsoft Defender Firewall via Registry","medium","","registry_set","Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage","0b5acb16-e364-ec25-c330-4c4868819d39"
"Tamper With Sophos AV Registry Keys","high","","registry_set","Detects tamper attempts to sophos av functionality via registry key modification","ea43cb8f-21a1-38f6-1d50-bbcb754a91f6"
"Change User Account Associated with the FAX Service","high","","registry_set","Detect change of the user account associated with the FAX service to avoid the escalation problem.","96a90fb0-3747-35a8-d9c5-dcc7d373c57c"
"Potential Persistence Via CHM Helper DLL","high","","registry_set","Detects when an attacker modifies the registry key ""HtmlHelp Author"" to achieve persistence","7c631357-74f2-6fac-f215-06a5d2c1e99b"
"New ODBC Driver Registered","low","","registry_set","Detects the registration of a new ODBC driver.","f3d16bf4-2de2-b0e3-b8dc-37b2ca82c1cf"
"Enable Microsoft Dynamic Data Exchange","medium","","registry_set","Enable Dynamic Data Exchange protocol (DDE) in all supported editions of Microsoft Word or Excel.","40faa526-8b40-5332-0b76-013443d7e0ee"
"Potential Persistence Via Outlook LoadMacroProviderOnBoot Setting","high","","registry_set","Detects the modification of Outlook setting ""LoadMacroProviderOnBoot"" which if enabled allows the automatic loading of any configured VBA project/module","2f221db9-1924-551f-ad98-7f01d47c6c7e"
"Persistence Via New SIP Provider","medium","","registry_set","Detects when an attacker register a new SIP provider for persistence and defense evasion","15d9849f-4559-6cb8-b45b-663e3ddd9cc5"
"Hypervisor Enforced Paging Translation Disabled","high","","registry_set","Detects changes to the ""DisableHypervisorEnforcedPagingTranslation"" registry value. Where the it is set to ""1"" in order to disable the Hypervisor Enforced Paging Translation feature.
","9023759d-f7e3-127f-82b8-e618efea5217"
"Disable Windows Event Logging Via Registry","high","","registry_set","Detects tampering with the ""Enabled"" registry key in order to disable Windows logging of a Windows event channel","6d5ef37b-2d6d-8ef5-a641-57161c232686"
"Hiding User Account Via SpecialAccounts Registry Key","high","","registry_set","Detects modifications to the registry key ""HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist"" where the value is set to ""0"" in order to hide user account from being listed on the logon screen.","7ee582b4-6e4c-aa81-c848-34f91ae9302d"
"Potential CobaltStrike Service Installations - Registry","high","","registry_set","Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement.
","22ff751c-b2ff-1cd8-3e5b-3bd123b3a93e"
"Add Debugger Entry To AeDebug For Persistence","medium","","registry_set","Detects when an attacker adds a new ""Debugger"" value to the ""AeDebug"" key in order to achieve persistence which will get invoked when an application crashes","8b15d432-7c88-1622-8af2-9ab6b7134bdf"
"Potential Persistence Via DLLPathOverride","high","","registry_set","Detects when an attacker adds a new ""DLLPathOverride"" value to the ""Natural Language"" key in order to achieve persistence which will get invoked by ""SearchIndexer.exe"" process","35a986a0-86d6-9685-21af-3277c6172094"
"Outlook EnableUnsafeClientMailRules Setting Enabled - Registry","high","","registry_set","Detects an attacker trying to enable the outlook security setting ""EnableUnsafeClientMailRules"" which allows outlook to run applications or execute macros","f3359b54-f4f9-b8da-0ddb-ef16968c70e7"
"Hide Schedule Task Via Index Value Tamper","high","","registry_set","Detects when the ""index"" value of a scheduled task is modified from the registry
Which effectively hides it from any tooling such as ""schtasks /query"" (Read the referenced link for more information about the effects of this technique)
","8f22d1f4-6491-fcf7-858d-c2e73bcb8c48"
"Disable Tamper Protection on Windows Defender","medium","","registry_set","Detects disabling Windows Defender Tamper Protection","5a289d79-b7ce-fff7-d06d-771cffd14775"
"Potential Persistence Via MyComputer Registry Keys","high","","registry_set","Detects modification to the ""Default"" value of the ""MyComputer"" key and subkeys to point to a custom binary that will be launched whenever the associated action is executed (see reference section for example)","a6f5fcfd-58a6-fb93-b548-3772adf366b9"
"Potential Credential Dumping Attempt Using New NetworkProvider - REG","medium","","registry_set","Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it","6f4258c6-a880-1da0-7c68-c7e19ed0c795"
"Registry Disable System Restore","high","","registry_set","Detects the modification of the registry to disable a system restore on the computer","5cfed8dd-d873-5012-6a54-f3136099d818"
"Registry Persistence via Service in Safe Mode","high","","registry_set","Detects the modification of the registry to allow a driver or service to persist in Safe Mode.","4e584b07-47af-0e21-5779-6585650ca16e"
"Enable Local Manifest Installation With Winget","medium","","registry_set","Detects changes to the AppInstaller (winget) policy. Specifically the activation of the local manifest installation, which allows a user to install new packages via custom manifests.","e70cde78-b476-8726-75d1-073aeabb4e1d"
"Suspicious Powershell In Registry Run Keys","medium","","registry_set","Detects potential PowerShell commands or code within registry run keys","886d79ab-1307-d072-9729-18305985ebad"
"Potential AutoLogger Sessions Tampering","high","","registry_set","Detects tampering with autologger trace sessions which is a technique used by attackers to disable logging","c561b602-ffb8-a69c-10ef-7c35000d7bca"
"ETW Logging Disabled In .NET Processes - Sysmon Registry","high","","registry_set","Potential adversaries stopping ETW providers recording loaded .NET assemblies.","b845b5d0-c25c-d832-f891-58b8224599ee"
"Service Binary in Suspicious Folder","high","","registry_set","Detect the creation of a service with a service binary located in a suspicious directory","ed9f6502-6cf6-8a06-be4a-10027cabb474"
"Add Debugger Entry To Hangs Key For Persistence","high","","registry_set","Detects when an attacker adds a new ""Debugger"" value to the ""Hangs"" key in order to achieve persistence which will get invoked when an application crashes","9f96ee4d-d1e8-d5d0-e2d8-8fce145b8006"
"Windows Recall Feature Enabled - Registry","medium","","registry_set","Detects the enabling of the Windows Recall feature via registry manipulation. Windows Recall can be enabled by setting the value of ""DisableAIDataAnalysis"" to ""0"".
Adversaries may enable Windows Recall as part of post-exploitation discovery and collection activities.
This rule assumes that Recall is already explicitly disabled on the host, and subsequently enabled by the adversary.
","95ba330a-4c5b-ff06-beae-5b424cdd506f"
"ClickOnce Trust Prompt Tampering","medium","","registry_set","Detects changes to the ClickOnce trust prompt registry key in order to enable an installation from different locations such as the Internet.","6dbd4cbc-13d1-1d53-1ce4-5ad27813a654"
"Outlook Security Settings Updated - Registry","medium","","registry_set","Detects changes to the registry values related to outlook security settings","8a91b3b9-6d62-e700-63e7-73170f5b0bbc"
"Potentially Suspicious Command Executed Via Run Dialog Box - Registry","high","","registry_set","Detects execution of commands via the run dialog box on Windows by checking values of the ""RunMRU"" registry key.
This technique was seen being abused by threat actors to deceive users into pasting and executing malicious commands, often disguised as CAPTCHA verification steps.
","d22a2c0b-fd48-300f-ba44-d6881df81aab"
"Registry Hide Function from User","medium","","registry_set","Detects registry modifications that hide internal tools or functions from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)","e95c5cb7-fd08-cb3b-14e8-d0a4287e6f68"
"WinSock2 Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","e06345ae-614b-8ef6-d336-a5ed3b2dc71b"
"Potentially Suspicious ODBC Driver Registered","high","","registry_set","Detects the registration of a new ODBC driver where the driver is located in a potentially suspicious location","d61e6c48-1d69-1942-c9e5-4244f12fc88e"
"New BgInfo.EXE Custom VBScript Registry Configuration","medium","","registry_set","Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom VBScript via ""BgInfo.exe""","d3e621d9-17c0-c31c-1daf-8247438baa83"
"Potential Persistence Via LSA Extensions","high","","registry_set","Detects when an attacker modifies the ""REG_MULTI_SZ"" value named ""Extensions"" to include a custom DLL to achieve persistence via lsass.
The ""Extensions"" list contains filenames of DLLs being automatically loaded by lsass.exe. Each DLL has its InitializeLsaExtension() method called after loading.
","e249ebd9-4719-fbd6-ad42-802038c12f87"
"Potential Persistence Via Excel Add-in - Registry","high","","registry_set","Detect potential persistence via the creation of an excel add-in (XLL) file to make it run automatically when Excel is started.","5631054a-458c-6998-d637-e2d4f239ed07"
"IE Change Domain Zone","medium","","registry_set","Hides the file extension through modification of the registry","c2ff02fd-f4fe-2876-15ee-2a3d914b1a9f"
"Potential Persistence Via Scrobj.dll COM Hijacking","medium","","registry_set","Detect use of scrobj.dll as this DLL looks for the ScriptletURL key to get the location of the script to execute","7bb576ef-cc9a-5126-c758-aa8d24f0edda"
"Suspicious Service Installed","medium","","registry_set","Detects installation of NalDrv or PROCEXP152 services via registry-keys to non-system32 folders.
Both services are used in the tool Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU (https://github.com/hfiref0x/KDU)
","60953210-fd32-ddac-1118-a569c8452fd3"
"COM Object Hijacking Via Modification Of Default System CLSID Default Value","high","","registry_set","Detects potential COM object hijacking via modification of default system CLSID.","f27c3f9d-33e2-2ee6-64f7-a34b895b6379"
"Hypervisor Enforced Code Integrity Disabled","high","","registry_set","Detects changes to the HypervisorEnforcedCodeIntegrity registry key and the ""Enabled"" value being set to 0 in order to disable the Hypervisor Enforced Code Integrity feature. This allows an attacker to load unsigned and untrusted code to be run in the kernel
","3b708c9b-48bd-96e8-a680-84e819fcd228"
"Potentially Suspicious Desktop Background Change Via Registry","medium","","registry_set","Detects registry value settings that would replace the user's desktop background.
This is a common technique used by malware to change the desktop background to a ransom note or other image.
","e368acaa-a5b7-0fab-0997-8f0f1db5f99a"
"Disable Macro Runtime Scan Scope","high","","registry_set","Detects tampering with the MacroRuntimeScanScope registry key to disable runtime scanning of enabled macros","48421345-c746-0b27-ad78-2d4de6169565"
"CurrentVersion NT Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","e2bf2ad9-465c-3b63-7970-fd222ffa3708"
"Suspicious Keyboard Layout Load","medium","","registry_set","Detects the keyboard preload installation with a suspicious keyboard layout, e.g. Chinese, Iranian or Vietnamese layout load in user session on systems maintained by US staff only","59f5abe2-1a9e-45ca-21d7-c1494694129e"
"COM Hijack via Sdclt","high","","registry_set","Detects changes to 'HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute'","e4a61ceb-0bbe-6cab-3249-6c48c6ef7320"
"CurrentVersion Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","60c54878-2012-57de-2333-6d23649b0e92"
"IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols","high","","registry_set","Detects changes to Internet Explorer's (IE / Windows Internet properties) ZoneMap configuration of the ""HTTP"" and ""HTTPS"" protocols to point to the ""My Computer"" zone. This allows downloaded files from the Internet to be granted the same level of trust as files stored locally.
","b6f9cd8c-4abc-cbc8-159c-654b64f77695"
"Potential WerFault ReflectDebugger Registry Value Abuse","high","","registry_set","Detects potential WerFault ""ReflectDebugger"" registry value abuse for persistence.","effced04-aa28-c07f-9aa5-41cdded8bb61"
"Disable Privacy Settings Experience in Registry","medium","","registry_set","Detects registry modifications that disable Privacy Settings Experience","6728497e-f64d-54b9-cebf-4f2234da439a"
"Potential Persistence Via Outlook Home Page","high","","registry_set","Detects potential persistence activity via outlook home page.
An attacker can set a home page to achieve code execution and persistence by editing the WebView registry keys.
","fe333043-ad46-425d-1661-2d2a65e25177"
"Change the Fax Dll","high","","registry_set","Detect possible persistence using Fax DLL load when service restart","b04c5cc0-6866-8748-e7a7-d69ff8d55935"
"New BgInfo.EXE Custom WMI Query Registry Configuration","medium","","registry_set","Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom WMI query via ""BgInfo.exe""","c08df57b-ce0c-de04-72c1-3319cfdc5a37"
"Potential Persistence Via Outlook Today Page","high","","registry_set","Detects potential persistence activity via outlook today page.
An attacker can set a custom page to execute arbitrary code and link to it via the registry values ""URL"" and ""UserDefinedUrl"".
","0e75b3d7-d3d3-d9fa-4d60-a1254f59e47d"
"ETW Logging Disabled For SCM","low","","registry_set","Detects changes to the ""TracingDisabled"" key in order to disable ETW logging for services.exe (SCM)","2c7799c7-bf70-0033-f2e0-e2ae59d4385b"
"New RUN Key Pointing to Suspicious Folder","high","","registry_set","Detects suspicious new RUN key element pointing to an executable in a suspicious folder","2c97b46f-dbd7-bf78-71c0-86ed4a55c654"
"Potential Persistence Via GlobalFlags","high","","registry_set","Detects registry persistence technique using the GlobalFlags and SilentProcessExit keys","f8423558-5803-e6d5-bd1e-0094253e8d41"
"Potential Persistence Via Visual Studio Tools for Office","medium","","registry_set","Detects persistence via Visual Studio Tools for Office (VSTO) add-ins in Office applications.","9f3a2bef-c9ee-ce47-c8eb-d746addb05ac"
"Session Manager Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","b7f195d8-0147-8ddd-90c3-3e8e75037660"
"Potential Persistence Via Mpnotify","high","","registry_set","Detects when an attacker register a new SIP provider for persistence and defense evasion","ac9276b0-7220-7600-35b6-e24d01034d45"
"Winlogon AllowMultipleTSSessions Enable","medium","","registry_set","Detects when the 'AllowMultipleTSSessions' value is enabled.
Which allows for multiple Remote Desktop connection sessions to be opened at once.
This is often used by attacker as a way to connect to an RDP session without disconnecting the other users
","8f6d136c-f1db-74c5-9845-308043bbbaea"
"Suspicious Path In Keyboard Layout IME File Registry Value","high","","registry_set","Detects usage of Windows Input Method Editor (IME) keyboard layout feature, which allows an attacker to load a DLL into the process after sending the WM_INPUTLANGCHANGEREQUEST message.
Before doing this, the client needs to register the DLL in a special registry key that is assumed to implement this keyboard layout. This registry key should store a value named ""Ime File"" with a DLL path.
IMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean.
","595fb3ac-f3e2-e83b-fe23-f4a160b15c17"
"Driver Added To Disallowed Images In HVCI - Registry","high","","registry_set","Detects changes to the ""HVCIDisallowedImages"" registry value to potentially add a driver to the list, in order to prevent it from loading.
","43beb49f-0ccb-ecd4-f361-bcb66b1170f4"
"Bypass UAC Using SilentCleanup Task","high","","registry_set","Detects the setting of the environement variable ""windir"" to a non default value.
Attackers often abuse this variable in order to trigger a UAC bypass via the ""SilentCleanup"" task.
The SilentCleanup task located in %windir%\system32\cleanmgr.exe is an auto-elevated task that can be abused to elevate any file with administrator privileges without prompting UAC.
","b9c795cf-be1f-5020-c75e-f51c56483739"
"Disable Exploit Guard Network Protection on Windows Defender","medium","","registry_set","Detects disabling Windows Defender Exploit Guard Network Protection","a1e4b72a-2af2-0002-fb44-971730e2befa"
"Scheduled TaskCache Change by Uncommon Program","high","","registry_set","Monitor the creation of a new key under 'TaskCache' when a new scheduled task is registered by a process that is not svchost.exe, which is suspicious","8c9b2605-a3a3-f822-afa4-e8d7abdf70e3"
"Suspicious Environment Variable Has Been Registered","high","","registry_set","Detects the creation of user-specific or system-wide environment variables via the registry. Which contains suspicious commands and strings","59a208e8-d58f-efd0-e693-48703d554101"
"Potential PSFactoryBuffer COM Hijacking","high","","registry_set","Detects changes to the PSFactory COM InProcServer32 registry. This technique was used by RomCom to create persistence storing a malicious DLL.","d3c2b07c-075b-b06e-926a-3c74236f7b42"
"VBScript Payload Stored in Registry","high","","registry_set","Detects VBScript content stored into registry keys as seen being used by UNC2452 group","edcac99a-55ef-aa9c-92a3-d9c9d7e1e46e"
"UAC Bypass via Sdclt","high","","registry_set","Detects the pattern of UAC Bypass using registry key manipulation of sdclt.exe (e.g. UACMe 53)","4e8bf251-fcde-0996-45f9-62335b5e5d8b"
"PowerShell Logging Disabled Via Registry Key Tampering","high","","registry_set","Detects changes to the registry for the currently logged-in user. In order to disable PowerShell module logging, script block logging or transcription and script execution logging","4320bfce-fa0f-05d4-9e60-55d3f27794d8"
"PowerShell as a Service in Registry","high","","registry_set","Detects that a powershell code is written to the registry as a service.","891340b3-d63e-73d0-742f-b481f911074c"
"Potential Persistence Using DebugPath","medium","","registry_set","Detects potential persistence using Appx DebugPath","7e39f9c6-fca2-d20b-c975-48062f7ac3e0"
"New File Association Using Exefile","high","","registry_set","Detects the abuse of the exefile handler in new file association. Used for bypass of security products.","b0fb77bd-c468-c8dd-1a84-96bf79d003a7"
"Potential Persistence Via Event Viewer Events.asp","medium","","registry_set","Detects potential registry persistence technique using the Event Viewer ""Events.asp"" technique","406b79d8-988c-0ef9-5702-7aa379ce70e2"
"CurrentControlSet Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","94a78414-5302-4e88-7c59-1d5d0de11a5f"
"ScreenSaver Registry Key Set","medium","","registry_set","Detects registry key established after masqueraded .scr file execution using Rundll32 through desk.cpl","a6cf9f0e-8857-2bf6-bf8f-ebe833b09125"
"Winget Admin Settings Modification","low","","registry_set","Detects changes to the AppInstaller (winget) admin settings. Such as enabling local manifest installations or disabling installer hash checks","4d50dc2c-f2bf-a039-820d-65c415ab31ee"
"New Netsh Helper DLL Registered From A Suspicious Location","high","","registry_set","Detects changes to the Netsh registry key to add a new DLL value that is located on a suspicious location. This change might be an indication of a potential persistence attempt by adding a malicious Netsh helper
","57fba93d-7938-c3fd-109b-6d1fb6037e2c"
"Modification of IE Registry Settings","low","","registry_set","Detects modification of the registry settings used for Internet Explorer and other Windows components that use these settings. An attacker can abuse this registry key to add a domain to the trusted sites Zone or insert javascript for persistence","0fbb75e3-4f11-c091-e62d-0159f224a0af"
"Lsass Full Dump Request Via DumpType Registry Settings","high","","registry_set","Detects the setting of the ""DumpType"" registry value to ""2"" which stands for a ""Full Dump"". Technique such as LSASS Shtinkering requires this value to be ""2"" in order to dump LSASS.","717a326e-aa46-b2cd-4db7-1e0be4003fb9"
"Add DisallowRun Execution to Registry","medium","","registry_set","Detect set DisallowRun to 1 to prevent user running specific computer program","c1daf9d0-4faf-5cf7-ee69-08dbaf545e0b"
"Periodic Backup For System Registry Hives Enabled","medium","","registry_set","Detects the enabling of the ""EnablePeriodicBackup"" registry value. Once enabled, The OS will backup System registry hives on restarts to the ""C:\Windows\System32\config\RegBack"" folder. Windows creates a ""RegIdleBackup"" task to manage subsequent backups.
Registry backup was a default behavior on Windows and was disabled as of ""Windows 10, version 1803"".
","08ad005b-9676-0872-2751-56c87d6c1385"
"Disable Windows Security Center Notifications","medium","","registry_set","Detect set UseActionCenterExperience to 0 to disable the Windows security center notification","75c0a3fc-9821-e555-9c15-d7829e36ed2e"
"RestrictedAdminMode Registry Value Tampering","high","","registry_set","Detects changes to the ""DisableRestrictedAdmin"" registry value in order to disable or enable RestrictedAdmin mode.
RestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.
This prevents your credentials from being harvested during the initial connection process if the remote server has been compromise
","5b59bbe4-226f-1215-bff7-8c5a79430936"
"Directory Service Restore Mode(DSRM) Registry Value Tampering","high","","registry_set","Detects changes to ""DsrmAdminLogonBehavior"" registry value.
During a Domain Controller (DC) promotion, administrators create a Directory Services Restore Mode (DSRM) local administrator account with a password that rarely changes. The DSRM account is an Administrator account that logs in with the DSRM mode when the server is booting up to restore AD backups or recover the server from a failure.
Attackers could abuse DSRM account to maintain their persistence and access to the organization's Active Directory.
If the ""DsrmAdminLogonBehavior"" value is set to ""0"", the administrator account can only be used if the DC starts in DSRM.
If the ""DsrmAdminLogonBehavior"" value is set to ""1"", the administrator account can only be used if the local AD DS service is stopped.
If the ""DsrmAdminLogonBehavior"" value is set to ""2"", the administrator account can always be used.
","04c29127-1ef3-f2f5-5b26-645eb052c42d"
"Old TLS1.0/TLS1.1 Protocol Version Enabled","medium","","registry_set","Detects applications or users re-enabling old TLS versions by setting the ""Enabled"" value to ""1"" for the ""Protocols"" registry key.","f1d2e557-5935-d1b7-cc8a-48563f722f9c"
"Potential Persistence Via TypedPaths","high","","registry_set","Detects modification addition to the 'TypedPaths' key in the user or admin registry from a non standard application. Which might indicate persistence attempt","e0f39f6d-5bc7-83ca-9a1f-4e67316af212"
"Blue Mockingbird - Registry","high","","registry_set","Attempts to detect system changes made by Blue Mockingbird","5e4e8480-72ed-5e37-7cfe-93d7cfd37974"
"Register New IFiltre For Persistence","medium","","registry_set","Detects when an attacker registers a new IFilter for an extension. Microsoft Windows Search uses filters to extract the content of items for inclusion in a full-text index.
You can extend Windows Search to index new or proprietary file types by writing filters to extract the content, and property handlers to extract the properties of files.
","3728b695-0511-c1dd-81df-030fda358222"
"UAC Secure Desktop Prompt Disabled","medium","","registry_set","Detects when an attacker tries to change User Account Control (UAC) elevation request destination via the ""PromptOnSecureDesktop"" value.
The ""PromptOnSecureDesktop"" setting specifically determines whether UAC prompts are displayed on the secure desktop. The secure desktop is a separate desktop environment that's isolated from other processes running on the system. It's designed to prevent malicious software from intercepting or tampering with UAC prompts.
When ""PromptOnSecureDesktop"" is set to 0, UAC prompts are displayed on the user's current desktop instead of the secure desktop. This reduces the level of security because it potentially exposes the prompts to manipulation by malicious software.
","4475b3bd-9b24-b189-1118-871c5fe3fe17"
"Bypass UAC Using Event Viewer","high","","registry_set","Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification","6b966f00-7138-0a2d-0f30-029d3bed3524"
"Suspicious Printer Driver Empty Manufacturer","high","","registry_set","Detects a suspicious printer driver installation with an empty Manufacturer value","21c41e20-e274-bd0e-e22d-072fc5e0962d"
"Office Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","cb43927e-70c4-47e4-6121-af9fb00a6a77"
"Uncommon Extension In Keyboard Layout IME File Registry Value","high","","registry_set","Detects usage of Windows Input Method Editor (IME) keyboard layout feature, which allows an attacker to load a DLL into the process after sending the WM_INPUTLANGCHANGEREQUEST message.
Before doing this, the client needs to register the DLL in a special registry key that is assumed to implement this keyboard layout. This registry key should store a value named ""Ime File"" with a DLL path.
IMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean.
","dacb1ee4-05cc-995a-adee-964a19774888"
"UAC Bypass Abusing Winsat Path Parsing - Registry","high","","registry_set","Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)","c5041759-c026-94ae-a6d4-6e6bfbfa3d0c"
"Windows Defender Exclusions Added - Registry","medium","","registry_set","Detects the Setting of Windows Defender Exclusions","c86baf10-abab-0f8f-88a2-e51640a26b5c"
"Common Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","092b0638-9aaa-3ecd-820c-9e873b647497"
"Sysmon Driver Altitude Change","high","","registry_set","Detects changes in Sysmon driver altitude value.
If the Sysmon driver is configured to load at an altitude of another registered service, it will fail to load at boot.
","42144fcb-9adc-b4dc-e024-4bdf3311c757"
"NET NGenAssemblyUsageLog Registry Key Tamper","high","","registry_set","Detects changes to the NGenAssemblyUsageLog registry key.
.NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog CLR configuration knob in the Registry or by configuring an environment variable (as described in the next section).
By simplify specifying an arbitrary value (e.g. fake output location or junk data) for the expected value, a Usage Log file for the .NET execution context will not be created.
","9f6b7775-4d86-0f98-45b5-2cfac0e410e7"
"Internet Explorer Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","4c6aafd5-b32d-12d2-ecc7-0138f21e65e8"
"Potential Ransomware Activity Using LegalNotice Message","high","","registry_set","Detect changes to the ""LegalNoticeCaption"" or ""LegalNoticeText"" registry values where the message set contains keywords often used in ransomware ransom messages","dcbfe53c-e933-cfb7-d9ce-8f03726f9637"
"Allow RDP Remote Assistance Feature","medium","","registry_set","Detect enable rdp feature to allow specific user to rdp connect on the targeted machine","8a77badb-a001-0da9-9213-ba6efbd70a95"
"Disable Windows Firewall by Registry","medium","","registry_set","Detect set EnableFirewall to 0 to disable the Windows firewall","d84ec9a7-296b-e4d1-d97c-daa11eee226b"
"Potential Registry Persistence Attempt Via Windows Telemetry","high","","registry_set","Detects potential persistence behavior using the windows telemetry registry key.
Windows telemetry makes use of the binary CompatTelRunner.exe to run a variety of commands and perform the actual telemetry collections.
This binary was created to be easily extensible, and to that end, it relies on the registry to instruct on which commands to run.
The problem is, it will run any arbitrary command without restriction of location or type.
","e4a5e8fc-9e86-a5c9-b9f4-41288262dd40"
"Potential Persistence Via Shim Database Modification","medium","","registry_set","Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.
The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time
","bc03960b-bb9d-b48c-e6cd-73b6e8d17d74"
"Office Macros Warning Disabled","high","","registry_set","Detects registry changes to Microsoft Office ""VBAWarning"" to a value of ""1"" which enables the execution of all macros, whether signed or unsigned.","25d40765-aae0-421b-3a7e-00cff494680f"
"Potential Attachment Manager Settings Associations Tamper","high","","registry_set","Detects tampering with attachment manager settings policies associations to lower the default file type risks (See reference for more information)","8d3cb1da-3cc0-2448-a467-9b5a2bd3c4c0"
"Potential Signing Bypass Via Windows Developer Features - Registry","high","","registry_set","Detects when the enablement of developer features such as ""Developer Mode"" or ""Application Sideloading"". Which allows the user to install untrusted packages.","eea69d1c-b62d-d58f-4ee3-82f9053a20ea"
"Activate Suppression of Windows Security Center Notifications","medium","","registry_set","Detect set Notification_Suppress to 1 to disable the Windows security center notification","b0b20369-6a44-df4d-5671-a85b5eb960dd"
"Wow6432Node CurrentVersion Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","e262d6ab-07ec-712b-78c5-696f002dc7f0"
"Potential SentinelOne Shell Context Menu Scan Command Tampering","medium","","registry_set","Detects potentially suspicious changes to the SentinelOne context menu scan command by a process other than SentinelOne.","8785a0bb-8ec2-c019-4196-7d4d2fb47bd7"
"Wow6432Node Classes Autorun Keys Modification","medium","","registry_set","Detects modification of autostart extensibility point (ASEP) in registry.","50b1dd22-8438-5c33-c5f2-00496987423b"
"Potential EventLog File Location Tampering","high","","registry_set","Detects tampering with EventLog service ""file"" key. In order to change the default location of an Evtx file. This technique is used to tamper with log collection and alerting","dfa1b70c-248b-d9ac-0b47-fbce1fe26a10"
"Lolbas OneDriveStandaloneUpdater.exe Proxy Download","high","","registry_set","Detects setting a custom URL for OneDriveStandaloneUpdater.exe to download a file from the Internet without executing any
anomalous executables with suspicious arguments. The downloaded file will be in C:\Users\redacted\AppData\Local\Microsoft\OneDrive\StandaloneUpdaterreSignInSettingsConfig.json
","5c6e4e04-c3a5-0b21-f966-97441d749d47"
"DNS-over-HTTPS Enabled by Registry","medium","","registry_set","Detects when a user enables DNS-over-HTTPS.
This can be used to hide internet activity or be used to hide the process of exfiltrating data.
With this enabled organization will lose visibility into data such as query type, response and originating IP that are used to determine bad actors.
","22adc86b-0198-3dfd-0cc2-f686d342be66"
"Disabled Windows Defender Eventlog","high","","registry_set","Detects the disabling of the Windows Defender eventlog as seen in relation to Lockbit 3.0 infections","7b78e30a-de66-08da-7417-5b735a074ba2"
"Uncommon Microsoft Office Trusted Location Added","high","","registry_set","Detects changes to registry keys related to ""Trusted Location"" of Microsoft Office where the path is set to something uncommon. Attackers might add additional trusted locations to avoid macro security restrictions.","c22014de-7963-a2c6-ead7-9fded54d54f0"
"Potential Qakbot Registry Activity","high","","registry_event","Detects a registry key used by IceID in a campaign that distributes malicious OneNote files","52da4b83-76bb-1c03-3d3d-d2767a05c186"
"Esentutl Volume Shadow Copy Service Keys","high","","registry_event","Detects the volume shadow copy service initialization and processing via esentutl. Registry keys such as HKLM\\System\\CurrentControlSet\\Services\\VSS\\Diag\\VolSnap\\Volume are captured.","f6fed793-a359-2cae-0383-6ec6a9aee77b"
"DLL Load via LSASS","high","","registry_event","Detects a method to load DLL via LSASS process using an undocumented Registry key","f90321bd-3a7e-2f0a-220f-49096e6b8ef5"
"Creation of a Local Hidden User Account by Registry","high","","registry_event","Sysmon registry detection of a local hidden user account.","447c311d-5d73-52c3-d10c-a1205258cf04"
"PrinterNightmare Mimikatz Driver Name","critical","","registry_event","Detects static QMS 810 and mimikatz driver name used by Mimikatz as exploited in CVE-2021-1675 and CVE-2021-34527","33feb9a9-afd4-3403-46c9-13a7b4a62b80"
"Disable Security Events Logging Adding Reg Key MiniNt","high","","registry_event","Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.","36ef53bd-ce38-b8b6-b163-c7ff42107ecb"
"Windows Registry Trust Record Modification","medium","","registry_event","Alerts on trust record modification within the registry, indicating usage of macros","b2a0af70-a308-0185-6128-c2e37db1ebf2"
"Path To Screensaver Binary Modified","medium","","registry_event","Detects value modification of registry key containing path to binary used as screensaver.","f5a1f729-ff8c-577e-2d33-a209e00bf7f3"
"Registry Entries For Azorult Malware","critical","","registry_event","Detects the presence of a registry key created during Azorult execution","46595663-e666-c413-ccf4-028a618ca712"
"CMSTP Execution Registry Event","high","","registry_event","Detects various indicators of Microsoft Connection Manager Profile Installer execution","8538e021-b60d-b297-e8e1-e9020ae98f78"
"Suspicious Run Key from Download","high","","registry_event","Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories","f81b1344-1639-27dc-c1e1-577c4e6c8e19"
"WINEKEY Registry Modification","high","","registry_event","Detects potential malicious modification of run keys by winekey or team9 backdoor","c28049f8-7766-14aa-616f-a8628ee679bd"
"New PortProxy Registry Entry Added","medium","","registry_event","Detects the modification of the PortProxy registry key which is used for port forwarding.","930cd1b8-c592-1982-65c9-cf7fecc0adf7"
"Potential Credential Dumping Via LSASS SilentProcessExit Technique","critical","","registry_event","Detects changes to the Registry in which a monitor program gets registered to dump the memory of the lsass.exe process","c42f7ed2-10ea-21b4-bcc5-6978cbf4ca0d"
"Registry Persistence Mechanisms in Recycle Bin","high","","registry_event","Detects persistence registry keys for Recycle Bin","1617c214-9562-4819-58cd-ffa7929cf167"
"UAC Bypass Via Wsreset","high","","registry_event","Unfixed method for UAC bypass from Windows 10. WSReset.exe file associated with the Windows Store. It will run a binary file contained in a low-privilege registry.","95ca0984-3622-ee0b-d0b7-4bf861f58030"
"HybridConnectionManager Service Installation - Registry","high","","registry_event","Detects the installation of the Azure Hybrid Connection Manager service to allow remote code execution from Azure function.","0a77c311-af5b-b0e4-4d1d-e87ede81b2c7"
"Run Once Task Configuration in Registry","medium","","registry_event","Rule to detect the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup","f00c4059-0241-7fee-4186-e8d0b5741cba"
"Pandemic Registry Key","critical","","registry_event","Detects Pandemic Windows Implant","a36fab91-8874-79c8-32cb-b2a0117d5a0b"
"New DLL Added to AppCertDlls Registry Key","medium","","registry_event","Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation
by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.
","0af15a7d-56b4-6742-50d9-011df5f8449e"
"Wdigest CredGuard Registry Modification","high","","registry_event","Detects potential malicious modification of the property value of IsCredGuardEnabled from
HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to disable Cred Guard on a system.
This is usually used with UseLogonCredential to manipulate the caching credentials.
","60c241e3-567b-86bb-ae42-0e0b650b51ec"
"Shell Open Registry Keys Manipulation","high","","registry_event","Detects the shell open key manipulation (exefile and ms-settings) used for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe, slui.exe via registry keys (e.g. UACMe 33 or 62)","b1bd0320-da55-2715-927f-f70a3cb846fa"
"RedMimicry Winnti Playbook Registry Manipulation","high","","registry_event","Detects actions caused by the RedMimicry Winnti playbook","a250ceb5-fda2-758b-e33b-594cb197d8ca"
"Windows Credential Editor Registry","critical","","registry_event","Detects the use of Windows Credential Editor (WCE)","092a900e-c6b2-7064-f7b5-699f1b3be49d"
"Atbroker Registry Change","medium","","registry_event","Detects creation/modification of Assistive Technology applications and persistence with usage of 'at'","5c5490c6-68eb-786c-e6b0-12374dce833f"
"Office Application Startup - Office Test","medium","","registry_event","Detects the addition of office test registry that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started","3b19eda3-3430-8cdc-686c-e0d94a32427d"
"Narrator's Feedback-Hub Persistence","high","","registry_event","Detects abusing Windows 10 Narrator's Feedback-Hub","e45e543e-8d13-302c-2825-398896bd0bf8"
"Sticky Key Like Backdoor Usage - Registry","critical","","registry_event","Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen","255a8d48-2f51-b8e1-ed5c-4063555a7569"
"Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback","medium","","registry_set","Detects enabling of the ""AllowAnonymousCallback"" registry value, which allows a remote connection between computers that do not have a trust relationship.","153b0ce0-9f0b-f10f-7d6e-3a23dea83494"
"Security Support Provider (SSP) Added to LSA Configuration","high","","registry_event","Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.
","a2b70475-be0a-993d-b01f-8ecf4bbd7576"
"New DLL Added to AppInit_DLLs Registry Key","medium","","registry_event","DLLs that are specified in the AppInit_DLLs value in the Registry key HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows are loaded by user32.dll into every process that loads user32.dll","5e3a86ef-f4fb-dd10-9bc7-e7c2d0a15e70"
"Suspicious Camera and Microphone Access","high","","registry_event","Detects Processes accessing the camera and microphone from suspicious folder","139f52db-35af-c5f8-bbf8-22a2094dfea6"
"NetNTLM Downgrade Attack - Registry","high","","registry_event","Detects NetNTLM downgrade attack","3387665f-9c44-56db-5cb9-a35e48689376"
"Potential NetWire RAT Activity - Registry","high","","registry_add","Detects registry keys related to NetWire RAT","61bb2824-c37f-f432-0767-9a80d45583aa"
"PUA - Sysinternals Tools Execution - Registry","medium","","registry_add","Detects the execution of some potentially unwanted tools such as PsExec, Procdump, etc. (part of the Sysinternals suite) via the creation of the ""accepteula"" registry key.","cab7e60f-55aa-b72e-1943-4d3980028a43"
"PUA - Sysinternal Tool Execution - Registry","low","","registry_add","Detects the execution of a Sysinternals Tool via the creation of the ""accepteula"" registry key","08427b1c-3ceb-9aa5-7d8d-84dfc1531fb8"
"Suspicious Execution Of Renamed Sysinternals Tools - Registry","high","","registry_add","Detects the creation of the ""accepteula"" key related to the Sysinternals tools being created from executables with the wrong name (e.g. a renamed Sysinternals tool)","6a724c01-e3a5-3f08-0a26-a25aab47a2d1"
"Potential Persistence Via New AMSI Providers - Registry","high","","registry_add","Detects when an attacker registers a new AMSI provider in order to achieve persistence","d8884952-23ce-8a65-d998-cb775a119c95"
"Potential Persistence Via Logon Scripts - Registry","medium","","registry_add","Detects creation of ""UserInitMprLogonScript"" registry value which can be used as a persistence method by malicious actors","c6a4d8a3-8e7d-30b4-a6f0-aee8a87463bf"
"Potential COM Object Hijacking Via TreatAs Subkey - Registry","medium","","registry_add","Detects COM object hijacking via TreatAs subkey","6b4b0ded-e40c-4d49-68f0-b78339d9587e"
"Potential Persistence Via Disk Cleanup Handler - Registry","medium","","registry_add","Detects when an attacker modifies values of the Disk Cleanup Handler in the registry to achieve persistence.
The disk cleanup manager is part of the operating system. It displays the dialog box []
The user has the option of enabling or disabling individual handlers by selecting or clearing their check box in the disk cleanup manager's UI.
Although Windows comes with a number of disk cleanup handlers, they aren't designed to handle files produced by other applications.
Instead, the disk cleanup manager is designed to be flexible and extensible by enabling any developer to implement and register their own disk cleanup handler.
Any developer can extend the available disk cleanup services by implementing and registering a disk cleanup handler.
","e3adf6e1-6fbf-d4fe-ee8f-a000db6d64c8"
"Autorun Keys Modification","medium","","registry_event","Detects modification of autostart extensibility point (ASEP) in registry.","b8939982-1774-1f45-f838-7bf9ac9be3c2"
"Windows Defender Exclusion Deleted","medium","security","","Detects when a Windows Defender exclusion has been deleted. This could indicate an attacker trying to delete their tracks by removing the added exclusions
","7bd85790-c82a-56af-7127-f257e5ef6c6f"
"Office Security Settings Changed","high","","registry_set","Detects registry changes to Office macro settings. The TrustRecords contain information on executed macro-enabled documents. (see references)","ea79a782-319f-b5bd-9293-cab2134f5c43"
"Disable Microsoft Office Security Features","high","","registry_set","Disable Microsoft Office Security Features by registry","d226853e-3dbf-ce71-60c1-5458858abbbc"
"User Account Hidden By Registry","high","","registry_set","Detect modification for a specific user to prevent that user from being listed on the logon screen","1b78376c-c1d2-a830-93b1-5dee98965490"
"Adwind RAT / JRAT - Registry","high","","registry_set","Detects javaw.exe in AppData folder as used by Adwind / JRAT","6c44673b-8c80-9ce9-718d-46f34b17ffcc"
"Potential Persistence Via COM Hijacking From Suspicious Locations","high","","registry_set","Detects potential COM object hijacking where the ""Server"" (In/Out) is pointing to a suspicious or unusual location.","79389718-9e14-e5e9-1cc7-2c027078bf22"
"Sysinternals SDelete Registry Keys","medium","","registry_add","A General detection to trigger for the creation or modification of .*\Software\Sysinternals\SDelete registry keys. Indicators of the use of Sysinternals SDelete tool.","a08aa16a-ae4f-9e1e-7a2d-3ad02f750ff0"
"SilentProcessExit Monitor Registration","high","","registry_set","Detects changes to the Registry in which a monitor program gets registered to monitor the exit of another process","9482abf0-5008-838f-0912-a85e0c7792a7"
"Abusing Windows Telemetry For Persistence - Registry","high","","registry_set","Windows telemetry makes use of the binary CompatTelRunner.exe to run a variety of commands and perform the actual telemetry collections.
This binary was created to be easily extensible, and to that end, it relies on the registry to instruct on which commands to run.
The problem is, it will run any arbitrary command without restriction of location or type.
","7c470022-ced9-05c4-b9fc-5aff8e5f4dce"
"Potential Persistence Via COM Search Order Hijacking","medium","","registry_set","Detects potential COM object hijacking leveraging the COM Search Order","20f7b927-82bf-9d38-6573-0ed63831fdc5"
"Service Binary in Uncommon Folder","medium","","registry_set","Detect the creation of a service with a service binary located in a uncommon directory","f9252ab9-0f85-c10d-fd51-576b83182926"
"Registry Set With Crypto-Classes From The ""Cryptography"" PowerShell Namespace","medium","","registry_set","Detects the setting of a registry inside the ""\Shell\Open\Command"" value with PowerShell classes from the ""System.Security.Cryptography"" namespace.
The PowerShell namespace ""System.Security.Cryptography"" provides classes for on-the-fly encryption and decryption.
These can be used for example in decrypting malicious payload for defense evasion.
","aa71f12d-30c7-985b-9784-b26e948f0f5d"
"Service Binary in User Controlled Folder","medium","","registry_set","Detects the setting of the ""ImagePath"" value of a service registry key to a path controlled by a non-administrator user such as ""\AppData\"" or ""\ProgramData\"".
Attackers often use such directories for staging purposes.
This rule might also trigger on badly written software, where if an attacker controls an auto starting service, they might achieve persistence or privilege escalation.
Note that while ProgramData is a user controlled folder, software might apply strict ACLs which makes them only accessible to admin users. Remove such folders via filters if you experience a lot of noise.
","f9252ab9-0f85-c10d-fd51-576b83182926"
"Shell Context Menu Command Tampering","low","","registry_set","Detects changes to shell context menu commands. Use this rule to hunt for potential anomalies and suspicious shell commands.","1ce6a719-c7b0-11e7-2b9f-37facf10d1d4"
"Command Executed Via Run Dialog Box - Registry","low","","registry_set","Detects execution of commands via the run dialog box on Windows by checking values of the ""RunMRU"" registry key.
This technique was seen being abused by threat actors to deceive users into pasting and executing malicious commands, often disguised as CAPTCHA verification steps.
","c4b8f7e9-f874-4e2b-4320-dd805a1bbf21"
"Microsoft Office Trusted Location Updated","medium","","registry_set","Detects changes to the registry keys related to ""Trusted Location"" of Microsoft Office. Attackers might add additional trusted locations to avoid macro security restrictions.","d4bfa0d5-6f83-cac0-c838-2d05d677611f"
"Scheduled Task Created - Registry","low","","registry_event","Detects the creation of a scheduled task via Registry keys.","c6cda933-68be-134e-fe2e-71ee945f0f69"
"NetNTLM Downgrade Attack","high","security","","Detects NetNTLM downgrade attack","68f0908b-8434-9199-f0a3-350c27ac97c4"
"ETW Logging Disabled In .NET Processes - Registry","high","security","","Potential adversaries stopping ETW providers recording loaded .NET assemblies.","107a403c-5a05-2568-95a7-a7329d714440"
"Windows Defender Exclusion List Modified","medium","security","","Detects modifications to the Windows Defender exclusion registry key. This could indicate a potentially suspicious or even malicious activity by an attacker trying to add a new exclusion in order to bypass security.
","8948f034-2d45-47bc-c04b-14ab124247f3"
"OilRig APT Registry Persistence","critical","","registry_event","Detects OilRig registry persistence as reported by Nyotron in their March 2018 report","e3b2e8dd-18aa-f9bc-9af7-bc31d7717574"
"OceanLotus Registry Activity","critical","","registry_event","Detects registry keys created in OceanLotus (also known as APT32) attacks","91264309-c919-28fd-5fff-f994208d1f34"
"FlowCloud Registry Markers","critical","","registry_event","Detects FlowCloud malware registry markers from threat group TA410.
The malware stores its configuration in the registry alongside drivers utilized by the malware's keylogger components.
","0b8e16f0-ba71-e4bd-3716-69afe0091614"
"CVE-2020-1048 Exploitation Attempt - Suspicious New Printer Ports - Registry","high","","registry_set","Detects changes to the ""Ports"" registry key with data that includes a Windows path or a file with a suspicious extension.
This could be an attempt to exploit CVE-2020-1048 - a Windows Print Spooler elevation of privilege vulnerability.
","630f16a8-0e53-642e-ff10-1e8fdeb631b8"
"Leviathan Registry Key Activity","critical","","registry_event","Detects registry key used by Leviathan APT in Malaysian focused campaign","09b9f622-28c3-d403-0447-f3858c57995e"
"Potential Ursnif Malware Activity - Registry","high","","registry_add","Detects registry keys related to Ursnif malware.","4adab006-3d6b-cf15-fdcc-f081f50e87f5"
"Potential Raspberry Robin Registry Set Internet Settings ZoneMap","low","","registry_set","Detects registry modifications related to the proxy configuration of the system, potentially associated with the Raspberry Robin malware, as seen in campaigns running in Q1 2024.
Raspberry Robin may alter proxy settings to circumvent security measures, ensuring unhindered connection with Command and Control servers for maintaining control over compromised systems if there are any proxy settings that are blocking connections.
","e46b4e96-6396-bb54-0d11-e1aada87c21e"
"Kapeka Backdoor Configuration Persistence","medium","","registry_set","Detects registry set activity of a value called ""Seed"" stored in the ""\Cryptography\Providers\"" registry key.
The Kapeka backdoor leverages this location to register a new SIP provider for backdoor configuration persistence.
","48e70678-2188-d6d9-11d7-598823558254"
"Kapeka Backdoor Autorun Persistence","high","","registry_set","Detects the setting of a new value in the Autorun key that is used by the Kapeka backdoor for persistence.","4f676138-05ac-facf-8305-99c355044751"
"Potential KamiKakaBot Activity - Winlogon Shell Persistence","high","","registry_set","Detects changes to the ""Winlogon"" registry key where a process will set the value of the ""Shell"" to a value that was observed being used by KamiKakaBot samples in order to achieve persistence.
","396c509f-60dd-659f-6cd4-7e6e45322d5e"
"Forest Blizzard APT - Custom Protocol Handler Creation","high","","registry_set","Detects the setting of a custom protocol handler with the name ""rogue"".
Seen being created by Forest Blizzard APT as reported by MSFT.
","b08e9928-878e-3e97-524a-036710d6f3f9"
"Forest Blizzard APT - Custom Protocol Handler DLL Registry Set","high","","registry_set","Detects the setting of the DLL that handles the custom protocol handler.
Seen being created by Forest Blizzard APT as reported by MSFT.
","30840c08-9ef9-b60c-581d-256b0a2f8041"
"Potential COLDSTEEL RAT Windows User Creation","high","","registry_set","Detects creation of a new user profile with a specific username, seen being used by some variants of the COLDSTEEL RAT.","d1c9a56f-847c-149d-8e33-f2f0cc9d0780"
"SNAKE Malware Covert Store Registry Key","high","","registry_event","Detects any registry event that targets the key 'SECURITY\Policy\Secrets\n' which is a key related to SNAKE malware as described by CISA","58f3d2fb-ee2d-19e8-3792-abdf0eca4067"
"Potential Encrypted Registry Blob Related To SNAKE Malware","medium","","registry_set","Detects the creation of a registry value in the "".wav\OpenWithProgIds"" key with an uncommon name. This could be related to SNAKE Malware as reported by CISA","2d1ec565-2a6e-eb8c-5e3e-454aa8a32614"
"Outlook Task/Note Reminder Received","low","","registry_set","Detects changes to the registry values related to outlook that indicates that a reminder was triggered for a Note or Task item. This could be a sign of exploitation of CVE-2023-23397. Further investigation is required to determine the success of an exploitation.","d2c33d76-7b09-c3b4-a954-ffd2e0da3cc8"
"Diamond Sleet APT Scheduled Task Creation - Registry","high","","registry_event","Detects registry event related to the creation of a scheduled task used by Diamond Sleet APT during exploitation of Team City CVE-2023-42793 vulnerability
","0a08328e-c93e-0397-cb8e-61d93af17c09"
"Small Sieve Malware Registry Persistence","high","","registry_set","Detects registry value with specific intentional typo and strings seen used by the Small Sieve malware","8376c984-b3da-370c-ff20-3c9c0dc9f18e"
"CVE-2021-31979 CVE-2021-33771 Exploits","critical","","registry_set","Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum","a4072638-9c3a-3307-e4f9-458edbb60efb"
"Suspicious Set Value of MSDT in Registry (CVE-2022-30190)","medium","","registry_set","Detects set value ms-msdt MSProtocol URI scheme in Registry that could be an attempt to exploit CVE-2022-30190.","9754f622-65d5-8c9b-7762-f074e2d502ed"
"Password Policy Enumerated","medium","security","","Detects when the password policy is enumerated.","9bcf333e-fc4c-5912-eeba-8a0cefe21be4"
"Reconnaissance Activity","high","security","","Detects activity as ""net user administrator /domain"" and ""net group domain admins /domain""","5ac4b7f8-9412-f919-220c-aa8a1867b1ef"
"AD Privileged Users or Groups Reconnaissance","high","security","","Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs","93c95eee-748a-e1db-18a5-f40035167086"
"Enabled User Right in AD to Control User Objects","high","security","","Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.","eaafcd7e-3303-38d1-9cff-fcfbae177f4d"
"HackTool - NoFilter Execution","high","security","","Detects execution of NoFilter, a tool for abusing the Windows Filtering Platform for privilege escalation via hardcoded policy name indicators
","22d4af9f-97d9-4827-7209-c451ff7f43c6"
"HackTool - EDRSilencer Execution - Filter Added","high","security","","Detects execution of EDRSilencer, a tool that abuses the Windows Filtering Platform (WFP) to block the outbound traffic of running EDR agents based on specific hardcoded filter names.
","4d56e133-40b5-5b28-07b5-bab0913fc338"
"HackTool - NoFilter Execution","high","security","","Detects execution of NoFilter, a tool for abusing the Windows Filtering Platform for privilege escalation via hardcoded policy name indicators
","22d4af9f-97d9-4827-7209-c451ff7f43c6"
"HackTool - EDRSilencer Execution - Filter Added","high","security","","Detects execution of EDRSilencer, a tool that abuses the Windows Filtering Platform (WFP) to block the outbound traffic of running EDR agents based on specific hardcoded filter names.
","4d56e133-40b5-5b28-07b5-bab0913fc338"
"Possible Hidden Service Created","medium","security","","User requested to modify the Dynamic Access Control (DAC) permissions of a service, possibly to hide it from view.","15db3cc7-30bd-47a0-bd75-66208ce8e3fe"
"Lateral Movement Indicator ConDrv","low","security","","This event was observed on the target host during lateral movement. The process name within the event contains the process spawned post compromise. Account Name within the event contains the compromised user account name. This event should to be correlated with 4624 and 4688 for further intrusion context.","6683ccd7-da7a-b988-1683-7f7a1bf72bf6"
"SCM Database Privileged Operation","medium","security","","Detects non-system users performing privileged operation os the SCM database","ec9c7ea2-54d7-3a55-caa8-4741f099505a"
