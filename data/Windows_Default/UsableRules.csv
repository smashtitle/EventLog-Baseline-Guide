"title","level","service","category","description","id"
"MSI Install","informational","application","","Windows Installer installed software via an MSI file.
%Data[1]%: Product Name
%Data[2]%: Product Version
%Data[3]%: Product Language in LCID format. (Ex: 1033 for English)
%Data[4]%: Installation status code. 0 means success.
%Data[5]%: Vendor
%Data[6]%: Not sure.
Binary: Not sure how to decode.
","ef118d4d-ef83-40a7-bb27-2bb3945473ee"
"MSI Installation From Web","medium","application","","Detects installation of a remote msi file from web.","1af7877b-8512-f49c-c11e-a048888c68fa"
"Atera Agent Installation","high","application","","Detects successful installation of Atera Remote Monitoring & Management (RMM) agent as recently found to be used by Conti operators","655bf214-78ac-5d4f-27ac-4e0ede9b68a5"
"Application Uninstalled","low","application","","An application has been removed. Check if it is critical.","33c276a1-2475-2f1f-aa3d-ec5d61dbe94c"
"MSI Installation From Suspicious Locations","medium","application","","Detects MSI package installation from suspicious locations","96acd930-342e-66ca-9855-1285ba8a40ed"
"Microsoft Malware Protection Engine Crash","high","application","","This rule detects a suspicious crash of the Microsoft Malware Protection Engine","24cdd840-5da1-6c12-5b58-4da49cc4b11a"
"Potential Credential Dumping Via WER - Application","high","application","","Detects Windows error reporting event where the process that crashed is lsass. This could be the cause of an intentional crash by techniques such as Lsass-Shtinkering to dump credential","fcc29ed2-c7fa-1b44-6db4-de352c7cf1b8"
"MSSQL Server Failed Logon From External Network","medium","application","","Detects failed logon attempts from clients with external network IP to an MSSQL server. This can be a sign of a bruteforce attack.","2aec0e1c-e7f6-3837-d7f2-ee1c5cac7032"
"MSSQL SPProcoption Set","high","application","","Detects when the a stored procedure is set or cleared for automatic execution in MSSQL. A stored procedure that is set to automatic execution runs every time an instance of SQL Server is started","824a7eb7-81e3-6b27-2ede-6fd2d58348b4"
"MSSQL Add Account To Sysadmin Role","high","application","","Detects when an attacker tries to backdoor the MSSQL server by adding a backdoor account to the sysadmin fixed server role","d17d99ad-18e9-67e1-6163-054f210fee16"
"MSSQL Disable Audit Settings","high","application","","Detects when an attacker calls the ""ALTER SERVER AUDIT"" or ""DROP SERVER AUDIT"" transaction in order to delete or disable audit logs on the server","e485c12e-8840-1b24-61f7-697e480d63b1"
"MSSQL XPCmdshell Suspicious Execution","high","application","","Detects when the MSSQL ""xp_cmdshell"" stored procedure is used to execute commands","bc1445fe-1749-b913-f147-64575e1d9ac1"
"MSSQL Server Failed Logon","low","application","","Detects failed logon attempts from clients to MSSQL server.","03e217c6-de25-3afa-3833-6c534a6576f0"
"MSSQL XPCmdshell Option Change","high","application","","Detects when the MSSQL ""xp_cmdshell"" stored procedure setting is changed.
","11635209-eef1-b93a-98bf-33b80e5065a1"
"Restricted Software Access By SRP","high","application","","Detects restricted access to applications by the Software Restriction Policies (SRP) policy","2ebb1619-89c0-1a11-2b58-53ef8c2cb863"
"Ntdsutil Abuse","medium","application","","Detects potential abuse of ntdsutil to dump ntds.dit database","b8d0d560-906d-670f-cd10-32ed9179f21a"
"Dump Ntds.dit To Suspicious Location","medium","application","","Detects potential abuse of ntdsutil to dump ntds.dit database to a suspicious location","a050e701-373d-fc52-c345-8fbf933e1b82"
"Relevant Anti-Virus Signature Keywords In Application Log","high","application","","Detects potentially highly relevant antivirus events in the application log based on known virus signature names and malware keywords.
","b0f698cd-af36-2a37-ce9f-2ab614a8b808"
"Remote Access Tool - ScreenConnect File Transfer","low","application","","Detects file being transferred via ScreenConnect RMM","98bb59e9-ce78-f18f-8355-8a6750afb314"
"Remote Access Tool - ScreenConnect Command Execution","low","application","","Detects command execution via ScreenConnect RMM","8df2af03-bf29-1ee2-5e6e-476326c561d7"
"Audit CVE Event","critical","application","","Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited.
MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.
Unfortunately, that is about the only instance of CVEs being written to this log.
","f1c99d55-8f38-1ae5-19b6-71d4124f4c46"
"Backup Catalog Deleted","medium","application","","Detects backup catalog deletions","9abb29b7-6fca-9563-2f87-11926d64e17d"
"Microsoft Malware Protection Engine Crash - WER","high","application","","This rule detects a suspicious crash of the Microsoft Malware Protection Engine","ea429061-e3b4-fabd-8bd6-cb98772aeeba"
"Suspicious Usage of CVE_2021_34484 or CVE 2022_21919","low","application","","During exploitation of this vulnerability, two logs (Provider_Name:Microsoft-Windows-User Profiles Service) with EventID 1511 and 1515 (maybe lot of false positives with this event) are created. Moreover, it appears the directory \Users\TEMP is created may be created during the exploitation. Viewed on 2008 Server","17e91768-3a0f-6d5f-bc0d-7f2d22391909"
"LPE InstallerFileTakeOver PoC CVE-2021-41379","high","application","","Detects PoC tool used to exploit LPE vulnerability CVE-2021-41379","8e38887f-8e20-477d-26c1-0862951ae91b"
"MSSQL Extended Stored Procedure Backdoor Maggie","high","application","","This rule detects the execution of the extended storage procedure backdoor named Maggie in the context of Microsoft SQL server","e177969a-73cc-a32c-b948-cb580287057a"
"CVE-2024-49113 Exploitation Attempt - LDAP Nightmare","high","application","","Detects exploitation attempt of CVE-2024-49113 known as LDAP Nightmare, based on ""Application Error"" log where the faulting application is ""lsass.exe"" and the faulting module is ""WLDAP32.dll"".
","1117f6c7-1c68-9c6e-c3e8-191e9d687387"
"CVE-2023-40477 Potential Exploitation - WinRAR Application Crash","medium","application","","Detects a crash of ""WinRAR.exe"" where the version is lower than 6.23. This could indicate potential exploitation of CVE-2023-40477","f33feae7-db95-01a2-c35f-a6361e690ebb"
"MSMQ Corrupted Packet Encountered","high","application","","Detects corrupted packets sent to the MSMQ service. Could potentially be a sign of CVE-2023-21554 exploitation","0bcc2c11-231f-f491-7985-3571fee7f2c5"
"CVE-2020-0688 Exploitation via Eventlog","high","application","","Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688","b1a2ae27-889c-aa26-1bd3-21f277008048"
"File Was Not Allowed To Run","medium","applocker","","Detect run not allowed files. Applocker is a very useful tool, especially on servers where unprivileged users have access. For example terminal servers. You need configure applocker and log collect to receive these events.","da0e47f5-493f-9da4-b041-8eb762761118"
"Bits Job Created","informational","bits-client","","Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads.","18e6fa4a-353d-42b6-975c-bb05dbf4a004"
"New BITS Job Created Via Bitsadmin","low","bits-client","","Detects the creation of a new bits job by Bitsadmin","f72c1543-44f6-f836-c0da-9bab33600dac"
"BITS Transfer Job Download From Direct IP","high","bits-client","","Detects a BITS transfer job downloading file(s) from a direct IP address.","5e8a986a-7579-0482-f86e-ad63f6341cd1"
"BITS Transfer Job Downloading File Potential Suspicious Extension","medium","bits-client","","Detects new BITS transfer job saving local files with potential suspicious extensions","b37c7d8f-22b8-a92d-1d1c-593de0fa759e"
"BITS Transfer Job With Uncommon Or Suspicious Remote TLD","medium","bits-client","","Detects a suspicious download using the BITS client from a FQDN that is unusual. Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads.","8a389ad3-d0c7-ef8c-1fb3-5bb7e31bcf7f"
"New BITS Job Created Via PowerShell","low","bits-client","","Detects the creation of a new bits job by PowerShell","23d76ee6-e5fc-fb90-961a-4b412b97cc94"
"BITS Transfer Job Download From File Sharing Domains","high","bits-client","","Detects BITS transfer job downloading files from a file sharing domain.","4f9e9e60-c580-dd4e-4f06-42a016217d0e"
"BITS Transfer Job Download To Potential Suspicious Folder","high","bits-client","","Detects new BITS transfer job where the LocalName/Saved file is stored in a potentially suspicious location","26844668-ef48-7a97-5687-9533e59288b7"
"CodeIntegrity - Blocked Driver Load With Revoked Certificate","high","codeintegrity-operational","","Detects blocked load attempts of revoked drivers","3838c754-9c4c-f500-6c7d-4c73b29717a9"
"CodeIntegrity - Unmet Signing Level Requirements By File Under Validation","low","codeintegrity-operational","","Detects attempted file load events that did not meet the signing level requirements. It often means the file's signature is revoked or a signature with the Lifetime Signing EKU has expired.
This event is best correlated with EID 3089 to determine the error of the validation.
","f45ca591-7575-818e-9a07-7493461a33c3"
"CodeIntegrity - Unmet WHQL Requirements For Loaded Kernel Module","high","codeintegrity-operational","","Detects loaded kernel modules that did not meet the WHQL signing requirements.","b1f60092-6ced-8775-b5dd-ac15a042e292"
"CodeIntegrity - Revoked Kernel Driver Loaded","high","codeintegrity-operational","","Detects the load of a revoked kernel driver","4764bb53-3383-ae11-5351-b67f0001d2a5"
"CodeIntegrity - Unsigned Image Loaded","high","codeintegrity-operational","","Detects loaded unsigned image on the system","d6ea0e4a-9918-a082-1c5d-bd5d2a4f0b76"
"CodeIntegrity - Unsigned Kernel Module Loaded","high","codeintegrity-operational","","Detects the presence of a loaded unsigned kernel module on the system.","23f17a2b-73ca-e465-e823-bb1d47543f6d"
"CodeIntegrity - Blocked Image Load With Revoked Certificate","high","codeintegrity-operational","","Detects blocked image load events with revoked certificates by code integrity.","6f9f7b5c-f44b-fe0a-bcb2-ff4a09bd4ccf"
"CodeIntegrity - Revoked Image Loaded","high","codeintegrity-operational","","Detects image load events with revoked certificates by code integrity.","4d4c3fb7-504c-7089-2bb3-26781191b7eb"
"CodeIntegrity - Disallowed File For Protected Processes Has Been Blocked","high","codeintegrity-operational","","Detects block events for files that are disallowed by code integrity for protected processes","c2644e00-b2a8-1e98-7dfc-bbef3a929767"
"CodeIntegrity - Blocked Image/Driver Load For Policy Violation","high","codeintegrity-operational","","Detects blocked load events that did not meet the authenticode signing level requirements or violated the code integrity policy.","a4736e84-f507-2e6b-bc7a-573328447cbf"
"Loading Diagcab Package From Remote Path","high","diagnosis-scripted","","Detects loading of diagcab packages from a remote path, as seen in DogWalk vulnerability","b0e8486c-73f6-e1ba-9684-acba841c2719"
"USB Plugged In","informational","driver-framework","","","b39b18a5-cece-4e7d-a438-827d0b0e8a82"
"USB Device Plugged","low","driver-framework","","Detects plugged/unplugged USB devices","12717514-9380-dabc-12b9-113f524ec3ac"
"The Windows Defender Firewall Service Failed To Load Group Policy","low","firewall-as","","Detects activity when The Windows Defender Firewall service failed to load Group Policy","33a69619-460b-90f5-19b1-2f34036caf0a"
"Windows Firewall Settings Have Been Changed","low","firewall-as","","Detects activity when the settings of the Windows firewall have been changed","a0062bfc-2eba-05df-e231-f4a44b1317ab"
"All Rules Have Been Deleted From The Windows Firewall Configuration","high","firewall-as","","Detects when a all the rules have been deleted from the Windows Defender Firewall configuration","3623c339-f1c5-67f2-a5a2-ddb078d75f69"
"A Rule Has Been Deleted From The Windows Firewall Exception List","medium","firewall-as","","Detects when a single rules or all of the rules have been deleted from the Windows Defender Firewall","55827aab-4062-032f-35e7-2406dc57c35e"
"New Firewall Rule Added In Windows Firewall Exception List For Potential Suspicious Application","high","firewall-as","","Detects the addition of a new rule to the Windows Firewall exception list for an application located in a potentially suspicious location.","bf17c34a-7b9d-65a8-a143-afa9c13e1fe4"
"Uncommon New Firewall Rule Added In Windows Firewall Exception List","medium","firewall-as","","Detects when a rule has been added to the Windows Firewall exception list","a1dbd390-a4c5-755a-1b1f-a76aabbecbbc"
"Windows Defender Firewall Has Been Reset To Its Default Configuration","low","firewall-as","","Detects activity when Windows Defender Firewall has been reset to its default configuration","e2592615-38d5-5099-c59f-83ab34a11d9a"
"New Firewall Rule Added In Windows Firewall Exception List Via WmiPrvSE.EXE","medium","firewall-as","","Detects the addition of a new ""Allow"" firewall rule by the WMI process (WmiPrvSE.EXE).
This can occur if an attacker leverages PowerShell cmdlets such as ""New-NetFirewallRule"", or directly uses WMI CIM classes such as ""MSFT_NetFirewallRule"".
","ac6e5dab-06d1-5064-a91c-0eb6246d22bd"
"Firewall Rule Modified In The Windows Firewall Exception List","low","firewall-as","","Detects when a rule has been modified in the Windows firewall exception list","5d551ac6-b825-b536-7ec6-75339fc57a25"
"Loading Diagcab Package From Remote Path","high","diagnosis-scripted","","Detects loading of diagcab packages from a remote path, as seen in DogWalk vulnerability","b0e8486c-73f6-e1ba-9684-acba841c2719"
"PwSh 2.0 Downgrade Attack","medium","powershell-classic","ps_classic_start","An attacker may have started Powershell 2.0 to evade detection.","bc082394-73e6-4d00-a9af-e7b524ef5085"
"PwSh Engine Started","informational","powershell-classic","ps_classic_start","Engine state is changed from None to Available.","ac2ae63b-83e6-4d06-aeaf-07409bda92c9"
"Potential Malicious AppX Package Installation Attempts","medium","appxdeployment-server","","Detects potential installation or installation attempts of known malicious appx packages","8f46b318-b8a3-d268-911f-318d0b43c0f9"
"bXOR Operator Usage In PowerShell Command Line - PowerShell Classic","low","","ps_classic_start","Detects powershell execution with that make use of to the bxor (Bitwise XOR).
Attackers might use as an alternative obfuscation method to Base64 encoded commands.
Investigate the CommandLine and process tree to determine if the activity is malicious.
","8427e501-af53-a1ba-41a5-0b2d83e199fb"
"Uncommon PowerShell Hosts","medium","","ps_classic_start","Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe","315f165d-92fd-170d-d80b-0f16f9cf5384"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","powershell","","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","349e3bb4-b72b-193d-810e-7d9c145b863e"
"Suspicious PowerShell Invocations - Specific","high","powershell","","Detects suspicious PowerShell invocation command parameters","3db961f4-6217-4957-b717-e5955c82d6e5"
"Suspicious PowerShell Download","medium","powershell","","Detects suspicious PowerShell download command","12f93a4e-cd0e-18d7-6969-b345ecc8d40a"
"Suspicious PowerShell Invocations - Generic","high","powershell","","Detects suspicious PowerShell invocation command parameters","391b98f2-3f42-0d06-a295-18a2aa29d39a"
"Nslookup PowerShell Download Cradle","medium","","ps_classic_start","Detects a powershell download cradle using nslookup. This cradle uses nslookup to extract payloads from DNS records.","11151659-80c2-7657-d058-2a07c5662662"
"Suspicious Non PowerShell WSMAN COM Provider","medium","powershell-classic","","Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"Delete Volume Shadow Copies Via WMI With PowerShell","high","","ps_classic_start","Shadow Copies deletion using operating systems utilities via PowerShell","970cb6bc-a1b8-c7da-f658-ea96f2045162"
"Use Get-NetTCPConnection","low","","ps_classic_start","Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.","19bee8fa-b4db-79ab-2c60-ea8ae4875dcc"
"PowerShell Downgrade Attack - PowerShell","medium","","ps_classic_start","Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0","05ab81d4-8539-cffc-89f9-e470468bb28c"
"Renamed Powershell Under Powershell Channel","low","","ps_classic_start","Detects a renamed Powershell execution, which is a common technique used to circumvent security controls and bypass detection logic that's dependent on process names and process paths.
","b1868902-0d34-3392-8d98-99c0919a01d4"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell","medium","powershell-classic","","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","ee9681d0-6ba5-5eaf-9c8b-fe39afe542b9"
"PowerShell Called from an Executable Version Mismatch","high","","ps_classic_start","Detects PowerShell called from an executable by the version mismatch method","b8c409c0-bd7a-5c05-0bae-56f88fe7b78d"
"Netcat The Powershell Version","medium","","ps_classic_start","Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network","cc575689-20fe-0dda-ed3b-93e52d0d8ef1"
"Potential RemoteFXvGPUDisablement.EXE Abuse","high","powershell-classic","","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of  the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","29a3935d-0428-4f39-d39e-ec43c598b272"
"Suspicious PowerShell Download","medium","","ps_classic_start","Detects suspicious PowerShell download command","d938bbb0-a745-c4fc-ce0d-eb5a006e6757"
"Remote PowerShell Session (PS Classic)","low","","ps_classic_start","Detects remote PowerShell sessions","d79eda57-503a-274d-fab8-0d26ff047015"
"PwSh Pipeline Exec","informational","powershell","ps_module","Powershell Module Loggong. Displays powershell execution","d3fb8f7b-88b0-4ff4-bf9b-ca286ce19031"
"Local Firewall Rules Enumeration Via NetFirewallRule Cmdlet","low","","ps_module","Detects execution of ""Get-NetFirewallRule"" or ""Show-NetFirewallRule"" to enumerate the local firewall rules on a host.","81b7f962-1b39-9a15-eca7-f718f8e45e85"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","powershell","","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","349e3bb4-b72b-193d-810e-7d9c145b863e"
"Netcat The Powershell Version - PowerShell Module","medium","","ps_module","Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network","65efb931-2d64-dea1-b559-544498a9b6f8"
"Suspicious PowerShell Invocations - Specific","high","powershell","","Detects suspicious PowerShell invocation command parameters","3db961f4-6217-4957-b717-e5955c82d6e5"
"Suspicious PowerShell Download","medium","powershell","","Detects suspicious PowerShell download command","12f93a4e-cd0e-18d7-6969-b345ecc8d40a"
"Suspicious PowerShell Invocations - Generic","high","powershell","","Detects suspicious PowerShell invocation command parameters","391b98f2-3f42-0d06-a295-18a2aa29d39a"
"Suspicious Non PowerShell WSMAN COM Provider","medium","powershell-classic","","Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell","medium","powershell-classic","","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","ee9681d0-6ba5-5eaf-9c8b-fe39afe542b9"
"Potential RemoteFXvGPUDisablement.EXE Abuse","high","powershell-classic","","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of  the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","29a3935d-0428-4f39-d39e-ec43c598b272"
"Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell Module","high","","ps_module","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","c2325f35-edc7-9b45-d0bc-548ab4074e0a"
"Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell Module","high","","ps_module","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block cited in the reference section below","b21405ff-2071-082b-067f-fa116d28a858"
"PowerShell Decompress Commands","informational","","ps_module","A General detection for specific decompress commands in PowerShell logs. This could be an adversary decompressing files.","e4ba78e1-d659-9152-8504-cae6d6c7372e"
"Invoke-Obfuscation STDIN+ Launcher - PowerShell Module","high","","ps_module","Detects Obfuscated use of stdin to execute PowerShell","c539a450-9d59-8ac3-1709-f3b5f2e5a989"
"Suspicious PowerShell Download - PoshModule","medium","","ps_module","Detects suspicious PowerShell download command","3a7c8368-70ba-0539-d7a9-662a59306969"
"Malicious PowerShell Scripts - PoshModule","high","","ps_module","Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance","a26b0227-f81e-097b-19ba-ffbb04417ccc"
"HackTool - Evil-WinRm Execution - PowerShell Module","high","","ps_module","Detects the execution of Evil-WinRM via PowerShell Module logs by leveraging the hardcoded strings inside the utility.
","a0ecd6f3-309d-3ad0-2231-421f98a89f32"
"Invoke-Obfuscation Via Use Rundll32 - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via use Rundll32 in Scripts","acb9f9fe-df3e-be2a-239f-51b194099630"
"Remote PowerShell Session (PS Module)","high","","ps_module","Detects remote PowerShell sessions","d8bf9898-a71e-347a-25d6-1fde2e2925e6"
"Invoke-Obfuscation Via Use MSHTA - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via use MSHTA in Scripts","6ead282b-ed6b-7f68-1ed2-b8f5fb092b4e"
"Clear PowerShell History - PowerShell Module","medium","","ps_module","Detects keywords that could indicate clearing PowerShell history","5dea4020-38c8-b6d5-ebdb-2a7cfa20044e"
"Invoke-Obfuscation Via Use Clip - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via use Clip.exe in Scripts","d1ec8808-93c9-9dcb-b4b8-b20791287ee2"
"Alternate PowerShell Hosts - PowerShell Module","medium","","ps_module","Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe","b7826f95-a54d-d6e4-d4e0-38998c4eb8d7"
"Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell Module","medium","","ps_module","Detects Obfuscated Powershell via COMPRESS OBFUSCATION","93fea8ea-89ab-d08a-3904-a6949999010c"
"SyncAppvPublishingServer Bypass Powershell Restriction - PS Module","medium","","ps_module","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","9863342f-1e0e-72c5-8faa-674337cd6d2b"
"Invoke-Obfuscation Via Stdin - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via Stdin in Scripts","58925ff0-2936-8ebd-4c28-8fdbb8ac19a8"
"Bad Opsec Powershell Code Artifacts","critical","","ps_module","focuses on trivial artifacts observed in variants of prevalent offensive ps1 payloads, including
Cobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other attack payloads
that often undergo minimal changes by attackers due to bad opsec.
","118c017d-54bd-d0a7-e24e-74482fd67b54"
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell Module","high","","ps_module","Detects Obfuscated Powershell via VAR++ LAUNCHER","b2064db0-e465-72c2-edcc-57cfd9676207"
"Suspicious PowerShell Invocations - Specific - PowerShell Module","high","","ps_module","Detects suspicious PowerShell invocation command parameters","da4a803e-e609-d187-675c-d7e7f0083763"
"Suspicious Get Local Groups Information","low","","ps_module","Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.
","300dbe85-b7a0-be0b-aa57-321c1ee97848"
"Zip A Folder With PowerShell For Staging In Temp  - PowerShell Module","medium","","ps_module","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","a707acca-c4f5-6929-a1fc-0908ab087be0"
"Suspicious Get Information for SMB Share - PowerShell Module","low","","ps_module","Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and
to identify potential systems of interest for Lateral Movement.
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.
","a1d89efd-6d69-416b-3004-ec9c460a863d"
"Malicious PowerShell Commandlets - PoshModule","high","","ps_module","Detects Commandlet names from well-known PowerShell exploitation frameworks","36554b35-d185-3e51-6b7f-9b61726b8d3a"
"Suspicious Computer Machine Password by PowerShell","medium","","ps_module","The Reset-ComputerMachinePassword cmdlet changes the computer account password that the computers use to authenticate to the domain controllers in the domain.
You can use it to reset the password of the local computer.
","31981511-e5c7-fa6d-65dd-422e26ba8f0d"
"Use Get-NetTCPConnection - PowerShell Module","low","","ps_module","Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.","8485a923-ab47-503c-8823-f930f71f83a1"
"Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell Module","medium","","ps_module","Detects Obfuscated Powershell via RUNDLL LAUNCHER","567da8d6-9387-9852-16ed-a336bfaad91e"
"Invoke-Obfuscation CLIP+ Launcher - PowerShell Module","high","","ps_module","Detects Obfuscated use of Clip.exe to execute PowerShell","7a595cb6-87c9-7d42-5bf9-f404e939d500"
"Suspicious Get-ADDBAccount Usage","high","","ps_module","Detects suspicious invocation of the Get-ADDBAccount script that reads from a ntds.dit file and may be used to get access to credentials without using any credential dumpers","85b06a92-2ad6-ef34-57c3-fac694f74095"
"AD Groups Or Users Enumeration Using PowerShell - PoshModule","low","","ps_module","Adversaries may attempt to find domain-level groups and permission settings.
The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.
","f3c1031c-796c-6c50-7af9-c490e09550f6"
"Invoke-Obfuscation VAR+ Launcher - PowerShell Module","high","","ps_module","Detects Obfuscated use of Environment Variables to execute PowerShell","61ec8448-ba5d-0b4f-8089-eb047d43a2ec"
"PowerShell Get Clipboard","medium","","ps_module","A General detection for the Get-Clipboard commands in PowerShell logs. This could be an adversary capturing clipboard contents.","8ed7f4b3-91aa-4c85-95e8-a361f9004b2e"
"Potential Active Directory Enumeration Using AD Module - PsModule","medium","","ps_module","Detects usage of the ""Import-Module"" cmdlet to load the ""Microsoft.ActiveDirectory.Management.dl"" DLL. Which is often used by attackers to perform AD enumeration.","043fe2ff-2844-9176-3d40-aa3bf3e794a6"
"Suspicious PowerShell Invocations - Generic - PowerShell Module","high","","ps_module","Detects suspicious PowerShell invocation command parameters","e27c3517-69ca-c8c3-fc57-c4baba10867f"
"Potentially Malicious PwSh","medium","powershell","ps_script","On Powershell v5+, Windows will automatically log suspicious powershell execution and mark the Level as Warning.","73be1519-4648-4ed7-b305-605504afc242"
"PwSh Scriptblock","informational","powershell","ps_script","Powershell Scriptblock Logging. Windows 10+ will flag suspicious PwSh as level 3 (warning) so 
I am filtering out these events as they are being created with the ""Potentially Malicious PwSh"" rule.
","0f3b1343-65a5-4879-b512-9d61b0e4e3ba"
"WinAPI Library Calls Via PowerShell Scripts","medium","","ps_script","Detects calls to WinAPI libraries from PowerShell scripts. Attackers can often leverage these APIs to avoid detection based on typical PowerShell function calls. Use this rule as a basis to hunt for interesting scripts.","66cccc69-033d-56e2-a1e1-f190cc0a9ca0"
"Potential Registry Reconnaissance Via PowerShell Script","medium","","ps_script","Detects PowerShell scripts with potential registry reconnaissance capabilities. Adversaries may interact with the Windows registry to gather information about the system credentials, configuration, and installed software.","822b05a7-afa1-99c7-fc49-578330c9bf81"
"New Windows Firewall Rule Added Via New-NetFirewallRule Cmdlet - ScriptBlock","low","","ps_script","Detects when a powershell script contains calls to the ""New-NetFirewallRule"" cmdlet in order to add a new firewall rule with an ""Allow"" action.
","40fd8a4e-3820-0edf-530e-53785ee863e9"
"Use Of Remove-Item to Delete File - ScriptBlock","low","","ps_script","PowerShell Remove-Item  with -Path to delete a file or a folder with ""-Recurse""","6e77c76e-375f-3378-fb5b-0d55e078f8ad"
"SMB over QUIC Via PowerShell Script","medium","","ps_script","Detects the mounting of Windows SMB shares over QUIC, which can be an unexpected event in some enterprise environments","b3c17af7-4207-0100-fe3c-3730a1c40c82"
"Compress-Archive Cmdlet Execution","low","","ps_script","Detects PowerShell scripts that make use of the ""Compress-Archive"" cmdlet in order to compress folders and files.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","c0483a49-1049-db52-97c5-ed73a6063b93"
"Potential Data Exfiltration Over SMTP Via Send-MailMessage Cmdlet","medium","","ps_script","Detects the execution of a PowerShell script with a call to the ""Send-MailMessage"" cmdlet along with the ""-Attachments"" flag. This could be a potential sign of data exfiltration via Email.
Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.
","87face0d-1383-7cc4-2da9-2a5da8b81325"
"Windows Mail App Mailbox Access Via PowerShell Script","medium","","ps_script","Detects PowerShell scripts that try to access the default Windows MailApp MailBox. This indicates manipulation of or access to the stored emails of a user. E.g. this could be used by an attacker to exfiltrate or delete the content of the emails.","aac8a133-780e-35ed-5d52-60a568765afb"
"WinAPI Function Calls Via PowerShell Scripts","medium","","ps_script","Detects calls to WinAPI functions from PowerShell scripts. Attackers can often leverage these APIs to avoid detection based on typical PowerShell function calls. Use this rule as a basis to hunt for interesting scripts.","fc457d0e-1ed4-ecab-aa1f-bd5c4b53c2d9"
"PrintNightmare Powershell Exploitation","high","","ps_script","Detects Commandlet name for PrintNightmare exploitation.","5eb9df17-06bd-e2fe-8871-13bd6bd36406"
"Powershell File and Directory Discovery","low","","ps_script","Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.
Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors,
including whether or not the adversary fully infects the target and/or attempts specific actions.
","113fcff8-c64d-8743-88b7-9ff2539cde7d"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","powershell","","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","349e3bb4-b72b-193d-810e-7d9c145b863e"
"Accessing Encrypted Credentials from Google Chrome Login Database","medium","","ps_script","Adversaries may acquire credentials from web browsers by reading files specific to the target browser.
Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.
Web browsers typically store the credentials in an encrypted format within a credential store.
","63c2d41b-b587-6c55-c256-9c0bb392f0a9"
"AzureHound PowerShell Commands","high","","ps_script","Detects the execution of AzureHound in PowerShell, a tool to gather data from Azure for BloodHound","74dda95a-b492-e2ee-4a33-b22a41a1cb57"
"Suspicious Get-WmiObject","low","","ps_script","The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers","830423bc-69e4-b19b-5474-414e4ab0c365"
"Execution via CL_Invocation.ps1 - Powershell","high","","ps_script","Detects Execution via SyncInvoke in CL_Invocation.ps1 module","6587075c-6239-f6e1-4717-4b7972b1c086"
"Suspicious PowerShell Invocations - Specific","high","powershell","","Detects suspicious PowerShell invocation command parameters","3db961f4-6217-4957-b717-e5955c82d6e5"
"Suspicious PowerShell Download","medium","powershell","","Detects suspicious PowerShell download command","12f93a4e-cd0e-18d7-6969-b345ecc8d40a"
"Dnscat Execution","critical","","ps_script","Dnscat exfiltration tool execution","47d13687-edae-dafa-bdab-416474c95f53"
"Suspicious PowerShell Invocations - Generic","high","powershell","","Detects suspicious PowerShell invocation command parameters","391b98f2-3f42-0d06-a295-18a2aa29d39a"
"Execution via CL_Mutexverifiers.ps1","high","","ps_script","Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module","f427b1c7-bbad-7bd6-bb0f-65b6170a3cb5"
"Delete Volume Shadow Copies via WMI with PowerShell - PS Script","high","","ps_script","Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil","baee41a3-2063-6125-778e-0d9710474c06"
"Execution via CL_Mutexverifiers.ps1 (2 Lines)","high","","ps_script","Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module","97408cc2-d2e8-83dd-1f84-93da08e9f191"
"Execution via CL_Invocation.ps1 (2 Lines)","high","","ps_script","Detects Execution via SyncInvoke in CL_Invocation.ps1 module","13cf4134-564b-abdb-c83e-dac3ba9bac3c"
"Invoke-Obfuscation CLIP+ Launcher - PowerShell","high","","ps_script","Detects Obfuscated use of Clip.exe to execute PowerShell","fd4e11cc-a1e1-264d-4545-f06b97371ed2"
"Powershell Add Name Resolution Policy Table Rule","high","","ps_script","Detects powershell scripts that adds a Name Resolution Policy Table (NRPT) rule for the specified namespace.
This will bypass the default DNS server and uses a specified server for answering the query.
","6dcad107-58f0-d885-7198-fe78bda1ff4b"
"Suspicious PowerShell Invocations - Generic","high","","ps_script","Detects suspicious PowerShell invocation command parameters","308e8029-d702-799b-6aea-82f749348b24"
"AMSI Bypass Pattern Assembly GetType","high","","ps_script","Detects code fragments found in small and obfuscated AMSI bypass PowerShell scripts","b38a93d1-2bd3-6583-6617-1f4bdccf8589"
"HackTool - Rubeus Execution - ScriptBlock","high","","ps_script","Detects the execution of the hacktool Rubeus using specific command line flags","1296d31f-9f66-0be1-424b-a641f15c4475"
"Potential AMSI Bypass Script Using NULL Bits","medium","","ps_script","Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities","4502b93e-2c0d-56b8-7ce1-35523e4fb0ba"
"Potential In-Memory Execution Using Reflection.Assembly","medium","","ps_script","Detects usage of ""Reflection.Assembly"" load functions to dynamically load assemblies in memory","4ee64eb7-79b5-d7d2-9ba7-89616409e7d0"
"Detected Windows Software Discovery - PowerShell","medium","","ps_script","Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.","abc8469f-9601-7199-13b7-9620478f5335"
"Execute Invoke-command on Remote Host","medium","","ps_script","Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.","a4603d3c-bb7c-8db0-3d8a-23f265190006"
"Suspicious PowerShell Download - Powershell Script","medium","","ps_script","Detects suspicious PowerShell download command","e3888b82-f1d3-14e8-54e5-16b522dfd8a9"
"Suspicious X509Enrollment - Ps Script","medium","","ps_script","Detect use of X509Enrollment","8acde15f-c52f-455b-127c-8de1892767e5"
"PowerShell Credential Prompt","high","","ps_script","Detects PowerShell calling a credential prompt","77e99ce3-b834-1c0d-0fe8-ffd39f1bc29f"
"Powershell Detect Virtualization Environment","medium","","ps_script","Adversaries may employ various system checks to detect and avoid virtualization and analysis environments.
This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox
","654b7573-5b04-0352-d832-f32c333f4a56"
"Malicious ShellIntel PowerShell Commandlets","high","","ps_script","Detects Commandlet names from ShellIntel exploitation scripts.","e84977df-6377-368d-ed22-e05ee31e9947"
"Suspicious PowerShell WindowStyle Option","medium","","ps_script","Adversaries may use hidden windows to conceal malicious activity from the plain sight of users.
In some cases, windows that would typically be displayed when an application carries out an operation can be hidden
","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"Invoke-Obfuscation VAR+ Launcher - PowerShell","high","","ps_script","Detects Obfuscated use of Environment Variables to execute PowerShell","1bc61c35-56bd-6b9c-12fc-5513d8aa80d2"
"PSAsyncShell - Asynchronous TCP Reverse Shell","high","","ps_script","Detects the use of PSAsyncShell an Asynchronous TCP Reverse Shell written in powershell","714c75ab-6bed-7c9d-462b-f7f9252e47e5"
"Potentially Suspicious Call To Win32_NTEventlogFile Class - PSScript","medium","","ps_script","Detects usage of the WMI class ""Win32_NTEventlogFile"" in a potentially suspicious way (delete, backup, change permissions, etc.) from a PowerShell script","72ba1398-c3d6-c1a6-9133-bc72ccaca90d"
"Potential Keylogger Activity","medium","","ps_script","Detects PowerShell scripts that contains reference to keystroke capturing functions","6154995f-9153-aaa3-dc51-d3062506c78a"
"Manipulation of User Computer or Group Security Principals Across AD","medium","","ps_script","Adversaries may create a domain account to maintain access to victim systems.
Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain..
","2843f0fc-1a75-2140-6c4c-f5c296073941"
"Potential Packet Capture Activity Via Start-NetEventSession - ScriptBlock","medium","","ps_script","Detects the execution of powershell scripts with calls to the ""Start-NetEventSession"" cmdlet. Which allows an attacker to start event and packet capture for a network event session.
Adversaries may attempt to capture network to gather information over the course of an operation.
Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol.
","0357e3d7-f8fe-0601-0902-364f4cdbed81"
"Suspicious Connection to Remote Account","low","","ps_script","Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts.
Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism
","f9203bdd-ca24-aced-1e79-b9cfd7936099"
"Disable of ETW Trace - Powershell","high","","ps_script","Detects usage of powershell cmdlets to disable or remove ETW trace sessions","f1205c3a-b112-f060-2b3e-b43fd3460482"
"PowerShell Get-Process LSASS in ScriptBlock","high","","ps_script","Detects a Get-Process command on lsass process, which is in almost all cases a sign of malicious activity","77515874-226e-d597-815a-9962d2951358"
"Active Directory Group Enumeration With Get-AdGroup","low","","ps_script","Detects usage of the ""Get-AdGroup"" cmdlet to enumerate Groups within Active Directory","80aaec39-a75b-8ad7-ac46-14fd5159f93f"
"Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell","medium","","ps_script","Detects Obfuscated Powershell via RUNDLL LAUNCHER","c4a3b240-b0c5-3eed-9e95-d3db01157764"
"PowerShell ADRecon Execution","high","","ps_script","Detects execution of ADRecon.ps1 for AD reconnaissance which has been reported to be actively used by FIN7","cde108d4-944b-2594-02b8-61f2852260a1"
"Disable Powershell Command History","high","","ps_script","Detects scripts or commands that disabled the Powershell command history by removing psreadline module","ebdae8b0-7b83-5602-356e-b214571cee19"
"Abuse of Service Permissions to Hide Services Via Set-Service - PS","high","","ps_script","Detects usage of the ""Set-Service"" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as ""sc.exe"", ""Get-Service""...etc. (Works only in powershell 7)","737309de-cb25-6cd6-de11-74ac6a587299"
"Potential Active Directory Enumeration Using AD Module - PsScript","medium","","ps_script","Detects usage of the ""Import-Module"" cmdlet to load the ""Microsoft.ActiveDirectory.Management.dl"" DLL. Which is often used by attackers to perform AD enumeration.","80fe1b47-6d38-9fc5-9535-6afd04b55a15"
"Powershell Sensitive File Discovery","medium","","ps_script","Detect adversaries enumerate sensitive files","246287be-b277-41bc-b620-83f82d6006d3"
"Windows Firewall Profile Disabled","medium","","ps_script","Detects when a user disables the Windows Firewall via a Profile to help evade defense.","b935d5dd-d5e5-51df-9c4f-dc30aec0a6e6"
"WMIC Unquoted Services Path Lookup - PowerShell","medium","","ps_script","Detects known WMI recon method to look for unquoted service paths, often used by pentest inside of powershell scripts attackers enum scripts","437f4723-94d2-dfdf-cd3b-9cf2e0af0fba"
"Request A Single Ticket via PowerShell","high","","ps_script","utilize native PowerShell Identity modules to query the domain to extract the Service Principal Names for a single computer.
This behavior is typically used during a kerberos or silver ticket attack.
A successful execution will output the SPNs for the endpoint in question.
","088701bf-4758-9a2a-76c0-2e148a7e122c"
"PowerShell Deleted Mounted Share","medium","","ps_script","Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation","2182e106-ae16-770c-3022-a67abacb10d0"
"Potential Suspicious Windows Feature Enabled","medium","","ps_script","Detects usage of the built-in PowerShell cmdlet ""Enable-WindowsOptionalFeature"" used as a Deployment Image Servicing and Management tool.
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
","c9326131-769a-8ba4-03f2-7d17f9847a50"
"PowerShell Script With File Hostname Resolving Capabilities","medium","","ps_script","Detects PowerShell scripts that have capabilities to read files, loop through them and resolve DNS host entries.","53f26dda-d088-32eb-a704-03c3b6986b49"
"Suspicious PowerShell Mailbox SMTP Forward Rule","medium","","ps_script","Detects usage of the powerShell Set-Mailbox Cmdlet to set-up an SMTP forwarding rule.","516b2199-36c5-1a0d-13f4-87bcb22bc2bf"
"PowerShell Hotfix Enumeration","medium","","ps_script","Detects call to ""Win32_QuickFixEngineering"" in order to enumerate installed hotfixes often used in ""enum"" scripts by attackers","3bef19ed-f703-65eb-ab07-eebb20abdd4e"
"Suspicious GPO Discovery With Get-GPO","low","","ps_script","Detect use of Get-GPO to get one GPO or all the GPOs in a domain.","43254631-95ca-6c3c-11bc-16c19f09e819"
"Invoke-Obfuscation Via Use MSHTA - PowerShell","high","","ps_script","Detects Obfuscated Powershell via use MSHTA in Scripts","d7307e8a-60da-106b-aeb8-c4ebd5c1fb6d"
"Create Volume Shadow Copy with Powershell","high","","ps_script","Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information","33f62d96-55cf-87d2-e9f0-0a5fff75a278"
"Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell","high","","ps_script","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014","30be45df-1ada-4075-3586-5a3d6eda8cd3"
"Code Executed Via Office Add-in XLL File","high","","ps_script","Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system.
Office add-ins can be used to add functionality to Office programs
","f5ce4704-7343-4e6a-f741-f53b6d412d1f"
"Suspicious Start-Process PassThru","medium","","ps_script","Powershell use PassThru option to start in background","c6dce605-3bb0-c881-1c5c-f3e4e9d62577"
"Powershell Suspicious Win32_PnPEntity","low","","ps_script","Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.","12bd77fd-a44d-6373-2156-4c29b22d9c85"
"Suspicious Get Information for SMB Share","low","","ps_script","Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as
a precursor for Collection and to identify potential systems of interest for Lateral Movement.
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.
","b3cb91b9-f3a8-1486-c398-1ea1e5183b3c"
"Winlogon Helper DLL","medium","","ps_script","Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.
Registry entries in HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\ and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ are
used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to
load and execute malicious DLLs and/or executables.
","de547eac-5fa2-bf69-1a62-760251de3870"
"Suspicious Get-ADReplAccount","medium","","ps_script","The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory.
These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.
","e59d0c87-f426-154d-9744-50e5cb987c9f"
"PowerShell ICMP Exfiltration","medium","","ps_script","Detects Exfiltration Over Alternative Protocol - ICMP. Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.","647d9a85-b4af-a355-a79e-5ad4afa553bd"
"Windows Screen Capture with CopyFromScreen","medium","","ps_script","Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation.
Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations
","bf9ed747-37f2-803e-2a51-91d56622d6ba"
"Suspicious PowerShell Get Current User","low","","ps_script","Detects the use of PowerShell to identify the current logged user.","43541d1d-9cb1-a49f-2fb9-4121c1302705"
"AD Groups Or Users Enumeration Using PowerShell - ScriptBlock","low","","ps_script","Adversaries may attempt to find domain-level groups and permission settings.
The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.
","956b0dfd-4aba-c0c7-7608-c7889eea8a67"
"Service Registry Permissions Weakness Check","medium","","ps_script","Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.
Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.
Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services
","ce3cad3a-afec-9acc-c763-9b4cb0fd5ece"
"PowerShell Remote Session Creation","medium","","ps_script","Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system
","f1a1daa1-2c4e-6354-e062-1f80427eafc3"
"Change User Agents with WebRequest","medium","","ps_script","Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.
Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.
","efbceae5-07cf-4b09-fc03-df062b971e10"
"Powershell Execute Batch Script","medium","","ps_script","Adversaries may abuse the Windows command shell for execution.
The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems.
The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands.
Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops.
Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple system
","57b18282-5df7-0636-ee86-75ccdbe55519"
"Potential Suspicious PowerShell Keywords","medium","","ps_script","Detects potentially suspicious keywords that could indicate the use of a PowerShell exploitation framework","12b5b805-7b4b-d153-35e2-2230d216346c"
"WMImplant Hack Tool","high","","ps_script","Detects parameters used by WMImplant","a91bd8f4-12c9-8c19-370c-2ddece54fd99"
"AADInternals PowerShell Cmdlets Execution - PsScript","high","","ps_script","Detects ADDInternals Cmdlet execution. A tool for administering Azure AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office 365.","61d6fe12-d403-c9b3-bc3f-fb10de58a4c3"
"Remove Account From Domain Admin Group","medium","","ps_script","Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users.
Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts.
","33a52335-678e-da31-eb46-d7cfc302cb3e"
"Tamper Windows Defender Remove-MpPreference - ScriptBlockLogging","high","","ps_script","Detects attempts to remove Windows Defender configuration using the 'MpPreference' cmdlet","97e928f0-6985-66cd-fd2d-3783904a3c7c"
"Suspicious Hyper-V Cmdlets","medium","","ps_script","Adversaries may carry out malicious operations using a virtual instance to avoid detection","94272bf4-116b-5204-4be6-69b2d5648fa4"
"Powershell Create Scheduled Task","medium","","ps_script","Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code","977cdcc1-6d3a-a221-a03f-d794230e01ae"
"Suspicious Unblock-File","medium","","ps_script","Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.","b56d246e-e1d8-6f33-6e90-65864d130915"
"PowerShell Write-EventLog Usage","medium","","ps_script","Detects usage of the ""Write-EventLog"" cmdlet with 'RawData' flag. The cmdlet can be levreage to write malicious payloads to the EventLog and then retrieve them later for later use","777d9383-7a6f-f82a-d22e-2f05f433bc9b"
"Potential Persistence Via PowerShell User Profile Using Add-Content","medium","","ps_script","Detects calls to ""Add-Content"" cmdlet in order to modify the content of the user profile and potentially adding suspicious commands for persistence","aa566d46-235a-b467-88ed-434788883da2"
"HackTool - WinPwn Execution - ScriptBlock","high","","ps_script","Detects scriptblock text keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.
","40e38653-158e-78ce-f816-60a159924dc9"
"Get-ADUser Enumeration Using UserAccountControl Flags","medium","","ps_script","Detects AS-REP roasting is an attack that is often-overlooked. It is not very common as you have to explicitly set accounts that do not require pre-authentication.","0fb43313-1253-f71b-1a13-e10e073c1627"
"Powershell Store File In Alternate Data Stream","medium","","ps_script","Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.","a547df68-c62d-4415-9a62-cbe68f006b9e"
"Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell","medium","","ps_script","Detects Obfuscated Powershell via COMPRESS OBFUSCATION","527063ac-15f7-52e7-7ced-4348087aaec7"
"Password Policy Discovery With Get-AdDefaultDomainPasswordPolicy","low","","ps_script","Detetcts PowerShell activity in which Get-Addefaultdomainpasswordpolicy is used to get the default password policy for an Active Directory domain.","3c8ea56a-ad16-8598-c24e-3fdd6b345dda"
"Unsigned AppX Installation Attempt Using Add-AppxPackage - PsScript","medium","","ps_script","Detects usage of the ""Add-AppxPackage"" or it's alias ""Add-AppPackage"" to install unsigned AppX packages","649adb28-28ab-34b1-166d-cfffb0245bbd"
"PowerShell Create Local User","medium","","ps_script","Detects creation of a local user via PowerShell","b49ece4c-cd58-540c-62a8-d4189dc45f3e"
"Suspicious Mount-DiskImage","low","","ps_script","Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW.","a47e2fc3-e3e3-9763-7cb2-d19df00ad719"
"PowerView PowerShell Cmdlets - ScriptBlock","high","","ps_script","Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.","cc813de1-cf1f-dd91-bcfb-3821610d9dfc"
"Potential COM Objects Download Cradles Usage - PS Script","medium","","ps_script","Detects usage of COM objects that can be abused to download files in PowerShell by CLSID","8c8871af-c2f2-4671-9f1d-d6c3e90b7c42"
"Suspicious Service DACL Modification Via Set-Service Cmdlet - PS","high","","ps_script","Detects usage of the ""Set-Service"" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as ""sc.exe"", ""Get-Service""...etc. (Works only in powershell 7)","43de23b6-5e9c-142a-9e42-64992bede784"
"Enumerate Credentials from Windows Credential Manager With PowerShell","medium","","ps_script","Adversaries may search for common password storage locations to obtain user credentials.
Passwords are stored in several places on a system, depending on the operating system or application holding the credentials.
","129010c2-32d8-8ae8-d3a5-cdd24744231e"
"Add Windows Capability Via PowerShell Script","medium","","ps_script","Detects usage of the ""Add-WindowsCapability"" cmdlet to add Windows capabilities. Notable capabilities could be ""OpenSSH"" and others.","8094e74c-0e24-f840-50c3-bfcdc98cd6a9"
"Invoke-Obfuscation STDIN+ Launcher - Powershell","high","","ps_script","Detects Obfuscated use of stdin to execute PowerShell","a4545017-4d6d-c3bd-7fec-62214f01e6b2"
"Tamper Windows Defender - ScriptBlockLogging","high","","ps_script","Detects PowerShell scripts attempting to disable scheduled scanning and other parts of Windows Defender ATP or set default actions to allow.","6074ad34-a80f-fdd9-5c49-e1a2fc4572c4"
"Automated Collection Command PowerShell","medium","","ps_script","Once established within a system or network, an adversary may use automated techniques for collecting internal data.","d7f88495-fd82-8062-2c13-6036a8358e39"
"Certificate Exported Via PowerShell - ScriptBlock","medium","","ps_script","Detects calls to cmdlets inside of PowerShell scripts that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines.","58f5980d-d851-77b4-2f1f-945eb2d3e430"
"Malicious PowerShell Keywords","medium","","ps_script","Detects keywords from well-known PowerShell exploitation frameworks","4397a007-0c10-834b-0796-7b4b1b931b03"
"Suspicious Eventlog Clear","medium","","ps_script","Detects usage of known powershell cmdlets such as ""Clear-EventLog"" to clear the Windows event logs","a8e07a3d-571c-0d25-729b-fa16be9ea6c5"
"Invoke-Obfuscation Via Use Clip - Powershell","high","","ps_script","Detects Obfuscated Powershell via use Clip.exe in Scripts","33811b3f-3506-6bff-bb4a-4250e7714358"
"Powershell MsXml COM Object","medium","","ps_script","Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell)
Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code
","a57f49ff-b916-4527-881f-bef76dc42248"
"Suspicious GetTypeFromCLSID ShellExecute","medium","","ps_script","Detects suspicious Powershell code that execute COM Objects","9134b08c-39fa-8211-b3f5-5bd1839b9540"
"Potential Persistence Via Security Descriptors - ScriptBlock","high","","ps_script","Detects usage of certain functions and keywords that are used to manipulate security descriptors in order to potentially set a backdoor. As seen used in the DAMP project.","b46c37cc-554c-aab3-0744-26f3a5ace219"
"Suspicious Process Discovery With Get-Process","low","","ps_script","Get the processes that are running on the local computer.","0e7ff574-cd58-3250-821d-47fedcc03db6"
"Potential PowerShell Obfuscation Using Character Join","low","","ps_script","Detects specific techniques often seen used inside of PowerShell scripts to obfscuate Alias creation","5ab8284b-d017-c68c-31ff-6c9b51010284"
"Live Memory Dump Using Powershell","high","","ps_script","Detects usage of a PowerShell command to dump the live memory of a Windows machine","f279fcb8-4560-0d0c-3bee-043b32f9b3fb"
"PowerShell Web Access Installation - PsScript","high","","ps_script","Detects the installation and configuration of PowerShell Web Access, which could be used for remote access and potential abuse","802477a9-01ea-d5f8-2ff9-44285787d0f7"
"Malicious Nishang PowerShell Commandlets","high","","ps_script","Detects Commandlet names and arguments from the Nishang exploitation framework","79769f3b-efb3-9463-e114-7446d4361146"
"Disable-WindowsOptionalFeature Command PowerShell","high","","ps_script","Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
","cb989f20-ebb9-8b1b-a5d6-f98b3929346c"
"Veeam Backup Servers Credential Dumping Script Execution","high","","ps_script","Detects execution of a PowerShell script that contains calls to the ""Veeam.Backup"" class, in order to dump stored credentials.","5ac6d31e-76f4-b5ee-831e-7d076ff2dca6"
"Powershell DNSExfiltration","high","","ps_script","DNSExfiltrator allows for transferring (exfiltrate) a file over a DNS request covert channel","1dc5f777-bb62-c024-3838-e53492b5e574"
"Change PowerShell Policies to an Insecure Level - PowerShell","medium","","ps_script","Detects changing the PowerShell script execution policy to a potentially insecure level using the ""Set-ExecutionPolicy"" cmdlet.","e5a59479-4ded-f6c3-ab4d-8d464128fbb2"
"Recon Information for Export with PowerShell","medium","","ps_script","Once established within a system or network, an adversary may use automated techniques for collecting internal data","aa7ecfb4-5a28-3a35-0b06-35cdfed46928"
"Enable Windows Remote Management","medium","","ps_script","Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.","b5223513-5e9d-2c11-1cf7-d980bfed58f5"
"Suspicious IO.FileStream","medium","","ps_script","Open a handle on the drive volume via the \\.\ DOS device path specifier and perform direct access read of the first few bytes of the volume.","6454f2bf-2962-a90a-eec3-6c7bef6be08e"
"Modify Group Policy Settings - ScriptBlockLogging","medium","","ps_script","Detect malicious GPO modifications can be used to implement many other malicious behaviors.","0b0963db-269b-9351-ab12-4aa9d1f8a105"
"PowerShell PSAttack","high","","ps_script","Detects the use of PSAttack PowerShell hack tool","8dd08d08-a638-c74c-8e7a-07d55d3b3318"
"SyncAppvPublishingServer Execution to Bypass Powershell Restriction","medium","","ps_script","Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.","6ab29276-37b6-8501-afb8-33126a6a9918"
"Powershell Token Obfuscation - Powershell","high","","ps_script","Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation","77af6d22-9887-7943-53f1-6a849e2e892d"
"DirectorySearcher Powershell Exploitation","medium","","ps_script","Enumerates Active Directory to determine computers that are joined to the domain","d72c1916-ab63-11e1-1916-5e8b3822f133"
"PowerShell Script Change Permission Via Set-Acl - PsScript","low","","ps_script","Detects PowerShell scripts set ACL to of a file or a folder","3586407d-f3a3-bb2d-8467-0956e15af381"
"Access to Browser Login Data","medium","","ps_script","Adversaries may acquire credentials from web browsers by reading files specific to the target browser.
Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.
Web browsers typically store the credentials in an encrypted format within a credential store.
","0c3ed50a-e9ab-a1ab-192f-17494d3bcb53"
"Root Certificate Installed - PowerShell","medium","","ps_script","Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.","245734a0-22f3-d684-07a7-ed1cea011d8e"
"PowerShell ShellCode","high","","ps_script","Detects Base64 encoded Shellcode","7f3d30e6-1565-4e09-7b13-5d7c5b8b0947"
"PowerShell Set-Acl On Windows Folder - PsScript","high","","ps_script","Detects PowerShell scripts to set the ACL to a file in the Windows folder","82a11bd6-070f-3229-f413-73fe2ddd7018"
"Silence.EDA Detection","critical","","ps_script","Detects Silence EmpireDNSAgent as described in the Group-IP report","71d6a25b-6fe6-37e2-40bc-c4de171fbbc9"
"Potential WinAPI Calls Via PowerShell Scripts","high","","ps_script","Detects use of WinAPI functions in PowerShell scripts","edeeb148-ce01-b5b8-a531-3b364b7fd191"
"Potential Unconstrained Delegation Discovery Via Get-ADComputer - ScriptBlock","medium","","ps_script","Detects the use of the ""Get-ADComputer"" cmdlet in order to identify systems which are configured for unconstrained delegation.","c0fcc261-538c-247d-21ff-05b6d2cbdf07"
"Powershell Directory Enumeration","medium","","ps_script","Detects technique used by MAZE ransomware to enumerate directories using Powershell","13a97026-d21c-5c67-761d-537efe8f3fe7"
"PowerShell WMI Win32_Product Install MSI","medium","","ps_script","Detects the execution of an MSI file using PowerShell and the WMI Win32_Product class","a91de133-e7bc-3e22-d4ec-af1bfe620409"
"Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell ScriptBlock","high","","ps_script","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","9a9b4924-bf93-774d-4bee-a2d13260663c"
"Computer Discovery And Export Via Get-ADComputer Cmdlet - PowerShell","medium","","ps_script","Detects usage of the Get-ADComputer cmdlet to collect computer information and output it to a file","a86c5f75-859a-89ac-20a4-ad3be80336c9"
"Dump Credentials from Windows Credential Manager With PowerShell","medium","","ps_script","Adversaries may search for common password storage locations to obtain user credentials.
Passwords are stored in several places on a system, depending on the operating system or application holding the credentials.
","437d2bdc-4ee9-913b-42df-e947c8193f88"
"Suspicious Get Local Groups Information - PowerShell","low","","ps_script","Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.
","231be74a-ed58-7e55-d906-23131f589913"
"Import PowerShell Modules From Suspicious Directories","medium","","ps_script","Detects powershell scripts that import modules from suspicious directories","0a3956ee-9813-55f3-ca74-4d00e9df5262"
"Replace Desktop Wallpaper by Powershell","low","","ps_script","An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users.
This may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper
","a427508a-2c94-8fdb-863f-555304b70605"
"Powershell XML Execute Command","medium","","ps_script","Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell)
Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code
","f698fa3e-50d4-0a6b-4f65-9cc569e1a709"
"Suspicious TCP Tunnel Via PowerShell Script","medium","","ps_script","Detects powershell scripts that creates sockets/listeners which could be indicative of tunneling activity","f0174af7-3de1-3209-5f81-f96ff9d1f5c6"
"Extracting Information with PowerShell","medium","","ps_script","Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials.
These can be files created by users to store their own credentials, shared credential stores for a group of individuals,
configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.
","f9889db2-6490-a082-33a3-1b46dff5e2f1"
"Powershell Local Email Collection","medium","","ps_script","Adversaries may target user email on local systems to collect sensitive information.
Files containing email data can be acquired from a users local system, such as Outlook storage or cache files.
","00ba998e-b435-22a6-2dbf-e85e1918b8a7"
"PowerShell Script With File Upload Capabilities","low","","ps_script","Detects PowerShell scripts leveraging the ""Invoke-WebRequest"" cmdlet to send data via either ""PUT"" or ""POST"" method.","4dc42aa9-1963-4ee8-e6ed-021575365449"
"Registry-Free Process Scope COR_PROFILER","medium","","ps_script","Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR.
The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR).
These profiliers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR.
(Citation: Microsoft Profiling Mar 2017)
(Citation: Microsoft COR_PROFILER Feb 2013)
","98d89b85-61ea-f78b-d1fa-cd52182b6b28"
"Suspicious PowerShell Mailbox Export to Share - PS","critical","","ps_script","Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations","53ba1f6b-70f2-242f-1377-8dc22d806e78"
"Invoke-Obfuscation Via Use Rundll32 - PowerShell","high","","ps_script","Detects Obfuscated Powershell via use Rundll32 in Scripts","00b36dc9-4f98-0596-4487-6aabd187344b"
"Clear PowerShell History - PowerShell","medium","","ps_script","Detects keywords that could indicate clearing PowerShell history","36e3fc18-c21d-b046-86b0-9f14ccbb975e"
"Invoke-Obfuscation Via Stdin - Powershell","high","","ps_script","Detects Obfuscated Powershell via Stdin in Scripts","e355cee1-576c-66ad-ccaf-3f4dfa5b541e"
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell","high","","ps_script","Detects Obfuscated Powershell via VAR++ LAUNCHER","70b65468-d1e8-0a6b-78c3-a458a95e477b"
"Powershell Timestomp","medium","","ps_script","Adversaries may modify file time attributes to hide new or changes to existing files.
Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder.
","b32352bf-5bcb-d3c9-a9eb-4bbf8ed85654"
"Clearing Windows Console History","high","","ps_script","Identifies when a user attempts to clear console history. An adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion.","1a8e1936-4b07-2bb2-ef3a-2cdf7d294a56"
"Suspicious New-PSDrive to Admin Share","medium","","ps_script","Adversaries may use to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.","9d0ff6ee-9967-a757-d8dc-cf3f3b3546b1"
"NTFS Alternate Data Stream","high","","ps_script","Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.","e701b235-4663-b82b-8611-b51a0706589b"
"Powershell LocalAccount Manipulation","medium","","ps_script","Adversaries may manipulate accounts to maintain access to victim systems.
Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups
","ec4cdf41-f053-d3af-6a68-973d32bacdff"
"Suspicious FromBase64String Usage On Gzip Archive - Ps Script","medium","","ps_script","Detects attempts of decoding a base64 Gzip archive in a PowerShell script. This technique is often used as a method to load malicious content into memory afterward.","0f434135-833f-9c32-7048-ab3c6264d3d2"
"Suspicious Invoke-Item From Mount-DiskImage","medium","","ps_script","Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW.","a4fa5d2e-a803-b311-5ff7-669ada2d36eb"
"Potential Data Exfiltration Via Audio File","medium","","ps_script","Detects potential exfiltration attempt via audio file using PowerShell","4956629d-759b-2297-1edf-5751449384cb"
"Windows Defender Exclusions Added - PowerShell","medium","","ps_script","Detects modifications to the Windows Defender configuration settings using PowerShell to add exclusions","addd9852-1b8e-322b-77eb-4a749ba8dca6"
"Automated Collection Bookmarks Using Get-ChildItem PowerShell","low","","ps_script","Adversaries may enumerate browser bookmarks to learn more about compromised hosts.
Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about
internal network resources such as servers, tools/dashboards, or other related infrastructure.
","389e5737-c793-4d03-4191-fe78d2cc1dcb"
"Deletion of Volume Shadow Copies via WMI with PowerShell - PS Script","high","","ps_script","Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil","329df23d-a366-2e13-47f7-3c67cfb56f75"
"Security Software Discovery Via Powershell Script","medium","","ps_script","Detects calls to ""get-process"" where the output is piped to a ""where-object"" filter to search for security solution processes.
Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus
","2e7d9c7a-fab3-d015-8552-39acf165059c"
"Malicious PowerShell Commandlets - ScriptBlock","high","","ps_script","Detects Commandlet names from well-known PowerShell exploitation frameworks","247b332c-8cf3-11c1-bf63-2693c99a6082"
"Active Directory Computers Enumeration With Get-AdComputer","low","","ps_script","Detects usage of the ""Get-AdComputer"" to enumerate Computers or properties within Active Directory.","00f90856-99dc-9ecd-31ca-0d93b7577bac"
"Potential Invoke-Mimikatz PowerShell Script","high","","ps_script","Detects Invoke-Mimikatz PowerShell script and alike. Mimikatz is a credential dumper capable of obtaining plaintext Windows account logins and passwords.","b0c6066e-a243-d2f6-c744-990ed060759c"
"Suspicious PowerShell Invocations - Specific","high","","ps_script","Detects suspicious PowerShell invocation command parameters","8655ba53-c937-dbcf-91c5-3125219b9497"
"User Discovery And Export Via Get-ADUser Cmdlet - PowerShell","medium","","ps_script","Detects usage of the Get-ADUser cmdlet to collect user information and output it to a file","369a4eed-03b4-7aea-6309-c6d7173b0567"
"Powershell Keylogging","medium","","ps_script","Adversaries may log user keystrokes to intercept credentials as the user types them.","c9aa7755-6950-a83c-72f5-53d0eab019eb"
"Powershell WMI Persistence","medium","","ps_script","Adversaries may establish persistence and elevate privileges by executing malicious content triggered by a Windows Management Instrumentation (WMI) event subscription.","6535a2a7-e5ce-2a80-726d-8eb3b016084d"
"DSInternals Suspicious PowerShell Cmdlets - ScriptBlock","high","","ps_script","Detects execution and usage of the DSInternals PowerShell module. Which can be used to perform what might be considered as suspicious activity such as dumping DPAPI backup keys or manipulating NTDS.DIT files.
The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory. These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.
","55d8816f-49cc-7135-b3b1-63d41ce23a01"
"Potential PowerShell Obfuscation Using Alias Cmdlets","low","","ps_script","Detects Set-Alias or New-Alias cmdlet usage. Which can be use as a mean to obfuscate PowerShell scripts","2b77aa85-451b-f506-eda5-71bef0c2bfa6"
"Usage Of Web Request Commands And Cmdlets - ScriptBlock","medium","","ps_script","Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via PowerShell scriptblock logs","eddbf1d6-60c9-96f5-4cdf-f0947b3aad8f"
"Testing Usage of Uncommonly Used Port","medium","","ps_script","Adversaries may communicate using a protocol and port paring that are typically not associated.
For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443.
","629a73b6-b63c-b6d1-5e2c-5d7ee3042f44"
"Troubleshooting Pack Cmdlet Execution","medium","","ps_script","Detects execution of ""TroubleshootingPack"" cmdlets to leverage CVE-2022-30190 or action similar to ""msdt"" lolbin (as described in LOLBAS)","297f849b-2dff-ce76-be52-6f50e2f5d205"
"Suspicious SSL Connection","low","","ps_script","Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.","57e275e0-10cf-be8d-39b2-027fbfeb2913"
"Powershell Install a DLL in System Directory","high","","ps_script","Uses PowerShell to install/copy a file into a system directory such as ""System32"" or ""SysWOW64""","b16a0b26-d586-4ff7-f200-20927037e55f"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell Script","medium","","ps_script","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","7778d03c-e7bd-53bb-1f84-6557e3ecf12d"
"Suspicious Non PowerShell WSMAN COM Provider","medium","powershell-classic","","Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"Zip A Folder With PowerShell For Staging In Temp - PowerShell","medium","powershell-classic","","Detects PowerShell scripts that make use of the ""Compress-Archive"" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.
An adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.
","ee9681d0-6ba5-5eaf-9c8b-fe39afe542b9"
"Potential RemoteFXvGPUDisablement.EXE Abuse","high","powershell-classic","","Detects PowerShell module creation where the module Contents are set to ""function Get-VMRemoteFXPhysicalVideoAdapter"". This could be a sign of potential abuse of  the ""RemoteFXvGPUDisablement.exe"" binary which is known to be vulnerable to module load-order hijacking.","29a3935d-0428-4f39-d39e-ec43c598b272"
"Potential POWERTRASH Script Execution","high","","ps_script","Detects potential execution of the PowerShell script POWERTRASH","b8581aed-5481-addc-116b-c0b8384cecfc"
"Potential APT FIN7 POWERHOLD Execution","high","","ps_script","Detects execution of the POWERHOLD script seen used by FIN7 as reported by WithSecureLabs","384a6ce5-d681-2e87-6a43-6e1a0eb0f316"
"Lace Tempest PowerShell Launcher","high","","ps_script","Detects a PowerShell script used by Lace Tempest APT to launch their malware loader by exploiting CVE-2023-47246 as reported by SysAid Team
","47fec53e-ab09-f2b7-fc9a-c7364aefc12f"
"Lace Tempest PowerShell Evidence Eraser","high","","ps_script","Detects a PowerShell script used by Lace Tempest APT to erase evidence from victim servers by exploiting CVE-2023-47246 as reported by SysAid Team
","017266c4-7b12-7c2b-d2b3-0b8ffe973af8"
"Possible CVE-2021-1675 Print Spooler Exploitation","high","printservice-admin","","Detects events of driver load errors in print service logs that could be a sign of successful exploitation attempts of print spooler vulnerability CVE-2021-1675","5c10c39e-b9f6-d321-3598-62095b34b663"
"CVE-2021-1675 Print Spooler Exploitation","critical","printservice-operational","","Detects driver load events print service operational log that are a sign of successful exploitation attempts against print spooler vulnerability CVE-2021-1675","ae207e8e-3dfd-bd05-1161-e0472778f2be"
"NTLM Auth","informational","security","","Logged when NTLM authentication is used usually for local accounts but NTLM can also be used with domain accounts. The original event title says it is only generated on domain controllers but that is not true. This also gets logged on clients.","4fbe94b0-577a-4f77-9b13-250e27d440fa"
"Hacktool Ruler","high","security","","This events that are generated when using the hacktool Ruler by Sensepost","8b40829b-4556-9bec-a8ad-905688497639"
"Account Tampering - Suspicious Failed Logon Reasons","medium","security","","This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.","655eb351-553b-501f-186e-aa9af13ecf43"
"Metasploit SMB Authentication","high","security","","Alerts on Metasploit host's authentications on the domain.","827aa6c1-1507-3f0a-385a-ade5251bfd71"
"Valid Users Failing to Authenticate from Single Source Using NTLM","medium","security","","Detects failed logins with multiple valid domain accounts from a single source system using the NTLM protocol.","ddbbe639-21f9-7b39-ae7d-821e490d6130"
"Invalid Users Failing To Authenticate From Single Source Using NTLM","medium","security","","Detects failed logins with multiple invalid domain accounts from a single source system using the NTLM protocol.","bbd02091-a432-94b3-8041-9f776b681fc2"
"Failed NTLM Logins with Different Accounts from Single Source System","medium","security","","Detects suspicious failed logins with different user accounts from a single source system","203aaec0-5613-4fdc-42b3-a021d6f853dc"
"Kerberos TGT Requested","informational","security","","Prints logon information.","d9f336ea-bb16-4a35-8a9c-183216b8d59c"
"Possible AS-REP Roasting (RC4 Kerberos Ticket Req)","medium","security","","For each account found without preauthentication, an adversary may send an AS-REQ message without the encrypted timestamp and receive an AS-REP message with TGT data which may be encrypted with an insecure algorithm such as RC4.","dee2a01e-5d7c-45b4-aec3-ad9722f2165a"
"PetitPotam Suspicious Kerberos TGT Request","high","security","","Detect suspicious Kerberos TGT requests.
Once an attacer obtains a computer certificate by abusing Active Directory Certificate Services in combination with PetitPotam, the next step would be to leverage the certificate for malicious purposes.
One way of doing this is to request a Kerberos Ticket Granting Ticket using a tool like Rubeus.
This request will generate a 4768 event with some unusual fields depending on the environment.
This analytic will require tuning, we recommend filtering Account_Name to the Domain Controller computer accounts.
","cd01c787-aad1-bbed-5842-aa8e58410aad"
"Kerberos Manipulation","high","security","","Detects failed Kerberos TGT issue operation. This can be a sign of manipulations of TGT messages by an attacker.","978525c2-97aa-f0e4-8c11-3cf81ea3379b"
"Valid Users Failing to Authenticate From Single Source Using Kerberos","medium","security","","Detects multiple failed logins with multiple valid domain accounts from a single source system using the Kerberos protocol.","32ce2d24-3d1c-2f81-cddb-d64b33fe9247"
"Invalid Users Failing To Authenticate From Source Using Kerberos","medium","security","","Detects failed logins with multiple invalid domain accounts from a single source system using the Kerberos protocol.","74eaa0ee-05a7-86a5-a7a8-076952aa764d"
"Disabled Users Failing To Authenticate From Source Using Kerberos","medium","security","","Detects failed logins with multiple disabled domain accounts from a single source system using the Kerberos protocol.","c6c2c3e3-44ee-516c-9e48-63b304511787"
"Possible Kerberoasting (RC4 Kerberos Ticket Req)","medium","security","","Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to Brute Force.","f19849e7-b5ba-404b-a731-9b624d7f6d19"
"Kerberos Service Ticket Requested","informational","security","","Prints logon information.","da6257f3-cf49-464a-96fc-c84a7ce20636"
"Suspicious Kerberos RC4 Ticket Encryption","medium","security","","Detects service ticket requests using RC4 encryption type","2d20edf4-6141-35c5-e54f-3c578082d1d3"
"Kerberos Manipulation","high","security","","Detects failed Kerberos TGT issue operation. This can be a sign of manipulations of TGT messages by an attacker.","978525c2-97aa-f0e4-8c11-3cf81ea3379b"
"Kerberoasting Activity - Initial Query","medium","security","","This rule will collect the data needed to start looking into possible kerberoasting activity.
Further analysis or computation within the query is needed focusing on requests from one specific host/IP towards multiple service names within a time period of 5 seconds.
You can then set a threshold for the number of requests and time between the requests to turn this into an alert.
","4386b4e0-f268-42a6-b91d-e3bb768976d6"
"Computer Account Created","informational","security","","A computer account was created.","42a0a842-2b82-4b2d-8e44-5580fb6c38db"
"Potential Zerologon (CVE-2020-1472) Exploitation","high","security","","Detects potential Netlogon Elevation of Privilege Vulnerability aka Zerologon (CVE-2020-1472)","7d4b25c3-0cef-1638-1d47-bb18acda0e6c"
"Add or Remove Computer from DC","low","security","","Detects the creation or removal of a computer. Can be used to detect attacks such as DCShadow via the creation of a new SPN.","b607775d-e3fe-3fb8-c40e-4e52b3fbe44d"
"User Added To Local Admin Grp","high","security","","A user was added to the local Administrators group. Unfortunately the user name does not get recorded in the log, only the SID, so you need to look up the username via the SID.","611e2e76-a28f-4255-812c-eb8836b2f5bb"
"User Added To Global Security Grp","medium","security","","A user was added to a security-enabled global group. Global means the group can be granted access in any trusting domain but may only have members from its own domain. Subject user is the user that performed the action. Only logged on DCs.","0db443ba-561c-4a04-b349-d74ce1c5fc8b"
"User Added To Global Domain Admins Grp","high","security","","A user was added to the Domain Admins group. Only logged on DCs.","4bb89c86-a138-42a0-baaf-fc2f777a4506"
"User Added To Local Domain Admins Grp","high","security","","A user was added to the local Domain Admins group.","bc58e432-959f-464d-812e-d60ce5d46fa1"
"User Added To Non-Admin Global Grp","low","security","","User Added To Non-Admin Global Security Group. Only logged on DCs.","2f04e44e-1c79-4343-b4ab-ba670ee10aa0"
"A Member Was Added to a Security-Enabled Global Group","low","security","","Detects activity when a member is added to a security-enabled global group","26767093-828c-2f39-bdd8-d0439e87307c"
"A Security-Enabled Global Group Was Deleted","low","security","","Detects activity when a security-enabled global group is deleted","ae7d8d1c-f75b-d952-e84e-a7981b861590"
"A Member Was Removed From a Security-Enabled Global Group","low","security","","Detects activity when a member is removed from a security-enabled global group","6e0f860b-3678-7396-a4a3-7cf55f7bb01c"
"User Added to Local Administrator Group","medium","security","","Detects the addition of a new member to the local administrator group, which could be legitimate activity or a sign of privilege escalation activity","6695d6a2-9365-ee87-ccdd-966b0e1cdbd4"
"Group Modification Logging","low","security","","Configure systems to issue a log entry and alert when an account is added to or removed from any group assigned administrative privileges.
Sigma detects
Event ID 4728 indicates a ""Member is added to a Security Group"".
Event ID 4729 indicates a ""Member is removed from a Security enabled-group"".
Event ID 4730 indicates a ""Security Group is deleted"".
The case is not applicable for Unix OS.
Supported OS - Windows 2008 R2 and 7, Windows 2012 R2 and 8.1, Windows 2016 and 10 Windows Server 2019, Windows Server 2000, Windows 2003 and XP.
","506379d9-8545-c010-e9a3-693119ab9261"
"Potential Exploitation of CVE-2024-37085 - Suspicious ESX Admins Group Activity","high","security","","Detects any creation or modification to a windows domain group with the name ""ESX Admins"".
This could indicates a potential exploitation attempt of CVE-2024-37085, which allows an attacker to elevate their privileges to full administrative access on an domain-joined ESXi hypervisor.
VMware ESXi hypervisors joined to an Active Directory domain consider any member of a domain group named ""ESX Admins"" to have full administrative access by default.
","2a451b93-9890-5cfe-38aa-1dc4f8f0fe0a"
"Operation Wocao Activity - Security","high","security","","Detects activity mentioned in Operation Wocao report","c9b5cb6f-906f-3a15-b77e-1b634b1d4e55"
"Password Reset By Admin","medium","security","","A user accounts password was changed by another account. The current password is not required to reset the password. An adversary might change the password of another account to lock out legitimate users or gain access to the account. This could be done if the account controlled by the attacker has permission to change the password, or as a step in attacks like Pass the Cert.","0b78aca4-35f0-4bec-acce-c5743ff26614"
"Hidden User Account Created","high","security","","A computer account (an account that ends with a $) was created. These accounts are not displayed by default so will be hidden.","70b8b1bd-c107-4b1a-8b1e-5b0f9f57930a"
"User Password Changed","medium","security","","A user account changed it's own password. Adversaries might change the password to lockout legitimate user or set the password to a known clear text passwort via Pass the Hash if only the password hash is known. This will allow an adversary to access services where Pass the Hash is not an option.","3b3046f3-a51c-4378-b059-c716aaa865b4"
"Local User Account Created","low","security","","A local user account was created.","13edce80-2b02-4469-8de4-a3e37271dcdb"
"Weak Encryption Enabled and Kerberoast","high","security","","Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.","2ea71437-cb4d-5a41-2431-1773fce76de8"
"Hidden Local User Creation","high","security","","Detects the creation of a local hidden user account which should not happen for event ID 4720.","23013005-3d59-4dbe-dabd-d17a54e6c6cf"
"Password Change on Directory Service Restore Mode (DSRM) Account","high","security","","Detects potential attempts made to set the Directory Services Restore Mode administrator password.
The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers.
Attackers may change the password in order to obtain persistence.
","4592ea29-1b0e-0cc3-7735-b7f264c0a5b8"
"Suspicious Windows ANONYMOUS LOGON Local Account Created","high","security","","Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.","e5c627ea-fa27-df99-0573-e47092dc4a98"
"Addition of SID History to Active Directory Object","medium","security","","An attacker can use the SID history attribute to gain additional privileges.","5335aea0-f1b4-e120-08b6-c80fe4bf99ad"
"Local User Creation","low","security","","Detects local user creation on Windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your Windows server logs and not on your DC logs.
","5ecd226b-563f-4723-7a1e-d637d81f0a1f"
"New or Renamed User Account with '$' Character","medium","security","","Detects the creation of a user with the ""$"" character. This can be used by attackers to hide a user or trick detection systems that lack the parsing mechanisms.
","ec77919c-1169-6640-23e7-91c6f27ddc91"
"Suspicious Computer Account Name Change CVE-2021-42287","high","security","","Detects the renaming of an existing computer account to a account name that doesn't contain a $ symbol as seen in attacks against CVE-2021-42287","17662114-5bee-2566-359c-68d830193830"
"AD Object WriteDAC Access","critical","security","","Detects WRITE_DAC access to a domain object","09c08048-5eab-303f-dfe3-706a6052b6f9"
"Active Directory Replication from Non Machine Account","critical","security","","Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.","5c8e2537-5c7f-56d8-de80-1f0746b61067"
"WMI Persistence - Security","medium","security","","Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs.","ec2275df-3a0a-933f-0573-490938cc47ef"
"Potential AD User Enumeration From Non-Machine Account","medium","security","","Detects read access to a domain user from a non-machine account","fe814c5a-505f-a313-7d8c-030187c24e8e"
"Mimikatz DC Sync","high","security","","Detects Mimikatz DC sync security events","daad2203-665f-294c-6d2f-f9272c3214f2"
"DPAPI Domain Backup Key Extraction","high","security","","Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers","c42c534d-16ae-877f-0722-6d6914090855"
"Failed Logon - Non-Existent User","medium","security","","Detects a failed logon event due to an incorrect username","b2c74582-0d44-49fe-8faa-014dcdafee62"
"Logon Failure (User Does Not Exist)","low","security","","Prints failed logons","8afa97ce-a217-4f7c-aced-3e320a57756d"
"Failed Logon - Incorrect Password","medium","security","","Detects a failed logon event due to a wrong password","5b0b75dc-9190-4047-b9a8-14164cee8a31"
"Logon Failure (Unknown Reason)","low","security","","Prints logon information.","a85096da-be85-48d7-8ad5-2f957cd74daa"
"Logon Failure (Wrong Password)","low","security","","Prints logon information.","e87bd730-df45-4ae9-85de-6c75369c5d29"
"PW Guessing","medium","security","","Search for many 4625 wrong password failed logon attempts in a short period of time.","35e8a0fc-60c2-46d7-ba39-aafb15b9854e"
"User Guessing","medium","security","","Search for many 4625 failed logon attempts due to wrong usernames in a short period of time.","4574194d-e7ca-4356-a95c-21b753a1787e"
"Potential Pass the Hash Activity","medium","security","","Detects the attack technique pass the hash which is used to move laterally inside the network","35890fd4-9ed3-b244-0eff-91fe61e52f8b"
"Interactive Logon to Server Systems","medium","security","","Detects interactive console logons to Server Systems","7298c707-7564-3229-7c76-ec514847d8c2"
"Hacktool Ruler","high","security","","This events that are generated when using the hacktool Ruler by Sensepost","8b40829b-4556-9bec-a8ad-905688497639"
"Account Tampering - Suspicious Failed Logon Reasons","medium","security","","This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.","655eb351-553b-501f-186e-aa9af13ecf43"
"Failed Logon From Public IP","medium","security","","Detects a failed logon attempt from a public IP. A login from a public IP can indicate a misconfigured firewall or network boundary.","6bcac9cb-eeee-9f45-c5c1-0daaf023ac12"
"Scanner PoC for CVE-2019-0708 RDP RCE Vuln","high","security","","Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep","232ecd79-c09d-1323-8e7e-14322b766855"
"Metasploit SMB Authentication","high","security","","Alerts on Metasploit host's authentications on the domain.","827aa6c1-1507-3f0a-385a-ade5251bfd71"
"Multiple Users Failing to Authenticate from Single Process","medium","security","","Detects failed logins with multiple accounts from a single process on the system.","84202b5b-54c1-473b-4568-e10da23b3eb8"
"Failed Logins with Different Accounts from Single Source System","medium","security","","Detects suspicious failed logins with different user accounts from a single source system","428d3964-3241-1ceb-8f93-b31d8490c822"
"Multiple Users Remotely Failing To Authenticate From Single Source","medium","security","","Detects a source system failing to authenticate against a remote host with multiple users.","30e70d43-6368-123c-a3c8-d23309a3ff97"
"Logoff","informational","security","","Prints logon information.","7309e070-56b9-408b-a2f4-f1840f8f1ebf"
"Logoff (User Initiated)","informational","security","","Prints logon information.","6bad16f1-02c4-4075-b414-3cd16944bc65"
"Logoff (Noisy)","informational","security","","Prints logon information.","84288799-8b61-4d98-bad0-4043c40cf992"
"User Logoff Event","informational","security","","Detects a user log-off activity. Could be used for example to correlate information during forensic investigations","73f64ce7-a76d-0208-ea75-dd26a09d719b"
"Logon (Unlock)","informational","security","","Prints logon information","b61bfa39-48ec-4bdf-9d4e-e7205f49acd2"
"Failed Logon - Non-Existent User","medium","security","","Detects a failed logon event due to an incorrect username","b2c74582-0d44-49fe-8faa-014dcdafee62"
"NewInteractive Logon (Suspicious Process)","medium","security","","Tries to detect token impersonation by tools like Cobalt Strike.","9e8b6cdb-9991-488b-a7b3-2eec7aa64679"
"Logon (System) - Bootup","informational","security","","The logon event happens when the computer boots up.","9fa273cc-bcb2-4789-85e3-14ca253ac7f4"
"Logon Failure (User Does Not Exist)","low","security","","Prints failed logons","8afa97ce-a217-4f7c-aced-3e320a57756d"
"Logon (Service)","informational","security","","Prints logon type 5 service logons.","408e1304-51d7-4d3e-ab31-afd07192400b"
"Failed Logon - Incorrect Password","medium","security","","Detects a failed logon event due to a wrong password","5b0b75dc-9190-4047-b9a8-14164cee8a31"
"Explicit Logon Attempt","informational","security","","(From ultimatewindowsecurity.com)
This log is generated when
1. A user connects to a server or runs a program locally using alternate credentials.
   For instance a user maps a drive to a server but specifies a different user's credentials or opens a shortcut under RunAs by shift-control-right-clicking on the shortcut,
   selecting Run as..., and then filling in a different user's credentials in the dialog box that appears.  Or a user logs on to a web site using new specific credentials.
2. When a process logs on as a different account such as when the Scheduled Tasks service starts a task as the specified user.
3. With User Account Control enabled, an end user runs a program requiring admin authority.  You will get this event where the process information is consent.exe.
   Unfortunately the Subject does not identify the end user.
4. Logging on interactively to a server with a domain account. (Two 4624 events will also be generated.)
This logon event is unique in that it is logged on the source computer and not the target computer like most other logon events.
Also, it will be logged regardless of the logon being successful or not so consider it an attempt and not necessarily an actual successful logon.
","8c1899fe-493d-4faf-aae1-0853a33a3278"
"Logon (RemoteInteractive (RDP)) *Creds in memory*","informational","security","","Type 10 logons can be dangerous as the credentials (plaintext or hashed passwords) are stored in memory (lsass process) and can be stolen by tools like mimikatz.","a4e05f05-ff88-48b9-8524-a88c1c32fe19"
"Logon (Interactive) (Noisy)","informational","security","","This is filtered by default as it is usually system noise.","b1782e40-d247-4de1-86d1-37392cb62e3b"
"Logon (Network) (Noisy)","informational","security","","Outputs system noise","0266af4f-8825-495e-959c-bff801094349"
"Possible Token Impersonation","medium","security","","Tries to detect token impersonation by tools like Cobalt Strike.","46614e82-7926-41f9-85aa-006b98c5c2a3"
"PW Spray","medium","security","","Search for many 4648 explicit credential logon attempts in a short period of time.","ffd622af-d049-449f-af5a-0492fdcc3a58"
"Logon (NewCredentials) *Creds in memory*","informational","security","","Type 9 logons can be dangerous as the credentials (plaintext or hashed passwords) are stored in memory (lsass process) and can be stolen by tools like mimikatz.","d80facaa-ca97-47bb-aed2-66362416eb49"
"Logon Failure (Unknown Reason)","low","security","","Prints logon information.","a85096da-be85-48d7-8ad5-2f957cd74daa"
"Logon Failure (Wrong Password)","low","security","","Prints logon information.","e87bd730-df45-4ae9-85de-6c75369c5d29"
"Logon (CachedRemoteInteractive) *Creds in memory*","informational","security","","Type 12 logons can be dangerous as the credentials (plaintext or hashed passwords) are stored in memory (lsass process) and can be stolen by tools like mimikatz.","f4b46dd3-63d6-4c75-a54c-9f6bd095cd6f"
"Explicit Logon Attempt (Noisy)","informational","security","","(From ultimatewindowsecurity.com)
This log is generated when
1. A user connects to a server or runs a program locally using alternate credentials.
   For instance a user maps a drive to a server but specifies a different user's credentials or opens a shortcut under RunAs by shift-control-right-clicking on the shortcut,
   selecting Run as..., and then filling in a different user's credentials in the dialog box that appears.  Or a user logs on to a web site using new specific credentials.
2. When a process logs on as a different account such as when the Scheduled Tasks service starts a task as the specified user.
3. With User Account Control enabled, an end user runs a program requiring admin authority.  You will get this event where the process information is consent.exe.
   Unfortunately the Subject does not identify the end user.
4. Logging on interactively to a server with a domain account. (Two 4624 events will also be generated.)
This logon event is unique in that it is logged on the source computer and not the target computer like most other logon events.
Also, it will be logged regardless of the logon being successful or not so consider it an attempt and not necessarily an actual successful logon.
","a5b3ebf0-141a-4264-b2ff-400c0d515fca"
"PW Guessing","medium","security","","Search for many 4625 wrong password failed logon attempts in a short period of time.","35e8a0fc-60c2-46d7-ba39-aafb15b9854e"
"Logon (CachedUnlock) *Creds in memory*","informational","security","","Type 13 logons can be dangerous as the credentials (plaintext or hashed passwords) are stored in memory (lsass process) and can be stolen by tools like mimikatz.","e50e3952-06d9-44a8-ab07-7a41c9801d78"
"User Guessing","medium","security","","Search for many 4625 failed logon attempts due to wrong usernames in a short period of time.","4574194d-e7ca-4356-a95c-21b753a1787e"
"Logon (CachedInteractive) *Creds in memory*","informational","security","","Type 11 Interactive logons can be dangerous as the credentials (plaintext or hashed passwords) are stored in memory (lsass process) and can be stolen by tools like mimikatz.","fbbe9d3f-ed1f-49a9-9446-726e349f5fba"
"Logon (NetworkCleartext)","informational","security","","Prints logon information. Despite the naming NetworkCleartext, the password is not sent over the network in cleartext. It is usually for IIS Basic Authentication.","7ff51227-6a10-49e6-a58b-b9f4ac32b138"
"Logon (Network)","informational","security","","Prints logon information","c7b22878-e5d8-4c30-b245-e51fd354359e"
"Explicit Logon Attempt (Susp Proc) - Possible Mimikatz PrivEsc","high","security","","Detects explicit credential logons with suspicous processes like powershell and wmic which are often abused by malware like Cobalt Strike or Mimikatz for user impersonation.","7616e857-8e41-4976-bc21-811d122b9fc9"
"Logon (Service) (Noisy)","informational","security","","System Noise","84e5ff02-5f8f-48c4-a7e9-88aa1fb888f7"
"Logon (Batch)","informational","security","","Prints logon information","8ad8b25f-6052-4cfd-9a50-717cb514af13"
"Logon (Interactive) *Creds in memory*","informational","security","","Type 2 Interactive logons can be dangerous as the credentials (plaintext or hashed passwords) are stored in memory (lsass process) and can be stolen by tools like mimikatz.","7beb4832-f357-47a4-afd8-803d69a5c85c"
"Failed Logon - Incorrect Password","medium","security","","Detects a failed logon event due to a wrong password","ab1accc0-b6e2-4841-8dfb-5902581392c3"
"Potential Pass the Hash Activity","medium","security","","Detects the attack technique pass the hash which is used to move laterally inside the network","35890fd4-9ed3-b244-0eff-91fe61e52f8b"
"Interactive Logon to Server Systems","medium","security","","Detects interactive console logons to Server Systems","7298c707-7564-3229-7c76-ec514847d8c2"
"Potential Remote WMI ActiveScriptEventConsumers Activity","medium","security","","Detect potential adversaries leveraging WMI ActiveScriptEventConsumers remotely to move laterally in a network.
This event is best correlated and used as an enrichment to determine the potential lateral movement activity.
","910ec16d-6957-01b7-39a8-5e676e459cac"
"Hacktool Ruler","high","security","","This events that are generated when using the hacktool Ruler by Sensepost","8b40829b-4556-9bec-a8ad-905688497639"
"Account Tampering - Suspicious Failed Logon Reasons","medium","security","","This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.","655eb351-553b-501f-186e-aa9af13ecf43"
"Failed Logon From Public IP","medium","security","","Detects a failed logon attempt from a public IP. A login from a public IP can indicate a misconfigured firewall or network boundary.","6bcac9cb-eeee-9f45-c5c1-0daaf023ac12"
"Successful Overpass the Hash Attempt","high","security","","Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.","20f4e87b-c272-42da-9a1f-ad54206e3622"
"External Remote RDP Logon from Public IP","medium","security","","Detects successful logon from public IP address via RDP. This can indicate a publicly-exposed RDP port.","56a1bb6f-e039-3f65-3ea0-de425cefa8a7"
"RottenPotato Like Attack Pattern","high","security","","Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like","a1f9fad3-d563-5f3f-de09-e4ca03b97522"
"Outgoing Logon with New Credentials","low","security","","Detects logon events that specify new credentials","897e25ba-f935-3fd3-c6d5-f9abf379e831"
"Potential Privilege Escalation via Local Kerberos Relay over LDAP","high","security","","Detects a suspicious local successful logon event where the Logon Package is Kerberos, the remote address is set to localhost, and the target user SID is the built-in local Administrator account.
This may indicate an attempt to leverage a Kerberos relay attack variant that can be used to elevate privilege locally from a domain joined limited user to local System privileges.
","96896e3a-28de-da11-c7fd-0040868e3a2f"
"DiagTrackEoP Default Login Username","critical","security","","Detects the default ""UserName"" used by the DiagTrackEoP POC","dd648614-9dd8-fab8-92d6-be7dfa1b393c"
"Potential Access Token Abuse","medium","security","","Detects potential token impersonation and theft. Example, when using ""DuplicateToken(Ex)"" and ""ImpersonateLoggedOnUser"" with the ""LOGON32_LOGON_NEW_CREDENTIALS flag"".","e8c130a4-cf04-543d-919b-76947bde76b8"
"Scanner PoC for CVE-2019-0708 RDP RCE Vuln","high","security","","Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep","232ecd79-c09d-1323-8e7e-14322b766855"
"Admin User Remote Logon","low","security","","Detect remote login by Administrator user (depending on internal pattern).","de5d0dd7-b73e-7f18-02b0-6b1acb7e9f52"
"Successful Account Login Via WMI","low","security","","Detects successful logon attempts performed with WMI","c310cab1-252e-1d98-6b6f-e6e60c88a374"
"RDP Login from Localhost","high","security","","RDP login with localhost source address may be a tunnelled login","b3f33f69-1331-d3d0-eb62-81f477abad86"
"External Remote SMB Logon from Public IP","high","security","","Detects successful logon from public IP address via SMB. This can indicate a publicly-exposed SMB port.","5c67a566-7829-eb05-4a1f-0eb292ef993f"
"Pass the Hash Activity 2","medium","security","","Detects the attack technique pass the hash which is used to move laterally inside the network","059e7255-411c-1666-a2e5-2e99e294e614"
"Suspicious Remote Logon with Explicit Credentials","medium","security","","Detects suspicious processes logging on with explicit credentials","250cf413-1d30-38fd-4b41-ae5a92452700"
"Metasploit SMB Authentication","high","security","","Alerts on Metasploit host's authentications on the domain.","827aa6c1-1507-3f0a-385a-ade5251bfd71"
"Multiple Users Failing to Authenticate from Single Process","medium","security","","Detects failed logins with multiple accounts from a single process on the system.","84202b5b-54c1-473b-4568-e10da23b3eb8"
"Password Spraying via Explicit Credentials","medium","security","","Detects a single user failing to authenticate to multiple users using explicit credentials.","27124590-ab3f-79b8-7dfa-b82820dbb1cc"
"Failed Logins with Different Accounts from Single Source System","medium","security","","Detects suspicious failed logins with different user accounts from a single source system","428d3964-3241-1ceb-8f93-b31d8490c822"
"Multiple Users Remotely Failing To Authenticate From Single Source","medium","security","","Detects a source system failing to authenticate against a remote host with multiple users.","30e70d43-6368-123c-a3c8-d23309a3ff97"
"Admin Logon","informational","security","","Originally ""Special privileges assigned to new logon"". This will create a seperate LID that is used when special admin-level privileges are used.","fdd0b325-8b89-469c-8b0c-e5ddfe39b62e"
"User with Privileges Logon","low","security","","Detects logon with ""Special groups"" and ""Special Privileges"" can be thought of as Administrator groups or privileges.","b3d10465-f171-0ef7-d28e-8ef2f9409cf1"
"Important Windows Event Auditing Disabled","high","security","","Detects scenarios where system auditing for important events such as ""Process Creation"" or ""Logon"" events is disabled.","5fa54162-0bc4-710e-5dec-7ccc99ee4d52"
"VSSAudit Security Event Source Registration","informational","security","","Detects the registration of the security event source VSSAudit. It would usually trigger when volume shadow copy operations happen.","00f253a0-1035-e450-7f6e-e2291dee27ec"
"Windows Event Auditing Disabled","low","security","","Detects scenarios where system auditing (i.e.: Windows event log auditing) is disabled.
This may be used in a scenario where an entity would want to bypass local logging to evade detection when Windows event logging is enabled and reviewed.
Also, it is recommended to turn off ""Local Group Policy Object Processing"" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as ""gpedit.msc"".
Please note, that disabling ""Local Group Policy Object Processing"" may cause an issue in scenarios of one off specific GPO modifications - however, it is recommended to perform these modifications in Active Directory anyways.
","83d7b3c2-220e-60e8-4aad-98e206e841ba"
"A New Trust Was Created To A Domain","medium","security","","Addition of domains is seldom and should be verified for legitimacy.","5a3e5a2f-bdf8-d6d0-f439-5543b54d5ba5"
"Unauthorized System Time Modification","low","security","","Detect scenarios where a potentially unauthorized application or user is modifying the system time.","1085e6d3-6691-5713-42ba-ba8933a6b2d0"
"Code Integrity Error (Invalid Image Page Hash)","low","security","","Detects when hashes are not correct or a file does not meet Windows' security requirements.","d4757f63-cc0e-448e-8b5b-6cb02aeb918a"
"Code Integrity Error (Invalid Image Hash)","low","security","","Detects when hashes are not correct or a file does not meet Windows' security requirements.","0c871345-668e-4b71-bdad-61e42ecc31e3"
"Code Integrity Proble (Possible Modification)","low","security","","Detects when hashes are not correct or a file does not meet Windows' security requirements.","c2eb9d20-ef9d-4b2d-bffe-d0a5d9616f30"
"Failed Code Integrity Checks","informational","security","","Detects code integrity failures such as missing page hashes or corrupted drivers due unauthorized modification. This could be a sign of tampered binaries.
","4f738466-2a14-5842-1eb3-481614770a49"
"Unsigned Binary Loaded From Suspicious Location","high","security-mitigations","","Detects Code Integrity (CI) engine blocking processes from loading unsigned DLLs residing in suspicious locations","15277aa1-7b5b-9e3b-cca8-52c21a36d06c"
"Microsoft Defender Blocked from Loading Unsigned DLL","high","security-mitigations","","Detects Code Integrity (CI) engine blocking Microsoft Defender's processes (MpCmdRun and NisSrv) from loading unsigned DLLs which may be an attempt to sideload arbitrary DLL","838d17f1-63ba-03c4-f8ae-2bdfd74a6a08"
"Unsigned Binary Loaded From Suspicious Location","high","security-mitigations","","Detects Code Integrity (CI) engine blocking processes from loading unsigned DLLs residing in suspicious locations","15277aa1-7b5b-9e3b-cca8-52c21a36d06c"
"Microsoft Defender Blocked from Loading Unsigned DLL","high","security-mitigations","","Detects Code Integrity (CI) engine blocking Microsoft Defender's processes (MpCmdRun and NisSrv) from loading unsigned DLLs which may be an attempt to sideload arbitrary DLL","838d17f1-63ba-03c4-f8ae-2bdfd74a6a08"
"Suspicious Rejected SMB Guest Logon From IP","medium","smbclient-security","","Detect Attempt PrintNightmare (CVE-2021-1675) Remote code execution in Windows Spooler Service","610c6a10-ca67-69c5-0f6d-761487fb3b37"
"Failed Mounting of Hidden Share","medium","smbclient-security","","Detects repeated failed (outgoing) attempts to mount a hidden share","624e39e1-5bc5-13fe-0b2d-5d988a416f24"
"Unexpected Shutdown","low","system","","The shutdown operation is initiated automatically by a program that uses the InitiateSystemShutdownEx function with the force flag.","517c0b15-d2bf-48a3-926c-f7b4a96dcec3"
"Event Log Service Startup Type Changed To Disabled","medium","system","","","ab3507cf-5231-4af6-ab1d-5d3b3ad467b5"
"New Non-USB PnP Device","informational","system","","Logs only the first time a device has been plugged in.","9eaea7e6-6567-4ad0-bcc9-fe568dd27909"
"Possible Metasploit Svc Installed","medium","system","","","76355548-fa5a-4310-9610-0de4b11f4688"
"Log File Cleared","medium","system","","Somebody cleared an imporant event log.","ed90ed4f-0d93-4f1a-99a2-4b9003b750a7"
"Event Log Svc Started","informational","system","","Startup, restarting the event log service, etc...","11dc7d25-01c9-4b07-9d91-8e07b60d8fd3"
"Service Crashed","low","system","","","f5dc6a6d-fdf1-441a-a10c-aa10e2908aa4"
"Computer Startup","informational","system","","The system has booted up. It also contains information about the OS version even though this information is not present in the event message. You can tell if the system was started up normally or in safe mode depending on the value of the BootMode. 0 for normal boot. 1 for Safe Mode. 2 for Safe Mode with networking.","a225cc36-bfdc-4e7a-ad01-f544b90e2d2a"
"Service Crashed","low","system","","","d869bf31-92b3-4e21-a447-708f10156e7c"
"Suspicious Service Name","high","system","","Tries to look for random-looking service names that are often used by malware for persistence.","cc429813-21db-4019-b520-2f19648e1ef1"
"Important Log File Cleared","high","system","","Somebody cleared an imporant event log.","f481a1f3-969e-4187-b3a5-b47c272bfebd"
"New USB PnP Device","informational","system","","Logs only the first time a device has been plugged in.","f5c0b936-bec8-418a-a79a-89833468fea2"
"Computer Startup In Safe Mode","medium","system","","The system has booted up. It also contains information about the OS version even though this information is not present in the event message. You can tell if the system was started up normally or in safe mode depending on the value of the BootMode. 0 for normal boot. 1 for Safe Mode. 2 for Safe Mode with networking.","8da41a05-364b-4e3c-95d9-397abb82eac4"
"Event Log Svc Stopped","informational","system","","Shutdown, reboot, event log service stopped, etc...","b6d53116-36b2-4413-a99b-e6708f9c3027"
"Suspicious Service Path","high","system","","Malware will often create services for persistence and use BASE64 encoded strings to execute malicious code or abuse legitimate binaries like cmd.exe, powershell, etc... inside the path to execute. Normally, services will not run built-in binaries, run from user or temp folders or contain encoded data.","dbbfd9f3-9508-478b-887e-03ddb9236909"
"Computer Uptime/Timezone","informational","system","","This is an event that shows the computer uptime.This event is important because it also contains the OS timezone information.
","982fdd1f-38fe-4243-bea3-6032fc01b723"
"PSExec Lateral Movement","high","system","","PSExec is a MS SysInternals tool often abused for lateral movement.","0694c340-3a46-40ac-acfc-c3444ae6572c"
"Computer Startup","informational","system","","The computer started up. This event is important because it also contains the OS version information.
%Data[3]% contains the Service Pack name (Ex: Service Pack 1) for Windows 7 systems but can be infered from the build number so is left out.
%Data[4]% contains processor license information (Ex: Multiprocessor Free) but is not so useful so is left out.
%Data[5]% contains the Revision (a.k.a. Update Version) Number in Windows 7 logs.
Windows 10+ seems to always output 0 for this so it is not a reliable source for identifying the Revision Number.
","b27292f1a-18b3-4433-b340-151874a7d4e8"
"BSOD","medium","system","","Blue Screen Of Death. MS calls these Bug Check Errors.
param1 will contain various error codes for debugging:
example: 0x0000009f (0x0000000000000003, 0xffffe682fdfaf570, 0xfffff800666c4750, 0xffffe6831844f050)
    - 0x0000009f is the Bug Check Code (a.k.a. Stop Code) meaning DRIVER_POWER_STATE_FAILURE
    - 0x0000000000000003 indicates the type of inconsistency. In this case, 0x3 means the system is transitioning from a sleep state (S4 or S5) to an awake state (S0).
    - 0xffffe682fdfaf570 is a pointer to the DEVICE_OBJECT structure representing the device that is being enumerated.
    - 0xfffff800666c4750 is a pointer to the IRP (I/O Request Packet) that was pending for the device object.
    - 0xffffe6831844f050 is a pointer to the NTSTATUS code indicating the cause of the failure.
param2 is the path to a memory dump (ex: C:\WINDOWS\MEMORY.DMP)
param3 is the report ID (ex: cf65ecb3-8a81-4a04-89ae-8d1fff1aecf8)
","082fbbf5-bb05-468c-ad9c-ef2a383bb293"
"Svc Installed","informational","system","","A new service was installed. (Possibly malware.)","64c5d39d-10a7-44f4-b5d6-fd0d93d0a69f"
"New Service Uses Double Ampersand in Path","high","system","","Detects a service installation that uses a suspicious double ampersand used in the image path value","22b90bac-a283-6153-761c-7b6059f8f250"
"SAM Dump to AppData","high","system","","Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers","f224a2b6-2db1-a1a2-42d4-25df0c460915"
"Volume Shadow Copy Mount","low","system","","Detects volume shadow copy mount via Windows event log","15b42b84-becb-a48c-8971-28895065fbd3"
"Potential RDP Exploit CVE-2019-0708","medium","system","","Detect suspicious error on protocol RDP, potential CVE-2019-0708","19979e7a-7d1e-a8e3-2a9e-9b3ac0059fa7"
"NTFS Vulnerability Exploitation","high","system","","This the exploitation of a NTFS vulnerability as reported without many details via Twitter","73b6342c-c17a-d447-2fd3-119ed3cf61ca"
"CobaltStrike Service Installations - System","critical","system","","Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement","51ba8477-86a4-6ff0-35fa-7b7f1b1e3f83"
"Important Windows Service Terminated With Error","high","system","","Detects important or interesting Windows services that got terminated for whatever reason","bf2272c8-bc92-d925-4fb6-aeb1fe9283aa"
"Service Installation in Suspicious Folder","medium","system","","Detects service installation in suspicious folder appdata","60ddd708-71a3-e524-27b1-4cdeda02ce46"
"Remote Access Tool Services Have Been Installed - System","medium","system","","Detects service installation of different remote access tools software. These software are often abused by threat actors to perform","cd1c0081-d0c8-369f-2ed1-dcc058b08b9c"
"PAExec Service Installation","medium","system","","Detects PAExec service installation","19b4e2a1-4499-8c65-e93a-5f675df202d8"
"Moriya Rootkit - System","critical","system","","Detects the use of Moriya rootkit as described in the securelist's Operation TunnelSnake report","7ca6e518-decb-de46-861e-5673c026b257"
"RemCom Service Installation","medium","system","","Detects RemCom service installation and execution events","1ae1cb63-2c82-d95d-a200-533f229715b2"
"CSExec Service Installation","medium","system","","Detects CSExec service installation and execution events","efef064b-d350-a96b-fe1e-ef4cfe657066"
"Invoke-Obfuscation CLIP+ Launcher - System","high","system","","Detects Obfuscated use of Clip.exe to execute PowerShell","414e0fbd-67a8-17e4-371e-4f9f6a8799d0"
"PsExec Service Installation","medium","system","","Detects PsExec service installation and execution events","cb7a40d5-f1de-9dd4-465d-eada7e316d8f"
"Invoke-Obfuscation Via Use MSHTA - System","high","system","","Detects Obfuscated Powershell via use MSHTA in Scripts","e0aa759a-fa97-fb3b-1b02-82aa44f8c068"
"Windows Defender Threat Detection Service Disabled","medium","system","","Detects when the ""Windows Defender Threat Protection"" service is disabled.","07c5c883-1da4-d066-f69b-6caadbd1d6f9"
"HackTool Service Registration or Execution","high","system","","Detects installation or execution of services","fde28f27-a4fa-d3a4-a714-0ef2dfacb36c"
"New PDQDeploy Service - Client Side","medium","system","","Detects PDQDeploy service installation on the target system.
When a package is deployed via PDQDeploy it installs a remote service on the target machine with the name ""PDQDeployRunner-X"" where ""X"" is an integer starting from 1
","c5b232f5-bd0a-c0ea-585f-c54fbe370580"
"Service Installed By Unusual Client - System","high","system","","Detects a service installed by a client which has PID 0 or whose parent has PID 0","97b97d4d-e03c-ace5-3215-fa2f51ec5fd5"
"RTCore Suspicious Service Installation","high","system","","Detects the installation of RTCore service. Which could be an indication of Micro-Star MSI Afterburner vulnerable driver abuse","6218888e-3b1f-f6be-b9f8-9fd758caa380"
"Uncommon Service Installation Image Path","medium","system","","Detects uncommon service installation commands by looking at suspicious or uncommon image path values containing references to encoded powershell commands, temporary paths, etc.
","4de4ea24-8c0c-75ed-78c3-bf620ec06fd5"
"Invoke-Obfuscation Via Use Rundll32 - System","high","system","","Detects Obfuscated Powershell via use Rundll32 in Scripts","f1988b01-7f12-1851-58b5-8a4d63743183"
"Tap Driver Installation","medium","system","","Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques","6cda0359-f921-911b-a724-cc2f00d661f8"
"Invoke-Obfuscation COMPRESS OBFUSCATION - System","medium","system","","Detects Obfuscated Powershell via COMPRESS OBFUSCATION","6623b0c3-f904-2d2e-9c24-4cbb81bf55aa"
"Suspicious Service Installation Script","high","system","","Detects suspicious service installation scripts","778c7f2b-32f5-e591-5c4a-01e47388475c"
"NetSupport Manager Service Install","medium","system","","Detects NetSupport Manager service installation on the target system.","ee415dc3-b7c0-9568-e6dd-878777ff237a"
"Invoke-Obfuscation STDIN+ Launcher - System","high","system","","Detects Obfuscated use of stdin to execute PowerShell","9d5e9ea9-180b-0d92-6e5a-645275e94267"
"Credential Dumping Tools Service Execution - System","high","system","","Detects well-known credential dumping tools execution via service execution events","81562732-3278-cd48-1db2-581bc7158b6e"
"Service Installation with Suspicious Folder Pattern","high","system","","Detects service installation with suspicious folder patterns","1702910b-83b9-ce95-4ae8-2405c2e9faf7"
"Invoke-Obfuscation VAR+ Launcher - System","high","system","","Detects Obfuscated use of Environment Variables to execute PowerShell","19adbb05-25d8-44fe-3721-1590be735426"
"Invoke-Obfuscation Obfuscated IEX Invocation - System","high","system","","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block linked in the references","af2b45c1-ed61-0866-791a-13ae39ff80c3"
"Invoke-Obfuscation Via Stdin - System","high","system","","Detects Obfuscated Powershell via Stdin in Scripts","8aef41c8-fc2b-f490-5a9b-a683fe107829"
"Invoke-Obfuscation RUNDLL LAUNCHER - System","medium","system","","Detects Obfuscated Powershell via RUNDLL LAUNCHER","686d9481-474f-2b85-7c51-e69967c1afcc"
"KrbRelayUp Service Installation","high","system","","Detects service creation from KrbRelayUp tool used for privilege escalation in Windows domain environments where LDAP signing is not enforced (the default settings)","8623dcbf-e828-afb3-eb29-42cade82b39a"
"Remote Utilities Host Service Install","medium","system","","Detects Remote Utilities Host service installation on the target system.","97bd461f-b35e-a243-c697-06cc0539d7e3"
"New PDQDeploy Service - Server Side","medium","system","","Detects a PDQDeploy service installation which indicates that PDQDeploy was installed on the machines.
PDQDeploy can be abused by attackers to remotely install packages or execute commands on target machines
","8682ea60-89d6-e616-7cdd-410a05ed1611"
"ProcessHacker Privilege Elevation","high","system","","Detects a ProcessHacker tool that elevated privileges to a very high level","9e870183-fbbc-e736-c380-d20bd74d7dbe"
"PowerShell Scripts Installed as Services","high","system","","Detects powershell script installed as a Service","be1b026a-db82-4f10-0739-68c60f1261c9"
"Anydesk Remote Access Software Service Installation","medium","system","","Detects the installation of the anydesk software service. Which could be an indication of anydesk abuse if you the software isn't already used.","87d5cdc0-24c5-8411-1230-d717dd6a47e8"
"Invoke-Obfuscation Via Use Clip - System","high","system","","Detects Obfuscated Powershell via use Clip.exe in Scripts","e92121bb-a1c1-5d5a-6abb-3a25fe37fb41"
"smbexec.py Service Installation","high","system","","Detects the use of smbexec.py tool by detecting a specific service installation","384155f0-8906-ff64-5188-211c9a98274e"
"TacticalRMM Service Installation","medium","system","","Detects a TacticalRMM service installation. Tactical RMM is a remote monitoring & management tool.","a36af175-0d96-acc8-c2f7-f5bb57c974fe"
"Meterpreter or Cobalt Strike Getsystem Service Installation - System","high","system","","Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation","4639745f-a91a-d296-8935-4c694a97f938"
"Windows Service Terminated With Error","low","system","","Detects Windows services that got terminated for whatever reason","c002ec31-f147-d591-b2f2-253774fd4248"
"Important Windows Service Terminated Unexpectedly","high","system","","Detects important or interesting Windows services that got terminated unexpectedly.","d3c329c7-54bd-4896-cc7d-e04077eba081"
"Suspicious Service Installation","high","system","","Detects suspicious service installation commands","ebfad3e2-5025-b233-20ef-71fc2ada8fe7"
"Sliver C2 Default Service Installation","high","system","","Detects known malicious service installation that appear in cases in which a Sliver implants execute the PsExec commands","e38955da-ce8e-7137-94e5-7890c0bab131"
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - System","high","system","","Detects Obfuscated Powershell via VAR++ LAUNCHER","f5581097-47d5-fd2b-1a94-37dd36318706"
"Mesh Agent Service Installation","medium","system","","Detects a Mesh Agent service installation. Mesh Agent is used to remotely manage computers","cd204548-409b-e025-4fde-4a8fb1fe5332"
"Local Privilege Escalation Indicator TabTip","high","system","","Detects the invocation of TabTip via CLSID as seen when JuicyPotatoNG is used on a system in brute force mode","cd12f5c0-9798-3928-58bf-34b2816ea898"
"DHCP Server Error Failed Loading the CallOut DLL","high","system","","This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded","a6878a7f-9fcd-9b29-ba67-ca05b11dc4aa"
"DHCP Server Loaded the CallOut DLL","high","system","","This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded","87ade82b-7e03-f378-c163-59adb06640ae"
"Windows Update Error","informational","system","","Detects Windows update errors including installation failures and connection issues. Defenders should observe this in case critical update KBs aren't installed.
","8f9f7490-f99e-ff64-4b60-ac3f06a2262b"
"KDC RC4-HMAC Downgrade CVE-2022-37966","high","system","","Detects the exploitation of a security bypass and elevation of privilege vulnerability with Authentication Negotiation by using weak RC4-HMAC negotiation","87515290-bf9f-09a4-af0e-bac22cb017f6"
"Certificate Use With No Strong Mapping","medium","system","","Detects a user certificate that was valid but could not be mapped to a user in a strong way (such as via explicit mapping, key trust mapping, or a SID)
This could be a sign of exploitation of the elevation of privilege vulnerabilities (CVE-2022-34691, CVE-2022-26931, CVE-2022-26923) that can occur when the KDC allows certificate spoofing by not requiring a strong mapping.
Events where the AccountName and CN of the Subject do not match, or where the CN ends in a dollar sign indicating a machine, may indicate certificate spoofing.
","470e08fc-0b52-8769-10d3-5b5c1920327e"
"No Suitable Encryption Key Found For Generating Kerberos Ticket","low","system","","Detects errors when a target server doesn't have suitable keys for generating kerberos tickets.
This issue can occur for example when a service uses a user account or a computer account that is configured for only DES encryption on a computer that is running Windows 7 which has DES encryption for Kerberos authentication disabled.
","e10c99fe-7559-5ae3-9c5c-9fd0a70bd4a6"
"Sysmon Application Crashed","high","system","","Detects application popup reporting a failure of the Sysmon service","e064a7a6-e709-1464-34e4-626106c91d98"
"Potential CVE-2021-42287 Exploitation Attempt","medium","system","","The attacker creates a computer object using those permissions with a password known to her.
After that she clears the attribute ServicePrincipalName on the computer object.
Because she created the object (CREATOR OWNER), she gets granted additional permissions and can do many changes to the object.
","7ef3c84f-fc5f-e0e6-b94d-07dbb0c946eb"
"Critical Hive In Suspicious Location Access Bits Cleared","high","system","","Detects events from the Kernel-General ETW indicating that the access bits of a hive with a system like hive name located in the temp directory have been reset.
This occurs when an application tries to access a hive and the hive has not be recognized since the last 7 days (by default).
Registry hive dumping utilities such as QuarksPwDump were seen emitting this behavior.
","625954f8-9cc1-bc90-d5bd-4d1d82849d37"
"Important Windows Eventlog Cleared","high","system","","Detects the clearing of one of the Windows Core Eventlogs. e.g. caused by ""wevtutil cl"" command execution","30966a3a-2224-0e1a-d28d-c0f7e84cfed3"
"Eventlog Cleared","medium","system","","One of the Windows Eventlogs has been cleared. e.g. caused by ""wevtutil cl"" command execution","8617b59c-812e-c88e-0bd4-5267e0e825f0"
"Active Directory Certificate Services Denied Certificate Enrollment Request","low","system","","Detects denied requests by Active Directory Certificate Services.
Example of these requests denial include issues with permissions on the certificate template or invalid signatures.
","817138f1-cfd3-c653-7392-a3c61051a8d3"
"Vulnerable Netlogon Secure Channel Connection Allowed","high","system","","Detects that a vulnerable Netlogon secure channel connection was allowed, which could be an indicator of CVE-2020-1472.","a82f6b3b-324f-7234-9092-289117234d31"
"Zerologon Exploitation Using Well-known Tools","critical","system","","This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472) vulnerability using mimikatz zerologon module or other exploits from machine with ""kali"" hostname.","4d943318-24e9-7318-6951-fdf8cb235652"
"NTLMv1 Logon Between Client and Server","medium","system","","Detects the reporting of NTLMv1 being used between a client and server. NTLMv1 is insecure as the underlying encryption algorithms can be brute-forced by modern hardware.","cb063566-b04b-c7e4-316b-c69075ed08f5"
"Crash Dump Created By Operating System","medium","system","","Detects ""BugCheck"" errors indicating the system rebooted due to a crash, capturing the bugcheck code, dump file path, and report ID.","d4ccca35-9fd6-1ed8-f5d5-84f755404fdd"
"Malicious Service Installations","critical","system","","Detects known malicious service installs that only appear in cases of lateral movement, credential dumping, and other suspicious activities.","a5f841a8-5dcb-5ee4-73ea-5331859bf763"
"Metasploit Or Impacket Service Installation Via SMB PsExec","high","system","","Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec) and Impacket psexec.py by triggering on specific service installation","c953a767-8b94-df03-dd53-611baad380fd"
"Rare Service Installations","low","system","","Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services","e9acc9e9-8b91-7859-2d0c-446a2c40b937"
"OilRig APT Schedule Task Persistence - System","critical","system","","Detects OilRig schedule task persistence as reported by Nyotron in their March 2018 report","afa88090-3c0b-17fc-7061-2259abc82d2b"
"Goofy Guineapig Backdoor Service Creation","critical","system","","Detects service creation persistence used by the Goofy Guineapig backdoor","0375abd6-f86e-a665-27a0-501b2a1621a8"
"Potential CVE-2021-42278 Exploitation Attempt","medium","system","","The attacker creates a computer object using those permissions with a password known to her.
After that she clears the attribute ServicePrincipalName on the computer object.
Because she created the object (CREATOR OWNER), she gets granted additional permissions and can do many changes to the object.
","8a194220-2afd-d5a9-0644-0a2d76019999"
"Turla Service Install","high","system","","This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET","665e3be1-3ec1-2e79-bd0f-dca344762794"
"Turla PNG Dropper Service","critical","system","","This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018","75a0da35-0e7f-e313-f974-d812b44295a4"
"StoneDrill Service Install","high","system","","This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky","c1362f8e-594e-72a7-d9a9-6fe6c74334ef"
"SNAKE Malware Service Persistence","critical","system","","Detects the creation of a service named ""WerFaultSvc"" which seems to be used by the SNAKE malware as a persistence mechanism as described by CISA in their report","abdb2e55-7d24-7f3d-6091-2b42abca2e67"
"COLDSTEEL Persistence Service Creation","high","system","","Detects the creation of new services potentially related to COLDSTEEL RAT","d8f1ace1-c01b-3f95-34ed-993d29f876f5"
"Task Deleted","informational","taskscheduler","","","ff6ada24-c7f0-4ae5-a7a6-f20ddb7b591f"
"Task Executed","informational","taskscheduler","","","d1923809-955b-47c4-b3e5-37c0e461919c"
"Task Updated","informational","taskscheduler","","","aba04101-e439-4e2f-b051-4be561993c31"
"Task Created","informational","taskscheduler","","","33599dfb-f3e4-4298-8d3f-59407f65f4e7"
"Important Scheduled Task Deleted","high","taskscheduler","","Detects when adversaries try to stop system services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities
","0c0e2be2-30d2-c713-0c9c-63cd9752a940"
"Scheduled Task Executed Uncommon LOLBIN","medium","taskscheduler","","Detects the execution of Scheduled Tasks where the program being run is located in a suspicious location or where it is an unusual program to be run from a Scheduled Task","d5a3d13e-7db3-bcf5-824a-789488ab40fd"
"Scheduled Task Executed From A Suspicious Location","medium","taskscheduler","","Detects the execution of Scheduled Tasks where the Program being run is located in a suspicious location or it's an unusale program to be run from a Scheduled Task","c1fd9ca2-a3f8-1adc-0f1d-1d6099f5d827"
"Rare Scheduled Task Creations","low","taskscheduler","","This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names.","696cf23d-d3f2-0a4d-6aff-b162d692a778"
"Scheduled Tasks Names Used By SVR For GraphicalProton Backdoor - Task Scheduler","high","taskscheduler","","Hunts for known SVR-specific scheduled task names","51850e92-9de2-230e-98f6-5775d63df091"
"RDP Disconnect","informational","terminalservices-localsessionmanager","","Event 24 is created when a local session disconnects. That happens after a user successfully logs off or disconnects a local or remote interactive logon session.
This event immediately follows a EID 23 RDP Logoff event.
This event has the same information as EID 23 and Security EID 4634.
","3fc6234f-93a5-4d48-b618-30e2c69c0a86"
"RDP Reconnect","informational","terminalservices-localsessionmanager","","","8fe4a60b-2af3-43d6-95e2-8f13caccc179"
"RDP Sess Start (Noisy)","informational","terminalservices-localsessionmanager","","This event is created when a new local session is created for either a local or remote interactive login.
Original event message: Shell start notification received
The Local Session Manager is responsible for creating or finding existing local sessions to support interactive logins.
Note that local sessions are different from logon sessions.
Local sessions represent the logon sessions, desktop layout, processes, etc. associated with an interactive logon. 
Event 22 is created when a new local session needs to be created.
That happens after a user successfully authenticates for a local or remote interactive logon session and the user does not already have an existing local session.
This event follows a Local Session Manager 21 event.
This event gives the same information in Remote Connection Manager 1149, Local Session Manager 21 and Security 4648.
","320e2cb0-a56a-476f-a299-79dc45644fee"
"RDP Logoff","informational","terminalservices-localsessionmanager","","Event 23 is created when a local session logs off. That happens after a user successfully logs off a local or remote interactive logon session. Not just a disconnect.","e14a729f-f4f8-427b-a238-dfbde9c1614b"
"RDP Logon","informational","terminalservices-localsessionmanager","","This event is created when a new local session is created for either a local or remote interactive login when a user successfully authenticates and there is no existing local session.
This event will be created when a user logs on for the first time or after a logout but not after just a disconnect because the session will still exist.
In that case, a reconnect event will be created.
The Local Session Manager is responsible for creating or finding existing local sessions to support interactive logins.
Note that local sessions are different from logon sessions.
Local sessions represent the logon sessions, desktop layout, processes, etc. associated with an interactive logon. 
SrcIP will be an IP address if it is a remote session and ""LOCAL"" if it is a local session.
This event gives the same information in Remote Connection Manager 1149, Local Session Manager 22 and Security 4648.
","b107551c-409d-44b8-bb0d-3b007c269881"
"Ngrok Usage with Remote Desktop Service","high","terminalservices-localsessionmanager","","Detects cases in which ngrok, a reverse proxy tool, forwards events to the local RDP port, which could be a sign of malicious behaviour","cfba8e23-d224-ff3b-7cb7-dbc6085172a0"
"Temporary WMI Event Consumer","informational","wmi","","","d96164c4-9e15-4d48-964f-153ac0dab6e9"
"WMI Provider Started","informational","wmi","","The time wmiprvse was executed and path to the provider DLL. Attackers may sometimes install malicious WMI provider DLLs.","547aec97-2635-474a-a36c-7a3a46b07fde"
"Permanent WMI Event Consumer","informational","wmi","","Created when a EventFilterToConsumerBinding event happens.","ac9f0a2a-e9c5-4d19-b69e-e3d518ca6797"
"WMI Filter To Consumer Binding_Command Execution","medium","wmi","","Detects when powershell or cmd is used in WMI. (For persistence, lateral movement, etc...)","ab4852ca-3e27-4dbb-af6b-5f8458d5717a"
"Suspicious Scripting in a WMI Consumer","high","","wmi_event","Detects suspicious commands that are related to scripting/powershell in WMI Event Consumers","93786e05-1808-f3b1-9841-7fee02fd7247"
"Suspicious Encoded Scripts in a WMI Consumer","high","","wmi_event","Detects suspicious encoded payloads in WMI Event Consumers","f4e538d8-94a9-8ecc-779e-e03aa85aedb4"
"WMI Persistence","medium","wmi","","Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs.","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"Defender Alert (High)","high","windefend","","Windows defender malware detection","1e11c0f0-aecd-45d8-9229-da679c0265ea"
"Defender Alert (Severe)","critical","windefend","","Windows defender malware detection","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"Defender Alert (Moderate)","medium","windefend","","Windows defender malware detection","3f5005fc-e354-4b0b-b1a1-3eec1d336023"
"Defender Alert (Low)","low","windefend","","Windows defender malware detection","61056ed8-7be5-46e4-9015-c5f6bc8b93a1"
"Antivirus Exploitation Framework Detection","critical","windefend","antivirus","Detects a highly relevant Antivirus alert that reports an exploitation framework.
This event must not be ignored just because the AV has blocked the malware but investigate, how it came there in the first place.
","1868a1c5-30e8-dffd-a373-90c72ea4921a"
"Antivirus Ransomware Detection","critical","windefend","antivirus","Detects a highly relevant Antivirus alert that reports ransomware.
This event must not be ignored just because the AV has blocked the malware but investigate, how it came there in the first place.
","22f82564-4b51-e901-bf00-ea94ff39b468"
"Antivirus Relevant File Paths Alerts","high","windefend","antivirus","Detects an Antivirus alert in a highly relevant file path or with a relevant file name.
This event must not be ignored just because the AV has blocked the malware but investigate, how it came there in the first place.
","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"Antivirus Hacktool Detection","high","windefend","antivirus","Detects a highly relevant Antivirus alert that reports a hack tool or other attack tool.
This event must not be ignored just because the AV has blocked the malware but investigate, how it came there in the first place.
","f3d20838-65fe-0575-52a9-fd41ce2a5fdd"
"Antivirus Password Dumper Detection","critical","windefend","antivirus","Detects a highly relevant Antivirus alert that reports a password dumper.
This event must not be ignored just because the AV has blocked the malware but investigate, how it came there in the first place.
","46fc2e9f-df4e-8628-05d5-39bc97b56bab"
"Antivirus Web Shell Detection","high","windefend","antivirus","Detects a highly relevant Antivirus alert that reports a web shell.
It's highly recommended to tune this rule to the specific strings used by your anti virus solution by downloading a big WebShell repository from e.g. github and checking the matches.
This event must not be ignored just because the AV has blocked the malware but investigate, how it came there in the first place.
","207b56b3-b44d-dcee-c171-c8f3f4eb3cf6"
"Windows Defender Threat Detection Disabled","high","windefend","","Detects disabling Windows Defender threat protection","7424bd72-6b38-f5a1-7f25-4665452ec72b"
"Windows Defender AMSI Trigger Detected","high","windefend","","Detects triggering of AMSI by Windows Defender.","4947e388-9eb4-8e77-4de7-17accc04246e"
"Windows Defender Malware Detection History Deletion","informational","windefend","","Windows Defender logs when the history of detected infections is deleted.","e9310b5d-113f-86dc-a3e0-3ed5cefa6088"
"Windows Defender Malware And PUA Scanning Disabled","high","windefend","","Detects disabling of the Windows Defender feature of scanning for malware and other potentially unwanted software","ac622fde-5d5a-e064-bfd2-55cbb5f1eacb"
"LSASS Access Detected via Attack Surface Reduction","high","windefend","","Detects Access to LSASS Process","db45bac6-e4cf-df15-bb73-abdc2bb5b466"
"Windows Defender Configuration Changes","high","windefend","","Detects suspicious changes to the Windows Defender configuration","36d5c11e-504a-a3a6-2704-4d6f5f35be41"
"Windows Defender Exclusions Added","medium","windefend","","Detects the Setting of Windows Defender Exclusions","13020ca6-8f32-26e1-25d6-1f727e58de89"
"PSExec and WMI Process Creations Block","high","windefend","","Detects blocking of process creations originating from PSExec and WMI commands","c73d596d-c719-ab68-1753-6aa80ff340d7"
"Windows Defender Grace Period Expired","high","windefend","","Detects the expiration of the grace period of Windows Defender. This means protection against viruses, spyware, and other potentially unwanted software is disabled.
","5a62f5a9-71eb-a0e2-496d-e062350225df"
"Windows Defender Real-time Protection Disabled","high","windefend","","Detects disabling of Windows Defender Real-time Protection. As this event doesn't contain a lot of information on who initiated this action you might want to reduce it to a ""medium"" level if this occurs too many times in your environment
","e6c2628d-e4dc-0b32-e087-1c205385af72"
"Win Defender Restored Quarantine File","high","windefend","","Detects the restoration of files from the defender quarantine","77f49adb-372a-8c7c-0bee-7e361b09b30e"
"Windows Defender Threat Detected","high","windefend","","Detects actions taken by Windows Defender malware detection engines","c70d7033-8146-fe73-8430-90b23c296f9d"
"Windows Defender Submit Sample Feature Disabled","low","windefend","","Detects disabling of the ""Automatic Sample Submission"" feature of Windows Defender.","f8be1673-da49-5b78-517b-16094864fab7"
"Windows Defender Real-Time Protection Failure/Restart","medium","windefend","","Detects issues with Windows Defender Real-Time Protection features","73176728-033d-ef77-a174-554a0bf61f94"
"Microsoft Defender Tamper Protection Trigger","high","windefend","","Detects blocked attempts to change any of Defender's settings such as ""Real Time Monitoring"" and ""Behavior Monitoring""","f0a75367-1237-98a3-79c3-c4e7e4f5bacc"
"Windows Defender Exploit Guard Tamper","high","windefend","","Detects when someone is adding or removing applications or folders from exploit guard ""ProtectedFolders"" or ""AllowedApplications""
","2b57cd91-079d-5f13-07f4-82d7435acd38"
"Windows Defender Virus Scanning Feature Disabled","high","windefend","","Detects disabling of the Windows Defender virus scanning feature","a325b024-9641-6ee4-56c1-20eb9fc4324a"
"Antivirus PrinterNightmare CVE-2021-34527 Exploit Detection","critical","windefend","antivirus","Detects the suspicious file that is created from PoC code against Windows Print Spooler Remote Code Execution Vulnerability CVE-2021-34527 (PrinterNightmare), CVE-2021-1675 .","aef0711e-c055-e870-92bc-ea130059eed1"
